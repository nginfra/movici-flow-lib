{"version":3,"file":"index.esm.js","sources":["../node_modules/tslib/tslib.es6.js","../src/utils/index.ts","../src/components/map/Deck.vue","../node_modules/vue-runtime-helpers/dist/normalize-component.mjs","../node_modules/vue-runtime-helpers/dist/inject-style/browser.mjs","../src/components/map/mapLayers/LayerMixin.js","../src/components/map/mapLayers/Buildings.vue","../src/types/datasets.ts","../src/types/flow.ts","../src/types/flowVisualizers.ts","../src/types/flowLegend.ts","../src/types/geometry.ts","../src/types/scenarios.ts","../src/types/schema.ts","../src/types/users.ts","../src/types/visualization.ts","../src/components/map/defaults.ts","../src/errors.ts","../src/crs.ts","../src/visualizers/geometry.ts","../src/visualizers/visualizers.ts","../src/visualizers/staticVisualizers.ts","../src/utils/timeline.ts","../src/visualizers/tapefile.ts","../src/visualizers/maps/colorMaps.ts","../src/visualizers/tapefileVisualizers.ts","../src/visualizers/activeEntityVisualizers.ts","../src/visualizers/visualizerHelpers.ts","../src/visualizers/VisualizerInfo.ts","../src/utils/colorUtils.ts","../src/visualizers/visualizerModules/common.ts","../src/visualizers/visualizerModules/ColorModule.ts","../src/visualizers/visualizerModules/PopupModule.ts","../src/visualizers/maps/sizeMaps.ts","../src/visualizers/visualizerModules/SizeModule.ts","../src/visualizers/composableVisualizers.ts","../src/visualizers/index.ts","../src/components/map/mapVisHelpers.ts","../src/utils/DatasetDownloader.ts","../src/visualizers/VisualizerManager.ts","../node_modules/vuex-module-decorators/dist/esm/index.js","../src/utils/csvUtils.ts","../src/utils/DataExporter.ts","../src/store/FlowStore.ts","../src/store/FlowUserInterfaceStore.ts","../src/store/GeocodeStore.ts","../src/store/store-accessor.ts","../src/components/map/MapVis.vue","../src/components/global/Action.vue","../src/components/global/ActionBar.vue","../src/mixins/FixedPosition.ts","../src/components/global/ActionMenu.vue","../src/components/global/LanguagePicker.vue","../src/components/global/TooltipInfo.vue","../src/utils/snackbar.ts","../src/plugins.ts","../src/api/concurrency.ts","../src/api/client.ts","../src/api/requests/base.ts","../src/api/requests/uri.ts","../src/api/requests/datasets.ts","../src/api/requests/geocode.ts","../src/api/requests/projects.ts","../src/api/requests/scenarios.ts","../src/api/requests/summary.ts","../src/api/requests/updates.ts","../src/api/requests/views.ts","../src/router.ts","../src/locales/index.ts","../src/i18n.ts","../src/main.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import {\r\n  ComponentProperty,\r\n  DatasetSummary,\r\n  EntityGroupSummary,\r\n  ShortScenario,\r\n  Simulation\r\n} from '@/types';\r\nimport upperFirst from 'lodash/upperFirst';\r\n\r\n/**\r\n * Shorthand for checking the existence of a property on an object. Use the\r\n * Object prototype to prevent overridden usage, and potential security issues\r\n * when performing this on a (user-provided) JSON loaded object\r\n * @param obj\r\n * @param property\r\n * @returns {boolean}\r\n */\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nexport function hasOwnProperty<O extends any, K extends PropertyKey>(\r\n  obj: O,\r\n  property: K\r\n): obj is O & Record<K, unknown> {\r\n  return Object.prototype.hasOwnProperty.call(obj, property);\r\n}\r\n\r\nexport function propertyString(property: ComponentProperty): string {\r\n  const base = property.component ? property.component + '/' : '';\r\n  return base + property.name;\r\n}\r\n\r\nexport function parsePropertyString(val: string): ComponentProperty {\r\n  const parts = val.split('/');\r\n  if (parts.length === 1) {\r\n    return { name: parts[0], component: null };\r\n  }\r\n  if (parts.length === 2) {\r\n    return { component: parts[0], name: parts[1] };\r\n  }\r\n  throw new Error(`Couldn't parse '${val}' as a valid property identifier`);\r\n}\r\n\r\nexport function getEntitySummary(\r\n  entityType: string,\r\n  summary: DatasetSummary\r\n): EntityGroupSummary | null {\r\n  const index = summary.entity_groups.map(e => e.name).indexOf(entityType);\r\n  if (index === -1) {\r\n    return null;\r\n  }\r\n  return summary.entity_groups[index];\r\n}\r\n\r\nexport function copyToClipboard(text: string) {\r\n  const el = document.createElement('textarea');\r\n  el.value = text;\r\n  document.body.appendChild(el);\r\n  el.select();\r\n  document.execCommand('copy');\r\n  document.body.removeChild(el);\r\n}\r\n\r\nexport function getBaseURL(): string {\r\n  return (\r\n    window.location.protocol +\r\n    '//' +\r\n    window.location.hostname +\r\n    (window.location.port ? `:${window.location.port}` : '') +\r\n    window.location.pathname\r\n  );\r\n}\r\n\r\n/**\r\n * Receives a scenario status and returns a Bulma class for the color\r\n * @param status\r\n */\r\nexport function getClassFromStatus(status: string): string {\r\n  let statusClass = 'is-';\r\n  switch (status) {\r\n    case 'Failed':\r\n    case 'Unknown':\r\n    case 'Invalid':\r\n    case 'Cancelled':\r\n      statusClass += 'danger';\r\n      break;\r\n    case 'Ready':\r\n    case 'Running':\r\n    case 'Pending':\r\n      statusClass += 'info';\r\n      break;\r\n    case 'Succeeded':\r\n      statusClass += 'primary';\r\n      break;\r\n  }\r\n  return statusClass;\r\n}\r\n\r\nexport function getStatusFromScenarioAndSimulation(\r\n  scenario: ShortScenario,\r\n  simulation: Simulation\r\n) {\r\n  const allStatuses = ['failed', 'invalid', 'pending', 'running', 'succeeded', 'ready', 'unknown'];\r\n  const scenarioStatus = getStatusOrUnknown(scenario).toLowerCase();\r\n  const simulationStatus = getStatusOrUnknown(simulation).toLowerCase();\r\n  for (let i = 0; i < allStatuses.length; i++) {\r\n    const status = allStatuses[i];\r\n    if (scenarioStatus === status || simulationStatus === status) {\r\n      return upperFirst(status);\r\n    }\r\n  }\r\n  return 'unknown'; // should not get here\r\n}\r\n\r\nfunction getStatusOrUnknown(obj: ShortScenario | Simulation) {\r\n  return obj.status ? obj.status : 'Unknown';\r\n}\r\n","<template>\r\n  <div>\r\n    <div id=\"mapbox-container\">\r\n      <div id=\"map\" />\r\n      <canvas id=\"deckgl-overlay\" />\r\n      <div class=\"map-control-zero\" v-if=\"loaded\">\r\n        <slot name=\"control-zero\" :map=\"map\" :on-viewstate-change=\"updateViewState\" />\r\n      </div>\r\n      <div class=\"map-control-left\" v-if=\"loaded\">\r\n        <slot name=\"control-left\" :map=\"map\" :on-viewstate-change=\"updateViewState\" />\r\n      </div>\r\n      <div class=\"map-control-right\" v-if=\"loaded\">\r\n        <slot name=\"control-right\" :map=\"map\" :on-viewstate-change=\"updateViewState\" />\r\n      </div>\r\n      <div class=\"map-control-bottom\" v-if=\"loaded\">\r\n        <slot name=\"control-bottom\" :map=\"map\" :on-viewstate-change=\"updateViewState\" />\r\n      </div>\r\n      <template v-if=\"loaded\">\r\n        <slot name=\"map\" :map=\"map\" :deck=\"deck\" :view-state=\"value\" />\r\n      </template>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\r\nimport mapboxgl from 'mapbox-gl';\r\nimport 'mapbox-gl/dist/mapbox-gl.css';\r\nimport { Deck as DeckGL, Layer } from '@deck.gl/core';\r\n\r\n// noinspection TypeScriptCheckImport\r\nimport { DeckProps, PickInfo } from '@deck.gl/core/lib/deck';\r\nimport { hasOwnProperty } from '@/utils';\r\nimport { CameraOptions, Nullable } from '@/types';\r\n\r\nconst DEFAULT_VIEWSTATE = {\r\n  latitude: 51.992381,\r\n  longitude: 4.3649092,\r\n  zoom: 10,\r\n  bearing: 0,\r\n  pitch: 0\r\n};\r\n@Component({\r\n  name: 'Deck'\r\n})\r\nexport default class Deck extends Vue {\r\n  @Prop([Object]) readonly value!: Nullable<CameraOptions>;\r\n\r\n  @Prop({\r\n    type: String,\r\n    default: 'mapbox://styles/mapbox/light-v10'\r\n  })\r\n  readonly basemap!: string;\r\n\r\n  @Prop({\r\n    type: String,\r\n    default: process.env.VUE_APP_MAPBOX_TOKEN\r\n  })\r\n  readonly accessToken!: string;\r\n\r\n  @Prop({\r\n    type: Array,\r\n    default() {\r\n      return [];\r\n    }\r\n  })\r\n  readonly layers!: Layer<unknown>[];\r\n  map: mapboxgl.Map | null = null;\r\n  deck: DeckGL | null = null;\r\n  loaded = false;\r\n\r\n  @Watch('basemap')\r\n  setStyle() {\r\n    this.map?.setStyle(this.basemap);\r\n  }\r\n\r\n  mounted() {\r\n    const viewState = this.value || DEFAULT_VIEWSTATE;\r\n    this.map = new mapboxgl.Map({\r\n      center: [viewState.longitude, viewState.latitude],\r\n      zoom: viewState.zoom,\r\n      bearing: viewState.bearing,\r\n      pitch: viewState.pitch,\r\n      container: 'map',\r\n      accessToken: this.accessToken,\r\n      maxPitch: 65,\r\n      style: this.basemap,\r\n      attributionControl: false,\r\n      interactive: false\r\n    });\r\n\r\n    this.map.on('load', () => {\r\n      this.loaded = true;\r\n    });\r\n\r\n    this.deck = new DeckGL(({\r\n      canvas: 'deckgl-overlay',\r\n      width: '100%',\r\n      height: '100%',\r\n      initialViewState: viewState,\r\n      // @ts-expect-error\r\n      getCursor: ({ isHovering }) => {\r\n        return isHovering ? 'pointer' : 'initial';\r\n      },\r\n      controller: true,\r\n      layers: [],\r\n      onViewStateChange: ({ viewState }: { viewState: CameraOptions }) => {\r\n        this.updateViewState(viewState);\r\n      },\r\n      getTooltip(info: PickInfo<unknown>) {\r\n        const object = info.object;\r\n        if (object && typeof object === 'object' && hasOwnProperty(object, 'onHoverText')) {\r\n          return `${object.onHoverText}`;\r\n        }\r\n      }\r\n    } as unknown) as DeckProps);\r\n  }\r\n\r\n  @Watch('layers')\r\n  renderDeck() {\r\n    if (!this.deck) {\r\n      throw new Error('No Deck to render');\r\n    }\r\n    if (!this.map) {\r\n      throw new Error('Cannot render deck when Map is not initialized');\r\n    }\r\n\r\n    this.deck.setProps({ layers: this.layers });\r\n  }\r\n\r\n  @Watch('value')\r\n  updateViewState(viewState: CameraOptions) {\r\n    this.deck && this.deck.setProps({ viewState });\r\n    this.map?.jumpTo({\r\n      center: [viewState.longitude, viewState.latitude],\r\n      zoom: viewState.zoom,\r\n      bearing: viewState.bearing,\r\n      pitch: viewState.pitch\r\n    });\r\n    this.$emit('input', viewState);\r\n  }\r\n\r\n  beforeDestroy() {\r\n    // this was triggering errors\r\n    // need to destroy children, so that layer removal is done before the map itself is removed\r\n    this.$children.forEach(child => child.$destroy());\r\n    this.map?.remove();\r\n    // this.deck?.canvas.remove();\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n#mapbox-container {\r\n  width: 100%;\r\n  height: 100vh;\r\n\r\n  & > #map,\r\n  & > #deckgl-overlay {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100% !important;\r\n    height: 100% !important;\r\n  }\r\n\r\n  .map-control-zero {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n  }\r\n\r\n  ::v-deep {\r\n    .map-control-left {\r\n      position: absolute;\r\n      top: 10px;\r\n      left: 10px;\r\n      transition: transform 0.5s;\r\n      & > * {\r\n        margin-bottom: 8px;\r\n        margin-right: auto;\r\n        &:last-child {\r\n          margin-bottom: 0;\r\n        }\r\n      }\r\n    }\r\n\r\n    .map-control-right {\r\n      position: absolute;\r\n      top: 10px;\r\n      right: 10px;\r\n      & > * {\r\n        margin-bottom: 8px;\r\n        margin-left: auto;\r\n        &:last-child {\r\n          margin-bottom: 0;\r\n        }\r\n      }\r\n    }\r\n\r\n    .map-control-bottom {\r\n      position: absolute;\r\n      bottom: 24px;\r\n      height: 100px;\r\n      z-index: 1;\r\n      left: 0;\r\n      right: 0;\r\n      width: calc(100vw - #{$left-menu-size} - #{$menu-item-size});\r\n      $left-menu-size: 300px;\r\n      display: flex;\r\n      justify-content: center;\r\n      transition: transform 0.5s, width 0.5s;\r\n    }\r\n  }\r\n\r\n  .deck-tooltip {\r\n    width: 30px;\r\n    height: 20px;\r\n  }\r\n\r\n  ::v-deep {\r\n    .mapboxgl-ctrl-bottom-left {\r\n      right: 10px;\r\n      left: unset;\r\n    }\r\n    .mapboxgl-popup {\r\n      z-index: 99;\r\n      .mapboxgl-popup-content {\r\n        padding: 18px 24px 12px 12px;\r\n      }\r\n      .mapboxgl-popup-close-button {\r\n        font-family: 'Font Awesome 5 Pro';\r\n        font-size: 0px;\r\n        content: '';\r\n        width: 24px;\r\n        height: 24px;\r\n        &::before {\r\n          font-size: 12px;\r\n          content: '\\f00d';\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","function normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier /* server only */, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\r\n    if (typeof shadowMode !== 'boolean') {\r\n        createInjectorSSR = createInjector;\r\n        createInjector = shadowMode;\r\n        shadowMode = false;\r\n    }\r\n    // Vue.extend constructor export interop.\r\n    const options = typeof script === 'function' ? script.options : script;\r\n    // render functions\r\n    if (template && template.render) {\r\n        options.render = template.render;\r\n        options.staticRenderFns = template.staticRenderFns;\r\n        options._compiled = true;\r\n        // functional template\r\n        if (isFunctionalTemplate) {\r\n            options.functional = true;\r\n        }\r\n    }\r\n    // scopedId\r\n    if (scopeId) {\r\n        options._scopeId = scopeId;\r\n    }\r\n    let hook;\r\n    if (moduleIdentifier) {\r\n        // server build\r\n        hook = function (context) {\r\n            // 2.3 injection\r\n            context =\r\n                context || // cached call\r\n                    (this.$vnode && this.$vnode.ssrContext) || // stateful\r\n                    (this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext); // functional\r\n            // 2.2 with runInNewContext: true\r\n            if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\r\n                context = __VUE_SSR_CONTEXT__;\r\n            }\r\n            // inject component styles\r\n            if (style) {\r\n                style.call(this, createInjectorSSR(context));\r\n            }\r\n            // register component module identifier for async chunk inference\r\n            if (context && context._registeredComponents) {\r\n                context._registeredComponents.add(moduleIdentifier);\r\n            }\r\n        };\r\n        // used by ssr in case component is cached and beforeCreate\r\n        // never gets called\r\n        options._ssrRegister = hook;\r\n    }\r\n    else if (style) {\r\n        hook = shadowMode\r\n            ? function (context) {\r\n                style.call(this, createInjectorShadow(context, this.$root.$options.shadowRoot));\r\n            }\r\n            : function (context) {\r\n                style.call(this, createInjector(context));\r\n            };\r\n    }\r\n    if (hook) {\r\n        if (options.functional) {\r\n            // register for functional component in vue file\r\n            const originalRender = options.render;\r\n            options.render = function renderWithStyleInjection(h, context) {\r\n                hook.call(context);\r\n                return originalRender(h, context);\r\n            };\r\n        }\r\n        else {\r\n            // inject component registration as beforeCreate hook\r\n            const existing = options.beforeCreate;\r\n            options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\r\n        }\r\n    }\r\n    return script;\r\n}\n\nexport default normalizeComponent;\n//# sourceMappingURL=normalize-component.mjs.map\n","const isOldIE = typeof navigator !== 'undefined' &&\r\n    /msie [6-9]\\\\b/.test(navigator.userAgent.toLowerCase());\r\nfunction createInjector(context) {\r\n    return (id, style) => addStyle(id, style);\r\n}\r\nlet HEAD;\r\nconst styles = {};\r\nfunction addStyle(id, css) {\r\n    const group = isOldIE ? css.media || 'default' : id;\r\n    const style = styles[group] || (styles[group] = { ids: new Set(), styles: [] });\r\n    if (!style.ids.has(id)) {\r\n        style.ids.add(id);\r\n        let code = css.source;\r\n        if (css.map) {\r\n            // https://developer.chrome.com/devtools/docs/javascript-debugging\r\n            // this makes source maps inside style tags work properly in Chrome\r\n            code += '\\n/*# sourceURL=' + css.map.sources[0] + ' */';\r\n            // http://stackoverflow.com/a/26603875\r\n            code +=\r\n                '\\n/*# sourceMappingURL=data:application/json;base64,' +\r\n                    btoa(unescape(encodeURIComponent(JSON.stringify(css.map)))) +\r\n                    ' */';\r\n        }\r\n        if (!style.element) {\r\n            style.element = document.createElement('style');\r\n            style.element.type = 'text/css';\r\n            if (css.media)\r\n                style.element.setAttribute('media', css.media);\r\n            if (HEAD === undefined) {\r\n                HEAD = document.head || document.getElementsByTagName('head')[0];\r\n            }\r\n            HEAD.appendChild(style.element);\r\n        }\r\n        if ('styleSheet' in style.element) {\r\n            style.styles.push(code);\r\n            style.element.styleSheet.cssText = style.styles\r\n                .filter(Boolean)\r\n                .join('\\n');\r\n        }\r\n        else {\r\n            const index = style.ids.size - 1;\r\n            const textNode = document.createTextNode(code);\r\n            const nodes = style.element.childNodes;\r\n            if (nodes[index])\r\n                style.element.removeChild(nodes[index]);\r\n            if (nodes.length)\r\n                style.element.insertBefore(textNode, nodes[index]);\r\n            else\r\n                style.element.appendChild(textNode);\r\n        }\r\n    }\r\n}\n\nexport default createInjector;\n//# sourceMappingURL=browser.mjs.map\n","export default {\r\n  props: ['map'],\r\n\r\n  methods: {\r\n    attach() {\r\n      this.addSources();\r\n      this.map.addLayer({ ...this.layer, id: this.id });\r\n      this.map.off('idle', this.attach);\r\n    },\r\n    addSources() {\r\n      const sources = this.sources || {};\r\n      for (let key of Object.keys(sources)) {\r\n        this.map.addSource(key, sources[key]);\r\n      }\r\n    },\r\n    removeSources() {\r\n      const sources = this.sources || {};\r\n      for (let key of Object.keys(sources)) {\r\n        this.map.removeSource(key);\r\n      }\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n    this.map.on('idle', this.attach);\r\n  },\r\n\r\n  beforeDestroy() {\r\n    this.map.removeLayer(this.id);\r\n    this.removeSources();\r\n  },\r\n\r\n  render() {\r\n    return {};\r\n  }\r\n};\r\n","<script>\r\nimport layerMixin from './LayerMixin';\r\n\r\nexport default {\r\n  name: 'Buildings.vue',\r\n  mixins: [layerMixin],\r\n  data() {\r\n    return {\r\n      id: 'basemap-static-buildings',\r\n      sources: {\r\n        'custom-buildings': {\r\n          type: 'vector',\r\n          url: 'mapbox://movici.dh_buildings'\r\n        }\r\n      },\r\n      layer: {\r\n        source: 'custom-buildings',\r\n        'source-layer': 'original',\r\n        type: 'fill-extrusion',\r\n        paint: {\r\n          'fill-extrusion-color': '#aaa',\r\n\r\n          // use an 'interpolate' expression to add a smooth transition effect to the\r\n          // buildings as the user zooms in\r\n          'fill-extrusion-height': [\r\n            'interpolate',\r\n            ['linear'],\r\n            ['zoom'],\r\n            12,\r\n            0,\r\n            13,\r\n            ['get', 'abs_h_max']\r\n          ],\r\n\r\n          'fill-extrusion-opacity': 0.8\r\n        }\r\n      }\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped></style>\r\n","import { Line3DCoordinate, LineCoordinate, PolygonCoordinate } from '@/types/geometry';\r\nimport { UUID } from '@/types/general';\r\n\r\nexport interface DatasetCollection {\r\n  datasets: Dataset[];\r\n}\r\n\r\nexport class Dataset {\r\n  name: string;\r\n  display_name: string;\r\n  uuid: UUID;\r\n  type: string;\r\n  has_data: boolean;\r\n  created_on?: number;\r\n  last_modified?: number;\r\n  status: string;\r\n  constructor(config?: Partial<Dataset>) {\r\n    this.name = config?.name ?? 'unknown_dataset';\r\n    this.display_name = config?.display_name || this.name;\r\n    this.uuid = config?.uuid ?? '<unknown_uuid>';\r\n    this.type = config?.type ?? 'unknown';\r\n    this.has_data = config?.has_data ?? false;\r\n    this.status = this.has_data ? 'Done' : 'Empty';\r\n    this.created_on = config?.created_on ?? undefined;\r\n    this.last_modified = config?.last_modified ?? undefined;\r\n  }\r\n}\r\n\r\nexport interface Update {\r\n  created_on: number;\r\n  dataset_uuid: UUID;\r\n  scenario_uuid: UUID;\r\n  iteration: number;\r\n  model_name: string;\r\n  model_type: string;\r\n  name: string;\r\n  timestamp: number;\r\n  type: string;\r\n  uuid: UUID;\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nexport interface UpdateWithData<T = any> extends Update {\r\n  data: DatasetData<T>;\r\n}\r\n\r\nexport interface EntityUpdate<T> {\r\n  timestamp: number;\r\n  iteration: number;\r\n  data: EntityGroupData<T>;\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nexport class DatasetWithData<T = any> extends Dataset {\r\n  data?: DatasetData<T>;\r\n  constructor(config: Partial<DatasetWithData<T>>) {\r\n    super(config);\r\n    this.data = config.data ?? {};\r\n  }\r\n}\r\nexport interface DatasetData<T> {\r\n  [entityGroup: string]: EntityGroupData<T>;\r\n}\r\n\r\ninterface BaseEntityGroup {\r\n  id: number[];\r\n}\r\n\r\ninterface EntityGroupProperties<T> {\r\n  [componentProperty: string]: ComponentData<T> | T[];\r\n}\r\nexport type EntityGroupData<T> = BaseEntityGroup & EntityGroupProperties<T>;\r\n\r\nexport interface ComponentData<T> {\r\n  [property: string]: T[];\r\n}\r\n\r\ninterface PointGeometryProperties extends EntityGroupData<number> {\r\n  point_properties: {\r\n    position_x: number[];\r\n    position_y: number[];\r\n  };\r\n}\r\nexport type PointGeometryData = BaseEntityGroup & PointGeometryProperties;\r\n\r\ninterface LineGeometryProperties extends EntityGroupProperties<LineCoordinate | Line3DCoordinate> {\r\n  shape_properties: {\r\n    linestring_2d: LineCoordinate[];\r\n    linestring_3d: Line3DCoordinate[];\r\n  };\r\n}\r\nexport type LineGeometryData = BaseEntityGroup & LineGeometryProperties;\r\n\r\ninterface PolygonGeometryProperties extends EntityGroupProperties<PolygonCoordinate> {\r\n  shape_properties: {\r\n    polygon: PolygonCoordinate[];\r\n  };\r\n}\r\nexport type PolygonGeometryData = BaseEntityGroup & PolygonGeometryProperties;\r\n","export enum FlowSectionItem {\r\n  PROJECT = 'project',\r\n  DATASETS = 'datasets',\r\n  SCENARIO = 'scenario',\r\n  VISUALIZATION = 'visualization',\r\n  EXPORT = 'export'\r\n}\r\ninterface BaseFlowSection {\r\n  name: FlowSectionItem;\r\n  label: string;\r\n  icon?: string;\r\n  iconPack?: string;\r\n  enabled: boolean;\r\n  type: 'route' | 'callback';\r\n}\r\n\r\ninterface RouteFlowSection extends BaseFlowSection {\r\n  type: 'route';\r\n  to: string;\r\n}\r\ninterface CallbackFlowSection extends BaseFlowSection {\r\n  type: 'callback';\r\n  callback: () => void;\r\n}\r\n\r\nexport type FlowSection = RouteFlowSection | CallbackFlowSection;\r\n\r\nexport interface FlowSectionCollection {\r\n  [key: string]: FlowSection;\r\n}\r\n\r\nexport interface FlowStoreConfig {\r\n  currentProjectName?: string;\r\n  currentScenarioName?: string;\r\n  getScenario?: boolean;\r\n  getProject?: boolean;\r\n  disableCollapser?: boolean;\r\n}\r\n","import { RGBAColor } from '@/types/colors';\r\nimport { PropertySummary, PropertyType } from '@/types/schema';\r\nimport { CameraOptions, ITapefile } from '@/types/visualization';\r\nimport { PickInfo } from '@deck.gl/core/lib/deck';\r\n\r\nexport enum FlowVisualizerType {\r\n  POINTS = 'points',\r\n  LINES = 'lines',\r\n  POLYGONS = 'polygons',\r\n  ARCS = 'arcs'\r\n  // ICONS = 'icons',\r\n  // HEAT_MAP = 'heat_map'\r\n}\r\n\r\nexport interface CommonVisualizerOptions {\r\n  type: FlowVisualizerType;\r\n  color?: ColorClause;\r\n  popup?: PopupClause;\r\n  size?: SizeClause;\r\n  visibility?: VisibilityClause;\r\n}\r\n\r\nexport interface PointVisualizerOptions extends CommonVisualizerOptions {\r\n  type: FlowVisualizerType.POINTS;\r\n}\r\n\r\nexport interface LineVisualizerOptions extends CommonVisualizerOptions {\r\n  type: FlowVisualizerType.LINES;\r\n}\r\n\r\nexport interface PolygonVisualizerOptions extends CommonVisualizerOptions {\r\n  type: FlowVisualizerType.POLYGONS;\r\n}\r\n\r\nexport interface ArcVisualizerOptions extends CommonVisualizerOptions {\r\n  type: FlowVisualizerType.ARCS;\r\n}\r\n\r\nexport type FlowVisualizerOptions =\r\n  | PointVisualizerOptions\r\n  | LineVisualizerOptions\r\n  | PolygonVisualizerOptions\r\n  | ArcVisualizerOptions;\r\n\r\nexport interface LegendOptions {\r\n  title: string;\r\n  labels?: string[];\r\n}\r\nexport interface StaticColorClause {\r\n  color: RGBAColor;\r\n}\r\n\r\nexport interface ByValueColorClause {\r\n  type: 'buckets' | 'gradient';\r\n  attribute: PropertySummary | null; // talk with pelle\r\n  colors: [number, RGBAColor][];\r\n  specialColor?: RGBAColor;\r\n  undefinedColor?: RGBAColor;\r\n  minValue?: number;\r\n  maxValue?: number;\r\n}\r\n\r\nexport interface ColorClause {\r\n  static?: StaticColorClause;\r\n  byValue?: ByValueColorClause;\r\n  legend?: LegendOptions;\r\n}\r\n\r\nexport interface SizeClause {\r\n  static?: StaticSizeClause;\r\n  byValue?: ByValueSizeClause;\r\n}\r\n\r\ntype SizeUnits = 'pixels' | 'meters';\r\nexport interface StaticSizeClause {\r\n  size: number;\r\n  units: SizeUnits;\r\n  minPixels?: number;\r\n  maxPixels?: number;\r\n}\r\nexport interface ByValueSizeClause {\r\n  attribute: PropertyType | null;\r\n  sizes: [number, number][]; // [value, sizeInUnits][]\r\n  units: SizeUnits;\r\n  minPixels?: number;\r\n  maxPixels?: number;\r\n}\r\n\r\nexport interface PopupClause {\r\n  title: string;\r\n  when: 'onClick' | 'onHover';\r\n  position: 'dynamic' | 'static';\r\n  items: PopupItem[];\r\n  show?: boolean;\r\n}\r\n\r\nexport interface PopupItem {\r\n  name: string;\r\n  attribute: PropertyType;\r\n}\r\n\r\nexport interface ByValueVisibilityClause {\r\n  attribute: PropertyType;\r\n  mapping: [boolean | number, boolean][];\r\n  toggleOn: boolean; // Show entities when the attribute has this value\r\n}\r\nexport interface VisibilityClause {\r\n  byValue: ByValueVisibilityClause;\r\n}\r\n\r\nexport interface Mapper<In, Out> {\r\n  getValue(input: In): Out;\r\n}\r\n\r\nexport interface PopupContent<D = unknown> {\r\n  title: string;\r\n  pickInfo: PickInfo<D>;\r\n  position: 'dynamic' | 'static';\r\n  when: 'onClick' | 'onHover';\r\n  index: number;\r\n  items: { name: string; tapefile: ITapefile<unknown>; attribute: PropertyType }[];\r\n}\r\n\r\nexport type PopupCallback = (content: PopupContent | null) => void;\r\n\r\nexport interface View {\r\n  uuid?: string;\r\n  scenario_uuid?: string;\r\n  name: string;\r\n  config: FlowViewConfig;\r\n}\r\n\r\nexport interface FlowViewConfig {\r\n  version: number;\r\n  visualizers: FlowVisualizerConfig[];\r\n  camera?: CameraOptions;\r\n  timestamp?: number;\r\n}\r\n\r\nexport interface FlowVisualizerConfig {\r\n  name: string;\r\n  dataset_name: string;\r\n  entity_group: string;\r\n  visible?: boolean;\r\n  settings: FlowVisualizerOptions;\r\n}\r\n","import { RGBAColor } from './colors';\r\nimport {\r\n  ByValueColorClause,\r\n  FlowVisualizerType,\r\n  LegendOptions,\r\n  StaticColorClause\r\n} from './flowVisualizers';\r\n\r\nexport class ColorLegendItem {\r\n  title: string;\r\n  label?: string;\r\n  visualizerType?: FlowVisualizerType;\r\n  colorType: 'buckets' | 'gradient';\r\n  colorLegends: [string, RGBAColor][];\r\n\r\n  constructor({ title, label, visualizerType, colorType, colorLegends }: ColorLegendItem) {\r\n    this.title = title;\r\n    this.label = label;\r\n    this.visualizerType = visualizerType;\r\n    this.colorType = colorType;\r\n    this.colorLegends = colorLegends ?? [];\r\n  }\r\n}\r\n\r\nexport class ColorByValueLegendItem extends ColorLegendItem {\r\n  constructor(config: ColorLegendItem, byValue?: ByValueColorClause, legend?: LegendOptions) {\r\n    super(config);\r\n\r\n    if (byValue && legend?.labels) {\r\n      this.colorLegends = legend.labels.map((label: string, idx: number) => {\r\n        return [label, byValue.colors[idx][1]] as [string, RGBAColor];\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport class ColorStaticLegendItem extends ColorLegendItem {\r\n  constructor(config: ColorLegendItem, static_?: StaticColorClause, legend?: LegendOptions) {\r\n    super(config);\r\n\r\n    if (static_ && legend) {\r\n      this.colorLegends = [[legend.title || 'Topology', static_.color]];\r\n    }\r\n  }\r\n}\r\n\r\nexport type LegendItem = ColorByValueLegendItem | ColorStaticLegendItem;\r\n","export type PointCoordinate = [number, number];\r\nexport type Point3DCoordinate = [number, number, number];\r\nexport type CoordinateArray = PointCoordinate[];\r\nexport type Coordinate3DArray = Point3DCoordinate[];\r\nexport type LineCoordinate = CoordinateArray;\r\nexport type Line3DCoordinate = CoordinateArray;\r\nexport type PolygonCoordinate = CoordinateArray;\r\n\r\nexport type Coordinate = PointCoordinate | LineCoordinate | PolygonCoordinate;\r\nexport interface TopologyLayerData<Coord extends Coordinate> {\r\n  id: number;\r\n  idx: number;\r\n  coordinates: Coord;\r\n}\r\n\r\nexport enum EntityGeometry {\r\n  POINT = 'points',\r\n  LINE = 'lines',\r\n  POLYGON = 'polygons'\r\n}\r\n","import { UUID } from '@/types/general';\r\n\r\nexport type AnalysisTemplate = Record<string, unknown>;\r\nexport interface ShortScenario {\r\n  uuid: UUID;\r\n  name: string;\r\n  project_name: string;\r\n  display_name: string;\r\n  status?: string;\r\n  has_simulation?: boolean;\r\n  [key: string]: unknown;\r\n}\r\n\r\nexport interface Scenario extends ShortScenario {\r\n  datasets: ScenarioDataset[];\r\n  simulation_info: SimulationInfo;\r\n  has_timeline?: boolean;\r\n}\r\n\r\nexport enum SimulationMode {\r\n  TIME_ORIENTED = 'time_oriented',\r\n  EVENT_ORIENTED = 'event_oriented'\r\n}\r\n\r\nexport interface TimeOrientedSimulationInfo {\r\n  mode: SimulationMode.TIME_ORIENTED;\r\n  start_time: number;\r\n  reference_time: number;\r\n  duration: number;\r\n  time_scale: number;\r\n}\r\n\r\nexport interface EventOrientedSimulationInfo {\r\n  mode: SimulationMode.EVENT_ORIENTED;\r\n  events_dataset: string;\r\n  events: { timestamp: number; diplay_name: string }[];\r\n}\r\nexport type SimulationInfo = TimeOrientedSimulationInfo | EventOrientedSimulationInfo;\r\n\r\nexport interface ScenarioDataset {\r\n  name: string;\r\n  uuid: UUID;\r\n  type: string;\r\n  display_name?: string;\r\n}\r\nexport interface Simulation {\r\n  scenario_uuid: UUID;\r\n  scenario_name: string;\r\n  status: string;\r\n  live_mode: string;\r\n  current_time: number;\r\n}\r\n\r\nexport interface SimulationControlMessage {\r\n  speed?: number;\r\n  interval?: number;\r\n  forward_to?: number;\r\n  forward_by?: number;\r\n}\r\n\r\nexport interface TimelineInfo {\r\n  scenario_uuid: string;\r\n  timestamps: number[];\r\n  update_count: number;\r\n}\r\n","import { UUID } from '@/types/general';\r\nimport { Dataset } from './datasets';\r\nimport { FlowVisualizerType } from './flowVisualizers';\r\nimport { EntityGeometry } from './geometry';\r\nimport { Scenario, ScenarioDataset, ShortScenario } from './scenarios';\r\n\r\nexport interface DatasetSummary {\r\n  count: number;\r\n  entity_groups: EntityGroupSummary[];\r\n}\r\n\r\nexport enum DatasetFormat {\r\n  ENTITY_BASED = 'entity_based',\r\n  UNSTRUCTURED = 'unstructured',\r\n  BINARY = 'binary'\r\n}\r\n\r\nexport interface DatasetSchema {\r\n  dataset_types: DatasetType[];\r\n  entity_types: EntityType[];\r\n  property_types: PropertyType[];\r\n}\r\n\r\nexport interface DatasetType {\r\n  uuid?: UUID;\r\n  name: string;\r\n  format: DatasetFormat;\r\n}\r\n\r\nexport interface EntityType {\r\n  uuid?: UUID;\r\n  name: string;\r\n}\r\n\r\nexport interface EntityGroupSummary {\r\n  name: string;\r\n  count: number;\r\n  properties: PropertySummary[];\r\n  geometry?: EntityGeometry | null;\r\n  type?: FlowVisualizerType | null;\r\n}\r\nexport interface ComponentProperty {\r\n  component: string | null;\r\n  name: string;\r\n}\r\nexport interface PropertyType extends ComponentProperty {\r\n  uuid?: UUID;\r\n  data_type: string;\r\n  description?: string;\r\n  unit?: string;\r\n  enum_name?: string | null;\r\n}\r\n\r\nexport interface ExportConfig {\r\n  dataset: Dataset | ScenarioDataset | null;\r\n  projectName: string;\r\n  entityName: string;\r\n  scenario?: ShortScenario | Scenario;\r\n  timestamp?: number;\r\n}\r\nexport interface PropertySummary extends PropertyType {\r\n  min_val: number | null;\r\n  max_val: number | null;\r\n}\r\n","import { UUID } from '@/types/general';\r\n\r\nexport class Scope {\r\n  scope_name: string;\r\n  scope_uuid: UUID;\r\n  constructor(config: Scope) {\r\n    this.scope_name = config.scope_name;\r\n    this.scope_uuid = config.scope_uuid;\r\n  }\r\n}\r\n\r\nexport class ScopeCollection {\r\n  scopes: Scope[];\r\n  constructor(config: ScopeCollection) {\r\n    this.scopes = config.scopes;\r\n  }\r\n}\r\n\r\nexport interface RoleCollection {\r\n  roles: Role[];\r\n}\r\n\r\nexport interface Role {\r\n  display_name: string;\r\n  role_name: string;\r\n  role_uuid: UUID;\r\n}\r\n\r\nexport enum RoleType {\r\n  'owner' = 'owner',\r\n  'viewer' = 'viewer',\r\n  'user' = 'user',\r\n  'admin' = 'admin'\r\n}\r\n\r\nexport interface RoleBinding {\r\n  role: RoleType;\r\n  scope: string;\r\n}\r\n\r\nexport interface User {\r\n  active: boolean;\r\n  created_on: number;\r\n  firstname: string;\r\n  language: string;\r\n  lastname: string;\r\n  middlename: string | null;\r\n  organisation: string;\r\n  organisation_uuid: string;\r\n  user_uuid?: UUID;\r\n  username: string;\r\n  roles?: RoleBinding[];\r\n}\r\n","import { RGBAColor } from './colors';\r\nimport { ComponentProperty, PropertyType } from './schema';\r\nimport { Project } from './project';\r\nimport { ShortScenario } from './scenarios';\r\nimport { SinglePropertyTapefile } from '@/visualizers/tapefile';\r\nimport { Coordinate, TopologyLayerData } from '@/types/geometry';\r\nimport { LayerProps } from '@deck.gl/core/lib/layer';\r\nimport { PopupContent } from '@/types/flowVisualizers';\r\nimport { LayerConstructor } from '@/types/general';\r\n\r\nexport interface ViewConfig {\r\n  project_name: string;\r\n  scenario_name: string;\r\n  data_layers: VisualizerViewConfig[];\r\n  camera: CameraOptions;\r\n  timestamp?: number;\r\n}\r\n\r\nexport interface VisualizerViewConfig {\r\n  name?: string;\r\n  geometry?: string;\r\n  dataset_name: string;\r\n  entity_group: string;\r\n  mode?: VisualizationMode;\r\n  visible?: boolean;\r\n  settings: VisualizerConfigurationSettings;\r\n}\r\n\r\nexport interface CameraOptions {\r\n  longitude: number;\r\n  latitude: number;\r\n  zoom: number;\r\n  pitch: number;\r\n  bearing: number;\r\n  transitionDuration?: number;\r\n  minZoom?: number;\r\n  maxZoom?: number;\r\n}\r\n\r\nexport enum VisualizationMode {\r\n  GEOMETRY = 'geometry',\r\n  SCENARIO = 'scenario'\r\n}\r\n\r\nexport enum LayerKind {\r\n  STATIC_COLOR = 'static_color',\r\n  HEAT_MAP = 'heat_map',\r\n  COLOR_MAP = 'color_map',\r\n  ACTIVE_ENTITY = 'active_entity',\r\n  UNKNOWN = 'unknown'\r\n}\r\n\r\nexport class StaticColorLayerSettings {\r\n  kind: LayerKind.STATIC_COLOR;\r\n  color: RGBAColor;\r\n  constructor(config: Partial<StaticColorLayerSettings>) {\r\n    this.kind = LayerKind.STATIC_COLOR;\r\n    this.color = config?.color || [0, 0, 0];\r\n  }\r\n}\r\n\r\nexport class HeatmapLayerSettings {\r\n  kind: LayerKind.HEAT_MAP;\r\n  constructor() {\r\n    this.kind = LayerKind.HEAT_MAP;\r\n  }\r\n}\r\n\r\nexport type ColorMapping = [number, RGBAColor][];\r\n\r\nexport class ColorMapLayerSettings {\r\n  kind: LayerKind.COLOR_MAP;\r\n  property?: PropertyType;\r\n  colors: ColorMapping;\r\n  undefinedColor: RGBAColor;\r\n  specialColor: RGBAColor;\r\n  baseColorOverride: RGBAColor | null;\r\n  constructor(config: Partial<ColorMapLayerSettings>) {\r\n    this.kind = LayerKind.COLOR_MAP;\r\n    this.property = config?.property;\r\n    this.colors = config?.colors || [];\r\n    this.undefinedColor = config?.undefinedColor || [0, 0, 0];\r\n    this.specialColor = config?.specialColor || [0, 0, 0];\r\n    this.baseColorOverride = config?.baseColorOverride || null;\r\n  }\r\n}\r\n\r\nexport class ActiveEntityLayerSettings {\r\n  kind: LayerKind.ACTIVE_ENTITY;\r\n  color: RGBAColor;\r\n  inverted: boolean;\r\n  property?: PropertyType;\r\n  onHover?: ComponentProperty;\r\n  constructor(config: Partial<ActiveEntityLayerSettings>) {\r\n    this.kind = LayerKind.ACTIVE_ENTITY;\r\n    this.color = config?.color || [0, 0, 0];\r\n    this.inverted = config?.inverted || false;\r\n    this.property = config?.property;\r\n    this.onHover = config?.onHover;\r\n  }\r\n}\r\n\r\nexport class UnknownLayerSettings {\r\n  kind: LayerKind.UNKNOWN;\r\n  constructor() {\r\n    this.kind = LayerKind.UNKNOWN;\r\n  }\r\n}\r\n\r\nexport type VisualizerConfigurationSettings =\r\n  | StaticColorLayerSettings\r\n  | HeatmapLayerSettings\r\n  | UnknownLayerSettings\r\n  | ColorMapLayerSettings\r\n  | ActiveEntityLayerSettings;\r\n\r\nexport interface VisualizationSettings {\r\n  mode: VisualizationMode;\r\n  project: Project;\r\n  scenario: ShortScenario | null;\r\n}\r\nexport type VisualizableDataTypes = number | boolean;\r\n\r\nexport interface VisualizerCallbacks {\r\n  requestTapefile: (\r\n    attribute: ComponentProperty,\r\n    onLoad: (t: SinglePropertyTapefile<VisualizableDataTypes>) => void\r\n  ) => void;\r\n  onClick: (content: PopupContent | null) => void;\r\n  onHover: (content: PopupContent | null) => void;\r\n}\r\n\r\nexport type LayerParams<\r\n  LData extends TopologyLayerData<Coord>,\r\n  Coord extends Coordinate,\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  Props extends LayerProps<LData> = any\r\n> = {\r\n  type: LayerConstructor<LData, Props>;\r\n  props: Partial<Props>;\r\n};\r\n\r\nexport interface ITapefile<T> {\r\n  data: T[];\r\n  moveTo: (time: number) => void;\r\n  copyState: () => T[];\r\n}\r\n","import { CameraOptions, Project, VisualizationMode, VisualizationSettings } from '@/types';\r\n\r\nfunction defaultProject(): Project {\r\n  return {\r\n    name: 'unknown_project',\r\n    uuid: '<unknown_uuid>',\r\n    display_name: 'Unknown Project'\r\n  };\r\n}\r\n\r\nexport default {\r\n  viewState(): CameraOptions {\r\n    return {\r\n      latitude: 51.992381,\r\n      longitude: 4.3649092,\r\n      zoom: 10,\r\n      bearing: 0,\r\n      pitch: 0\r\n    };\r\n  },\r\n\r\n  visualisationSettings(project?: Project): VisualizationSettings {\r\n    return {\r\n      mode: VisualizationMode.GEOMETRY,\r\n      project: project || defaultProject(),\r\n      scenario: null\r\n    };\r\n  },\r\n\r\n  project: defaultProject\r\n};\r\n","export class MoviciError extends Error {\r\n  constructor(message: string) {\r\n    super(message);\r\n  }\r\n\r\n  get name() {\r\n    return 'MoviciError';\r\n  }\r\n}\r\n\r\nexport class ValidationError extends MoviciError {\r\n  constructor(message: string) {\r\n    super(message);\r\n  }\r\n\r\n  get name() {\r\n    return 'ValidationError';\r\n  }\r\n}\r\n","import proj4 from 'proj4';\r\nimport { reproject } from 'reproject';\r\nimport { ValidationError } from '@/errors';\r\nimport { Coordinate3DArray, CoordinateArray, Point3DCoordinate, PointCoordinate } from '@/types';\r\n\r\nproj4.defs(\r\n  'EPSG:28992',\r\n  '+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs'\r\n);\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\ntype GeoJSON = any;\r\n\r\nexport function transform(coord: PointCoordinate | Point3DCoordinate): PointCoordinate {\r\n  return proj4('EPSG:28992', 'WGS84', [coord[0], coord[1]]);\r\n}\r\n\r\nexport function reverseTransform(coord: PointCoordinate | Point3DCoordinate): PointCoordinate {\r\n  return proj4('WGS84', 'EPSG:28992', [coord[0], coord[1]]);\r\n}\r\n\r\nexport function transformArray(arr: CoordinateArray | Coordinate3DArray): CoordinateArray {\r\n  const len = arr.length;\r\n  const rv: CoordinateArray = new Array(arr.length);\r\n  for (let i = 0; i < len; i++) {\r\n    rv[i] = transform(arr[i]);\r\n  }\r\n  return rv;\r\n}\r\n\r\nfunction extractCRSName(geojson: GeoJSON) {\r\n  const crsInfo = geojson.crs;\r\n  let crsName;\r\n  if (crsInfo === undefined) return 'WGS84';\r\n\r\n  // taken from reproject.detectCRS\r\n  if (crsInfo.type === 'name') {\r\n    crsName = crsInfo?.properties?.name;\r\n  } else if (crsInfo.type === 'EPSG') {\r\n    crsName = 'EPSG:' + crsInfo?.properties?.code;\r\n  }\r\n  // @ts-expect-error\r\n  if (!proj4.defs[crsName]) {\r\n    throw new ValidationError('Unsupported CRS: ' + JSON.stringify(crsInfo));\r\n  }\r\n  return crsName;\r\n}\r\n\r\nexport function transformGeoJsonToCRS(geojson: GeoJSON, targetCRS = 'EPSG:28992') {\r\n  const crs = extractCRSName(geojson);\r\n  if (crs === targetCRS) return geojson;\r\n\r\n  const result = reproject(geojson, crs, targetCRS, proj4.defs);\r\n  result.crs = { properties: { name: targetCRS }, type: 'name' };\r\n  return result;\r\n}\r\n","import { transform, transformArray } from '@/crs';\r\nimport {\r\n  ComponentProperty,\r\n  Coordinate,\r\n  EntityGroupData,\r\n  EntityGroupSummary,\r\n  LineCoordinate,\r\n  LineGeometryData,\r\n  PointCoordinate,\r\n  PointGeometryData,\r\n  PolygonCoordinate,\r\n  PolygonGeometryData,\r\n  PropertyType,\r\n  TopologyLayerData\r\n} from '@/types';\r\nimport { EntityGeometry } from '@/types/geometry';\r\nimport { DatasetDownloader } from '@//utils/DatasetDownloader';\r\n\r\n/**\r\n * A `TopologyGetter` queries a DatasetStore for topology information of a certain entity group,\r\n * (ie. for point data, line data or polygon data) and converts that data into topology objects\r\n * `TopologyLayerData` which are used for the `data` prop of deck.gl `Layers`\r\n * @param store: a `DatasetStore` configured for the required dataset\r\n * @param entity: an entity group name\r\n */\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nexport abstract class TopologyGetter<Data extends EntityGroupData<any>, Coord extends Coordinate> {\r\n  protected store: DatasetDownloader;\r\n  protected entity: string;\r\n  abstract props: ComponentProperty[];\r\n  constructor(store: DatasetDownloader, entity: string) {\r\n    this.store = store;\r\n    this.entity = entity;\r\n  }\r\n  abstract getTopology(): Promise<TopologyLayerData<Coord>[]>;\r\n  protected abstract getCoordinate(data: Data, i: number): Coord | null;\r\n\r\n  protected getTopologyFromEntityData(data: Data): TopologyLayerData<Coord>[] {\r\n    const length = data.id.length;\r\n    const rv: TopologyLayerData<Coord>[] = [];\r\n    for (let i = 0; i < length; i++) {\r\n      // todo test this\r\n      const coord = this.getCoordinate(data, i);\r\n      if (!coord) {\r\n        continue;\r\n      }\r\n      rv.push({\r\n        id: data.id[i],\r\n        idx: i,\r\n        coordinates: coord\r\n      });\r\n    }\r\n    return rv;\r\n  }\r\n}\r\n\r\nexport class PointTopologyGetter extends TopologyGetter<PointGeometryData, PointCoordinate> {\r\n  props: ComponentProperty[] = [\r\n    { component: 'point_properties', name: 'position_x' },\r\n    { component: 'point_properties', name: 'position_y' }\r\n  ];\r\n  async getTopology() {\r\n    const datasetData = await this.store.getDatasetState<PointGeometryData>({\r\n      entityGroup: this.entity,\r\n      properties: this.props\r\n    });\r\n    return this.getTopologyFromEntityData(datasetData);\r\n  }\r\n  getCoordinate(data: PointGeometryData, i: number) {\r\n    if (!data?.point_properties?.position_x || !data?.point_properties?.position_y) {\r\n      throw new Error('Point geometry not found in dataset');\r\n    }\r\n    if (\r\n      data.point_properties.position_x[i] === null ||\r\n      data.point_properties.position_y[i] === null\r\n    ) {\r\n      return null;\r\n    }\r\n    return transform([data.point_properties.position_x[i], data.point_properties.position_y[i]]);\r\n  }\r\n}\r\n\r\nexport class LineTopologyGetter extends TopologyGetter<LineGeometryData, LineCoordinate> {\r\n  props: ComponentProperty[] = [\r\n    { component: 'shape_properties', name: 'linestring_2d' },\r\n    { component: 'shape_properties', name: 'linestring_3d' }\r\n  ];\r\n  async getTopology() {\r\n    const datasetData = await this.store.getDatasetState<LineGeometryData>({\r\n      entityGroup: this.entity,\r\n      properties: this.props\r\n    });\r\n    return this.getTopologyFromEntityData(datasetData);\r\n  }\r\n  getCoordinate(data: LineGeometryData, i: number) {\r\n    const arr = data?.shape_properties?.linestring_3d ?? data?.shape_properties?.linestring_2d;\r\n    if (!arr) {\r\n      throw new Error('Line geometry not found in dataset');\r\n    }\r\n    if (arr[i] === null) {\r\n      return null;\r\n    }\r\n    return transformArray(arr[i]);\r\n  }\r\n}\r\n\r\nexport class PolygonTopologyGetter extends TopologyGetter<PolygonGeometryData, PolygonCoordinate> {\r\n  props: ComponentProperty[] = [{ component: 'shape_properties', name: 'polygon' }];\r\n  async getTopology() {\r\n    const datasetData = await this.store.getDatasetState<PolygonGeometryData>({\r\n      entityGroup: this.entity,\r\n      properties: this.props\r\n    });\r\n    return this.getTopologyFromEntityData(datasetData);\r\n  }\r\n  getCoordinate(data: PolygonGeometryData, i: number) {\r\n    const arr = data?.shape_properties?.polygon;\r\n    if (!arr) {\r\n      throw new Error('Polygon geometry not found in dataset');\r\n    }\r\n    if (arr[i] === null) {\r\n      return null;\r\n    }\r\n    return transformArray(arr[i]);\r\n  }\r\n}\r\n\r\n/**\r\n * The default TopologyGetters download their topology from the initial data. This topology getter\r\n * downloads it's topology from a scenario state. For this to work, the `DatasetStore` must be\r\n * configured with a scenario uuid. The requested state is the end state of the scenario.\r\n */\r\nexport class PointTopologyFromStateGetter extends TopologyGetter<\r\n  PointGeometryData,\r\n  PointCoordinate\r\n> {\r\n  props: ComponentProperty[] = [\r\n    { component: 'point_properties', name: 'position_x' },\r\n    { component: 'point_properties', name: 'position_y' }\r\n  ];\r\n  async getTopology() {\r\n    const datasetData = await this.store.getDatasetState<PointGeometryData>({\r\n      entityGroup: this.entity,\r\n      properties: this.props\r\n    });\r\n    return this.getTopologyFromEntityData(datasetData);\r\n  }\r\n  getCoordinate(data: PointGeometryData, i: number): PointCoordinate | null {\r\n    if (!data?.point_properties?.position_x || !data?.point_properties?.position_y) {\r\n      throw new Error('Point geometry not found in dataset');\r\n    }\r\n    if (\r\n      data.point_properties.position_x[i] === null ||\r\n      data.point_properties.position_y[i] === null\r\n    ) {\r\n      return null;\r\n    }\r\n\r\n    return transform([data.point_properties.position_x[i], data.point_properties.position_y[i]]);\r\n  }\r\n}\r\nexport function determineEntityGeometry(summary: EntityGroupSummary): EntityGeometry | null {\r\n  if (isPoints(summary.properties)) return EntityGeometry.POINT;\r\n  if (isLines(summary.properties)) return EntityGeometry.LINE;\r\n  if (isPolygons(summary.properties)) return EntityGeometry.POLYGON;\r\n  return null;\r\n}\r\n\r\nexport function isPoints(properties: PropertyType[]): boolean {\r\n  return (\r\n    properties.find(p => {\r\n      return p.component === 'point_properties';\r\n    }) !== undefined\r\n  );\r\n}\r\n\r\nexport function isLines(properties: PropertyType[]): boolean {\r\n  return (\r\n    properties.find(p => {\r\n      return (\r\n        p.component === 'shape_properties' &&\r\n        (p.name === 'linestring_2d' || p.name === 'linestring_3d')\r\n      );\r\n    }) !== undefined\r\n  );\r\n}\r\n\r\nexport function isPolygons(properties: PropertyType[]): boolean {\r\n  return (\r\n    properties.find(p => {\r\n      return p.component === 'shape_properties' && p.name === 'polygon';\r\n    }) !== undefined\r\n  );\r\n}\r\n","import { Layer } from '@deck.gl/core';\r\nimport {\r\n  Coordinate,\r\n  EntityGroupData,\r\n  LayerKind,\r\n  PopupCallback,\r\n  TopologyLayerData,\r\n  VisualizerConfigurationSettings\r\n} from '@/types';\r\nimport { TopologyGetter } from '@/visualizers/geometry';\r\nimport { DatasetDownloader } from '@/utils/DatasetDownloader';\r\nimport {\r\n  AnyVisualizerInfo,\r\n  ComposableVisualizerInfo,\r\n  VisualizerInfo\r\n} from '@/visualizers/VisualizerInfo';\r\nimport { hasOwnProperty } from '@/utils';\r\n\r\nexport interface VisualizerContext {\r\n  datasetStore: DatasetDownloader;\r\n  onLoad?: () => void;\r\n  onError?: (err: Error) => void;\r\n  info: VisualizerInfo | ComposableVisualizerInfo;\r\n}\r\n\r\nexport const DIMENSIONS = {\r\n  SIZE: 3.5,\r\n  SIZE_MIN_PIXELS: 2,\r\n  SIZE_MAX_PIXELS: 5,\r\n  RADIUS_DEPRECATED: 15,\r\n  RADIUS_MIN_PIXELS_DEPRECATED: 2,\r\n  RADIUS_MAX_PIXELS_DEPRECATED: 10,\r\n  RADIUS_SCALE_DEPRECATED: 2\r\n};\r\n\r\nexport abstract class BaseVisualizer<\r\n  EntityData extends EntityGroupData<Coordinate | number>,\r\n  Coord extends Coordinate,\r\n  LData extends TopologyLayerData<Coord>,\r\n  Layer_ extends Layer<LData>\r\n> {\r\n  datasetStore: DatasetDownloader;\r\n  info: VisualizerInfo | ComposableVisualizerInfo;\r\n  order: number;\r\n  onClick: PopupCallback;\r\n  onHover: PopupCallback;\r\n  protected topology?: TopologyLayerData<Coord>[];\r\n  protected onLoad?: () => void;\r\n  protected onError?: (err: Error) => void;\r\n  protected loaded: boolean;\r\n  constructor(config: VisualizerContext) {\r\n    this.datasetStore = config.datasetStore;\r\n    this.info = config.info;\r\n    this.onLoad = config.onLoad;\r\n    this.onError = config.onError;\r\n    this.order = 0;\r\n    this.loaded = false;\r\n    this.onClick = () => {};\r\n    this.onHover = () => {};\r\n  }\r\n\r\n  get baseID(): string {\r\n    return `${this.info.id}`;\r\n  }\r\n\r\n  get kind(): LayerKind {\r\n    if (hasOwnProperty(this.info.settings, 'kind')) {\r\n      return this.info.settings.kind;\r\n    }\r\n    return LayerKind.UNKNOWN;\r\n  }\r\n\r\n  get orderedId(): string {\r\n    return `${this.info.id}-${this.order}`;\r\n  }\r\n\r\n  get priority(): number {\r\n    const layerOrder = [LayerKind.HEAT_MAP, LayerKind.UNKNOWN];\r\n    return layerOrder.indexOf(this.kind);\r\n  }\r\n\r\n  async load(callbacks?: {\r\n    onSuccess?: () => void;\r\n    onError?: (e: Error | unknown) => void;\r\n    onProgress?: (p: number) => void;\r\n  }): Promise<void> {\r\n    if (this.mustReload()) {\r\n      this.info.unsetError('load');\r\n      try {\r\n        await this.doLoad(callbacks?.onProgress);\r\n      } catch (err: unknown) {\r\n        const error = new Error(String(err));\r\n        console.error(error);\r\n\r\n        return this.handleError(error, callbacks?.onError);\r\n      } finally {\r\n        this.loaded = true;\r\n      }\r\n      this.handleSuccess(callbacks?.onSuccess);\r\n    }\r\n  }\r\n\r\n  mustReload() {\r\n    return !this.loaded;\r\n  }\r\n\r\n  settings<T extends VisualizerConfigurationSettings>() {\r\n    return this.info.settings as Required<T>;\r\n  }\r\n\r\n  setInfo(info: AnyVisualizerInfo) {\r\n    this.info = info;\r\n  }\r\n\r\n  setLayerOrder(order: number) {\r\n    this.order = order;\r\n  }\r\n\r\n  setCallbacks(callbacks: { onClick?: PopupCallback; onHover?: PopupCallback }) {\r\n    this.onClick = callbacks.onClick || this.onClick;\r\n    this.onHover = callbacks.onHover || this.onHover;\r\n  }\r\n\r\n  private handleSuccess(callback?: () => void) {\r\n    this.onLoad && this.onLoad();\r\n    callback && callback();\r\n  }\r\n\r\n  private handleError(err: Error, callback?: (e: Error) => void) {\r\n    this.info.setError('load', err.message);\r\n    if (this.onError) {\r\n      this.onError(err);\r\n    }\r\n    if (callback) {\r\n      callback(err);\r\n    }\r\n  }\r\n\r\n  abstract doLoad(onProgress?: (p: number) => void): Promise<void>;\r\n  abstract get topologyGetter(): TopologyGetter<EntityData, Coord>;\r\n  abstract getLayer(timestamp?: number): Layer_;\r\n}\r\n","import {\r\n  Coordinate,\r\n  EntityGroupData,\r\n  LayerKind,\r\n  LineCoordinate,\r\n  LineGeometryData,\r\n  PointCoordinate,\r\n  PointGeometryData,\r\n  PolygonCoordinate,\r\n  PolygonGeometryData,\r\n  StaticColorLayerSettings,\r\n  TopologyLayerData\r\n} from '@/types';\r\nimport { PathLayer, ScatterplotLayer, PolygonLayer } from '@deck.gl/layers';\r\nimport { HeatmapLayer } from '@deck.gl/aggregation-layers';\r\nimport { LineTopologyGetter, PointTopologyGetter, PolygonTopologyGetter } from './geometry';\r\nimport { Layer } from '@deck.gl/core';\r\nimport { DIMENSIONS, BaseVisualizer, VisualizerContext } from './visualizers';\r\n\r\nexport abstract class StaticDatasetVisualizer<\r\n  EntityData extends EntityGroupData<Coordinate | number>,\r\n  Coord extends Coordinate,\r\n  LData extends TopologyLayerData<Coord>,\r\n  Layer_ extends Layer<LData>\r\n> extends BaseVisualizer<EntityData, Coord, LData, Layer_> {\r\n  protected constructor(config: VisualizerContext) {\r\n    super(config);\r\n  }\r\n\r\n  async doLoad() {\r\n    this.topology = await this.topologyGetter.getTopology();\r\n  }\r\n}\r\n\r\nexport class StaticPointVisualizer extends StaticDatasetVisualizer<\r\n  PointGeometryData,\r\n  PointCoordinate,\r\n  TopologyLayerData<PointCoordinate>,\r\n  | ScatterplotLayer<TopologyLayerData<PointCoordinate>>\r\n  | HeatmapLayer<TopologyLayerData<PointCoordinate>>\r\n> {\r\n  constructor(config: VisualizerContext) {\r\n    super(config);\r\n  }\r\n\r\n  get topologyGetter(): PointTopologyGetter {\r\n    return new PointTopologyGetter(this.datasetStore, this.info.entityGroup);\r\n  }\r\n\r\n  getLayer() {\r\n    if (this.kind == LayerKind.STATIC_COLOR) {\r\n      return new ScatterplotLayer<TopologyLayerData<PointCoordinate>>({\r\n        id: this.orderedId,\r\n        data: this.topology,\r\n        pickable: false,\r\n        opacity: 0.9,\r\n        stroked: false,\r\n        filled: true,\r\n        radiusScale: DIMENSIONS.RADIUS_SCALE_DEPRECATED,\r\n        radiusMinPixels: DIMENSIONS.RADIUS_MIN_PIXELS_DEPRECATED,\r\n        radiusMaxPixels: DIMENSIONS.RADIUS_MAX_PIXELS_DEPRECATED,\r\n        getPosition: d => d.coordinates,\r\n        getRadius: DIMENSIONS.RADIUS_DEPRECATED,\r\n        getFillColor: this.settings<StaticColorLayerSettings>().color,\r\n        visible: this.info.visible\r\n      });\r\n    } else if (this.kind === LayerKind.HEAT_MAP) {\r\n      return new HeatmapLayer<TopologyLayerData<PointCoordinate>>({\r\n        id: this.orderedId,\r\n        data: this.topology,\r\n        pickable: false,\r\n        opacity: 0.7,\r\n        getPosition: d => d.coordinates,\r\n        visible: this.info.visible\r\n      });\r\n    }\r\n    throw new Error(`Unsupported layer type '${this.kind}' for layer ${this.orderedId}`);\r\n  }\r\n}\r\n\r\nexport class StaticLineVisualizer extends StaticDatasetVisualizer<\r\n  LineGeometryData,\r\n  LineCoordinate,\r\n  TopologyLayerData<LineCoordinate>,\r\n  PathLayer<TopologyLayerData<LineCoordinate>>\r\n> {\r\n  constructor(config: VisualizerContext) {\r\n    super(config);\r\n  }\r\n\r\n  get topologyGetter(): LineTopologyGetter {\r\n    return new LineTopologyGetter(this.datasetStore, this.info.entityGroup);\r\n  }\r\n\r\n  getLayer() {\r\n    return new PathLayer<TopologyLayerData<LineCoordinate>>({\r\n      id: this.orderedId,\r\n      data: this.topology,\r\n      pickable: false,\r\n      widthMinPixels: DIMENSIONS.SIZE_MIN_PIXELS,\r\n      widthMaxPixels: DIMENSIONS.SIZE_MAX_PIXELS,\r\n      getWidth: DIMENSIONS.SIZE,\r\n      getPath: d => d.coordinates,\r\n      getColor: this.settings<StaticColorLayerSettings>().color,\r\n      visible: this.info.visible\r\n    });\r\n  }\r\n}\r\n\r\nexport class StaticPolygonVisualizer extends StaticDatasetVisualizer<\r\n  PolygonGeometryData,\r\n  PolygonCoordinate,\r\n  TopologyLayerData<PolygonCoordinate>,\r\n  PolygonLayer<TopologyLayerData<PolygonCoordinate>>\r\n> {\r\n  constructor(config: VisualizerContext) {\r\n    super(config);\r\n  }\r\n\r\n  get topologyGetter(): PolygonTopologyGetter {\r\n    return new PolygonTopologyGetter(this.datasetStore, this.info.entityGroup);\r\n  }\r\n\r\n  getLayer() {\r\n    const fillColor = this.settings<StaticColorLayerSettings>().color;\r\n    fillColor[3] = 100;\r\n\r\n    return new PolygonLayer<TopologyLayerData<LineCoordinate>>({\r\n      id: this.orderedId,\r\n      data: this.topology,\r\n      pickable: false,\r\n      stroked: true,\r\n      extruded: false,\r\n      getPolygon: d => d.coordinates,\r\n      getLineColor: this.settings<StaticColorLayerSettings>().color,\r\n      getFillColor: fillColor,\r\n      getLineWidth: DIMENSIONS.SIZE,\r\n      lineWidthMinPixels: DIMENSIONS.SIZE_MIN_PIXELS,\r\n      lineWidthMaxPixels: DIMENSIONS.SIZE_MAX_PIXELS,\r\n      visible: this.info.visible\r\n    });\r\n  }\r\n}\r\n","import { ComponentProperty, EntityGroupData, EntityUpdate, Update } from '@/types';\r\nimport { DatasetDownloader } from '@//utils/DatasetDownloader';\r\n\r\nexport class TimelineDownloader {\r\n  entityGroup: string;\r\n  properties: ComponentProperty[];\r\n  store: DatasetDownloader;\r\n  reportProgress?: (p: number) => void;\r\n  private progress: number;\r\n  private maxProgress: number;\r\n  constructor(\r\n    entityGroup: string,\r\n    properties: ComponentProperty[],\r\n    store: DatasetDownloader,\r\n    reportProgress?: (p: number) => void\r\n  ) {\r\n    this.entityGroup = entityGroup;\r\n    this.properties = properties;\r\n    this.store = store;\r\n    this.reportProgress = reportProgress;\r\n    this.progress = 0;\r\n    this.maxProgress = 1;\r\n  }\r\n\r\n  async download<T>(): Promise<EntityUpdate<T>[]> {\r\n    const updates = await this.store.getUpdateList();\r\n    return await this.getUpdateData(updates);\r\n  }\r\n\r\n  updateProgress() {\r\n    this.progress++;\r\n    if (this.reportProgress) {\r\n      this.reportProgress((this.progress / this.maxProgress) * 100);\r\n    }\r\n  }\r\n\r\n  getUpdateData<T>(updatesList: Update[]): Promise<EntityUpdate<T>[]> {\r\n    this.maxProgress = updatesList.length;\r\n    const promises = [];\r\n    for (let i = 0; i < updatesList.length; i++) {\r\n      promises.push(\r\n        this.store.getUpdateData(updatesList[i], this.entityGroup, this.properties).then(update => {\r\n          this.updateProgress();\r\n          return update;\r\n        })\r\n      );\r\n    }\r\n    return Promise.all(promises).then(upd => {\r\n      return upd\r\n        .filter(upd => {\r\n          return upd?.data[this.entityGroup];\r\n        })\r\n        .map(upd => {\r\n          return {\r\n            timestamp: upd.timestamp,\r\n            iteration: upd.iteration,\r\n            data: upd.data[this.entityGroup] as EntityGroupData<T>\r\n          };\r\n        });\r\n    });\r\n  }\r\n}\r\n","import {\r\n  ComponentData,\r\n  ComponentProperty,\r\n  EntityGroupData,\r\n  EntityUpdate,\r\n  ITapefile\r\n} from '@/types';\r\nimport { TimelineDownloader } from '@//utils/timeline';\r\nimport { DatasetDownloader } from '@//utils/DatasetDownloader';\r\nimport { VisualizerInfo } from '@/visualizers/VisualizerInfo';\r\n\r\ninterface TapefileUpdate<T> {\r\n  timestamp: number;\r\n  length: number;\r\n  indices: number[];\r\n  data: T[];\r\n  rollback?: T[];\r\n}\r\n\r\nfunction getEmptyUpdate(timestamp: number): TapefileUpdate<never> {\r\n  return {\r\n    timestamp,\r\n    length: 0,\r\n    indices: [],\r\n    data: []\r\n  };\r\n}\r\n\r\nexport async function layerInfoToTapefile<T>(\r\n  layerInfo: VisualizerInfo,\r\n  property: ComponentProperty,\r\n  store: DatasetDownloader\r\n): Promise<SinglePropertyTapefile<T>> {\r\n  if (!layerInfo.scenarioUUID) {\r\n    throw new Error('Missing scenarioUUID');\r\n  }\r\n  return (\r\n    await getTapefiles<T>({\r\n      store,\r\n      entityGroup: layerInfo.entityGroup,\r\n      properties: [property]\r\n    })\r\n  )[0];\r\n}\r\n\r\nexport async function getTapefiles<T>(config: {\r\n  store: DatasetDownloader;\r\n  entityGroup: string;\r\n  properties: ComponentProperty[];\r\n}): Promise<SinglePropertyTapefile<T>[]> {\r\n  const initialData = await config.store.getInitialData<EntityGroupData<T>>({\r\n    entityGroup: config.entityGroup,\r\n    properties: config.properties\r\n  });\r\n\r\n  const updates = await new TimelineDownloader(\r\n    config.entityGroup,\r\n    config.properties,\r\n    config.store\r\n  ).download<T>();\r\n  return config.properties.map(p => createTapefileFromStateAndUpdates(p, initialData, updates));\r\n}\r\n\r\nexport function createTapefileFromStateAndUpdates<T>(\r\n  componentProperty: ComponentProperty,\r\n  initialState: EntityGroupData<T>,\r\n  updates: EntityUpdate<T>[]\r\n) {\r\n  const builder = new TapefileBuilder(componentProperty, initialState);\r\n  for (let i = 0; i < updates.length; i++) {\r\n    const update = updates[i];\r\n    builder.addUpdate(update);\r\n  }\r\n  return builder.createTapefile();\r\n}\r\n\r\nexport function mergeUpdates<T>(first: TapefileUpdate<T>, second: TapefileUpdate<T>) {\r\n  const updateMap = new Map();\r\n  function applyUpdate<T>(upd: TapefileUpdate<T>) {\r\n    for (let i = 0; i < upd.length; i++) {\r\n      updateMap.set(upd.indices[i], upd.data[i]);\r\n    }\r\n  }\r\n  applyUpdate(first);\r\n  applyUpdate(second);\r\n  const rv = {\r\n    timestamp: first.timestamp,\r\n    length: updateMap.size,\r\n    data: new Array(updateMap.size),\r\n    indices: new Array(updateMap.size)\r\n  };\r\n  let idx = 0;\r\n  for (const [key, value] of updateMap) {\r\n    rv.indices[idx] = key;\r\n    rv.data[idx] = value;\r\n    idx++;\r\n  }\r\n  return rv;\r\n}\r\n/**\r\n * Creates a SinglePropertyTapefile for a specific ComponentProperty based on `initialState` data\r\n * and subsequent updates given through `TapefileBuilder.addUpdate`.\r\n * `initialState` must be EntityGroupData that at least has the `id` field with all entities\r\n * present. For the `initialState` and subsequent given updates, the `TapefileBuilder` looks up the\r\n * data array of the `ComponentProperty` and adds that data as an update to a\r\n * `SinglePropertyTapefile` at the correct timestamp. It also calculates a rollback update to be\r\n * able to move the tapefile back in time. If there are multiple updates of a property at the\r\n * same timestamp, these are merged into a single update.\r\n */\r\nexport class TapefileBuilder<T> {\r\n  updates: TapefileUpdate<T>[];\r\n  componentProperty: ComponentProperty;\r\n  index: Index;\r\n  state: PropertyState<T>;\r\n  currentTime: number;\r\n  currentIteration: number;\r\n  isFinal: boolean;\r\n  constructor(componentProperty: ComponentProperty, inititalState: EntityGroupData<T>) {\r\n    this.updates = [];\r\n    this.componentProperty = componentProperty;\r\n    this.index = new Index(inititalState.id);\r\n    this.state = new PropertyState(inititalState.id.length);\r\n    this.currentTime = 0;\r\n    this.currentIteration = -2; // No state yet so the initial data at iteration -1 is accepted\r\n    this.isFinal = false;\r\n    this.addUpdate({ timestamp: 0, iteration: -1, data: inititalState });\r\n  }\r\n\r\n  /**\r\n   * adds an update to the Tapefile. Updates must be added in increasing\r\n   * iteration number. Updates may only be added while the TapefileBuilder\r\n   * is not finalized.\r\n   */\r\n  addUpdate(update: EntityUpdate<T>) {\r\n    if (this.isFinal) {\r\n      throw Error('Can only add updates while not finalized');\r\n    }\r\n\r\n    if (this.updates.length === 0) {\r\n      return this.addInitialUpdate(update);\r\n    }\r\n\r\n    // Now we're sure there's at least one update (with our property array) in the\r\n    // list so things like rollback and pop work\r\n\r\n    if (update.iteration <= this.currentIteration) {\r\n      throw Error('Can only accept updates in increasing iteration number');\r\n    }\r\n\r\n    let parsed = this.prepareUpdate(update);\r\n    if (!parsed) {\r\n      return;\r\n    }\r\n    // We have new update data\r\n\r\n    if (update.timestamp === this.currentTime) {\r\n      // merge update with last applied update\r\n      const lastUpdate = this.updates.pop() as TapefileUpdate<T>;\r\n      this.state.rollbackUpdate(lastUpdate);\r\n      parsed = mergeUpdates(lastUpdate, parsed);\r\n    }\r\n\r\n    // We now have one update per timestamp\r\n    parsed.rollback = this.calculateRollback(parsed);\r\n    this.state.applyUpdate(parsed);\r\n    this.updates.push(parsed);\r\n    this.currentTime = update.timestamp;\r\n    this.currentIteration = update.iteration;\r\n  }\r\n\r\n  addInitialUpdate(update: { timestamp: number; iteration: number; data: EntityGroupData<T> }) {\r\n    const parsed = this.prepareUpdate(update) || getEmptyUpdate(update.timestamp);\r\n\r\n    parsed.rollback = this.calculateRollback(parsed);\r\n    this.state.applyUpdate(parsed);\r\n    this.updates.push(parsed);\r\n\r\n    this.currentTime = update.timestamp;\r\n    this.currentIteration = update.iteration;\r\n  }\r\n\r\n  prepareUpdate(update: {\r\n    timestamp: number;\r\n    iteration: number;\r\n    data: EntityGroupData<T>;\r\n  }): TapefileUpdate<T> | null {\r\n    let dataArray = this.getDataArray(update.data);\r\n    let idArray = update.data.id || [];\r\n    if (dataArray.length !== idArray.length) {\r\n      return null;\r\n    }\r\n\r\n    // filter out nulls\r\n    const nullIndices = new Set();\r\n    for (let i = 0; i < dataArray.length; i++) {\r\n      if (dataArray[i] === null) {\r\n        nullIndices.add(i);\r\n      }\r\n    }\r\n\r\n    if (nullIndices.size) {\r\n      dataArray = dataArray.filter((_, idx) => !nullIndices.has(idx));\r\n      idArray = idArray.filter((_, idx) => !nullIndices.has(idx));\r\n    }\r\n\r\n    if (!dataArray.length) {\r\n      return null;\r\n    }\r\n\r\n    const indices = this.index.getArray(idArray);\r\n    return {\r\n      timestamp: update.timestamp,\r\n      length: dataArray.length,\r\n      indices,\r\n      data: dataArray\r\n    };\r\n  }\r\n\r\n  calculateRollback(update: TapefileUpdate<T>) {\r\n    return this.state.getDataForIndices(update.indices);\r\n  }\r\n\r\n  getDataArray(data: EntityGroupData<T>): T[] {\r\n    if (this.componentProperty.component) {\r\n      const component = data[this.componentProperty.component] as ComponentData<T>;\r\n      return component ? component[this.componentProperty.name] || [] : [];\r\n    }\r\n\r\n    return (data[this.componentProperty.name] || []) as T[];\r\n  }\r\n\r\n  createTapefile() {\r\n    this.isFinal = true;\r\n    return new SinglePropertyTapefile(this.componentProperty, this.index.length, this.updates);\r\n  }\r\n}\r\n\r\n/**\r\n * A SinglePropertyTapefile can be used to calculate the state of a specific attribute in an entity\r\n * group at a specific timestamp in a scenario. It is configured with all updates (including the\r\n * initial data) and their rollbacks. The general usage of this class is to first move the tape to\r\n * a specific timestamp using `SinglePropertyTapefile.moveTo()` and then requesting the state with\r\n * `SinglePropertyTapefile.getState()`\r\n */\r\nexport class SinglePropertyTapefile<T> implements ITapefile<T> {\r\n  componentProperty: ComponentProperty;\r\n  state: PropertyState<T>;\r\n  updates: TapefileUpdate<T>[];\r\n  currentUpdateIdx: number;\r\n  minTime: number;\r\n  maxTime: number;\r\n\r\n  constructor(componentProperty: ComponentProperty, length: number, updates: TapefileUpdate<T>[]) {\r\n    this.componentProperty = componentProperty;\r\n    this.state = new PropertyState(length);\r\n    this.state.applyUpdate(updates[0]);\r\n    this.updates = updates;\r\n    this.currentUpdateIdx = 0;\r\n    this.minTime = this.currentTime;\r\n    this.maxTime = updates[updates.length - 1].timestamp;\r\n  }\r\n\r\n  get numberOfEntities() {\r\n    return this.state.length;\r\n  }\r\n\r\n  get data() {\r\n    return this.state.data;\r\n  }\r\n\r\n  copyState() {\r\n    return this.state.copyState();\r\n  }\r\n  get currentTime() {\r\n    return this.updates[this.currentUpdateIdx].timestamp;\r\n  }\r\n\r\n  get nextTime() {\r\n    if (this.currentUpdateIdx === this.updates.length - 1) return Infinity;\r\n    return this.updates[this.currentUpdateIdx + 1].timestamp;\r\n  }\r\n\r\n  moveTo(time: number) {\r\n    if (time === this.currentTime) return;\r\n    if (time > this.currentTime) {\r\n      return this.moveForward(Math.min(time, this.maxTime));\r\n    }\r\n    if (time < this.currentTime) {\r\n      return this.moveBackward(Math.max(time, this.minTime));\r\n    }\r\n  }\r\n\r\n  moveForward(time: number) {\r\n    while (time >= this.nextTime) {\r\n      this.stepForward();\r\n    }\r\n  }\r\n\r\n  moveBackward(time: number) {\r\n    while (time < this.currentTime) {\r\n      this.stepBackward();\r\n    }\r\n  }\r\n\r\n  stepForward() {\r\n    if (this.currentUpdateIdx >= this.updates.length - 1) {\r\n      throw RangeError('Requested step out of bounds');\r\n    }\r\n    this.currentUpdateIdx++;\r\n    const newUpdate = this.updates[this.currentUpdateIdx];\r\n    this.state.applyUpdate(newUpdate);\r\n  }\r\n\r\n  stepBackward() {\r\n    if (this.currentUpdateIdx === 0) {\r\n      throw new RangeError('Requested step out of bounds');\r\n    }\r\n    const currentUpdate = this.updates[this.currentUpdateIdx];\r\n    this.state.rollbackUpdate(currentUpdate);\r\n    this.currentUpdateIdx--;\r\n  }\r\n}\r\n\r\nclass Index {\r\n  map: Map<number, number>;\r\n  length: number;\r\n  constructor(idArray: number[]) {\r\n    this.map = new Map();\r\n    for (let i = 0; i < idArray.length; i++) {\r\n      this.map.set(idArray[i], i);\r\n    }\r\n    this.length = idArray.length;\r\n  }\r\n\r\n  get(id: number) {\r\n    return this.map.get(id);\r\n  }\r\n\r\n  getArray(ids: number[]): number[] {\r\n    const rv = new Array(ids.length);\r\n    for (let i = 0; i < ids.length; i++) {\r\n      rv[i] = this.get(ids[i]);\r\n    }\r\n    return rv;\r\n  }\r\n}\r\nclass PropertyState<T> {\r\n  length: number;\r\n  data: T[];\r\n  constructor(length: number) {\r\n    this.length = length;\r\n    this.data = getEmptyArray(length);\r\n  }\r\n\r\n  getDataForIndices(indices: number[]) {\r\n    const rv = new Array(indices.length);\r\n    for (let i = 0; i < indices.length; i++) {\r\n      rv[i] = this.data[indices[i]];\r\n    }\r\n    return rv;\r\n  }\r\n\r\n  applyUpdate(update: TapefileUpdate<T>) {\r\n    return this.setUpdateData(update.indices, update.data);\r\n  }\r\n\r\n  rollbackUpdate(update: TapefileUpdate<T>) {\r\n    if (update.rollback) {\r\n      return this.setUpdateData(update.indices, update.rollback);\r\n    }\r\n  }\r\n\r\n  setUpdateData(indices: number[], data: T[]) {\r\n    for (let i = 0; i < indices.length; i++) {\r\n      this.data[indices[i]] = data[i];\r\n    }\r\n  }\r\n\r\n  copyState() {\r\n    return [...this.data];\r\n  }\r\n}\r\nfunction getEmptyArray(size: number) {\r\n  return new Array(size).fill(null);\r\n}\r\n","import {\r\n  RGBAColor,\r\n  ColorMapColorSettings,\r\n  ColorRuleSelector,\r\n  ColorRuleSet,\r\n  Nullable,\r\n  PropertyType,\r\n  Mapper\r\n} from '@//types';\r\nimport { propertyString } from '@//utils';\r\nimport isEmpty from 'lodash/isEmpty';\r\nimport cloneDeep from 'lodash/cloneDeep';\r\n\r\nexport const MoviciColors = {\r\n  PURPLE: '#A258DC',\r\n  GREEN: '#1AB67E',\r\n  ORANGE: '#F18759',\r\n  RED: '#E54B4B',\r\n  BLUE: '#5571F2',\r\n  LIGHT_BLUE: '#99AAF7',\r\n  YELLOW: '#E8B53E',\r\n  PINK: '#F98BA6',\r\n  LIGHT_PINK: '#F5B7B7',\r\n  LIGHTEST_PINK: '#FADBDB',\r\n  BROWN: '#BA763D',\r\n  WHITE: '#F1F1F1',\r\n  LIGHT_GREY: '#777777',\r\n  DARK_GREY: '#333333',\r\n  VERY_DARK_GREY: '#202020',\r\n  BLACK: '#000000'\r\n};\r\n\r\nexport function mergeColorRuleSets(...ruleSets: ColorRuleSet[]): ColorRuleSet {\r\n  if (ruleSets.length === 0) {\r\n    return {\r\n      colors: {},\r\n      rules: []\r\n    };\r\n  }\r\n  const rv = cloneDeep(ruleSets[0]);\r\n  for (const ruleset of ruleSets.splice(1)) {\r\n    Object.assign(rv.colors, ruleset.colors);\r\n    rv.rules.push(...(ruleset.rules || []));\r\n  }\r\n  return rv;\r\n}\r\n\r\n/**\r\n * Generates Color settings for a `ColorMap` based on a `ColorRuleSet`. `ColorRule`s\r\n * are applied until all required fields are set\r\n * @param entityGroup: The entity type to visualize\r\n * @param property: The property/attribute\r\n * @param ruleSet: a color rule set\r\n *\r\n * @returns `ColorMapColorSettings`\r\n */\r\nexport function generateColorSettings(\r\n  entityGroup: string,\r\n  property: PropertyType | null,\r\n  ruleSet: ColorRuleSet\r\n): ColorMapColorSettings {\r\n  const rules = ruleSet.rules.slice().sort((a, b) => a.priority - b.priority);\r\n  const requiredKeys: Set<keyof ColorMapColorSettings> = new Set([\r\n    'colors',\r\n    'specialColor',\r\n    'undefinedColor',\r\n    'baseColor'\r\n  ]);\r\n  const result: Partial<ColorMapColorSettings> = {};\r\n  for (const rule of rules) {\r\n    if (Array.from(requiredKeys).every(k => Object.prototype.hasOwnProperty.call(result, k))) break;\r\n    if (!selectorMatches(entityGroup, property, rule.selector)) continue;\r\n\r\n    if (!result.baseColor && rule.settings.baseColor) {\r\n      result.baseColor = ruleSet.colors[rule.settings.baseColor] ?? rule.settings.baseColor;\r\n    }\r\n\r\n    if (!result.specialColor && rule.settings.specialColor) {\r\n      result.specialColor =\r\n        ruleSet.colors[rule.settings.specialColor] ?? rule.settings.specialColor;\r\n    }\r\n\r\n    if (!result.undefinedColor && rule.settings.undefinedColor) {\r\n      result.undefinedColor =\r\n        ruleSet.colors[rule.settings.undefinedColor] ?? rule.settings.undefinedColor;\r\n    }\r\n\r\n    if (!result.colors && rule.settings.colors) {\r\n      result.colors = rule.settings.colors;\r\n\r\n      for (const color of result.colors) {\r\n        if (color[1] === null) {\r\n          continue;\r\n        }\r\n        color[1] = ruleSet.colors[color[1]] ?? color[1];\r\n      }\r\n    }\r\n  }\r\n  if (!hasAllKeys(result, Array.from(requiredKeys))) {\r\n    throw new Error('Incomplete Color Map Settings');\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nfunction hasAllKeys<T>(obj: Partial<T>, keys: Array<keyof T>): obj is T {\r\n  return keys.every(k => Object.prototype.hasOwnProperty.call(obj, k));\r\n}\r\n\r\nfunction selectorMatches(\r\n  entityGroup: string,\r\n  property: PropertyType | null,\r\n  selector: ColorRuleSelector\r\n) {\r\n  if (isEmpty(selector)) return false;\r\n  if (selectorMatchesAlways(entityGroup, property, selector)) return true;\r\n\r\n  return (\r\n    selectorMatchesProperty(entityGroup, property, selector) &&\r\n    selectorMatchesEntityGroup(entityGroup, property, selector) &&\r\n    selectorMatchesDataType(entityGroup, property, selector)\r\n  );\r\n}\r\nfunction selectorMatchesEntityGroup(\r\n  entityGroup: string,\r\n  property: PropertyType | null,\r\n  selector: ColorRuleSelector\r\n): boolean {\r\n  return selector.entity_group ? selector.entity_group === entityGroup : true;\r\n}\r\n\r\nfunction selectorMatchesProperty(\r\n  entityGroup: string,\r\n  property: PropertyType | null,\r\n  selector: ColorRuleSelector\r\n): boolean {\r\n  if (!selector.property) {\r\n    return true;\r\n  }\r\n  return property ? selector.property === propertyString(property) : false;\r\n}\r\nfunction selectorMatchesDataType(\r\n  entityGroup: string,\r\n  property: PropertyType | null,\r\n  selector: ColorRuleSelector\r\n): boolean {\r\n  if (!selector.data_type) {\r\n    return true;\r\n  }\r\n  return property ? selector.data_type === property.data_type : false;\r\n}\r\nfunction selectorMatchesAlways(\r\n  entityGroup: string,\r\n  property: PropertyType | null,\r\n  selector: ColorRuleSelector\r\n) {\r\n  return !!selector.always;\r\n}\r\n\r\ninterface ColormapConfig {\r\n  colors: [number, RGBAColor][];\r\n  special?: number;\r\n  specialColor: RGBAColor;\r\n  undefined?: Nullable<number>;\r\n  undefinedColor: RGBAColor;\r\n}\r\n\r\nexport class NumberColorMap implements Mapper<number | null, RGBAColor> {\r\n  /**\r\n   * Maps a number to a color. Also works for booleans. The config constructor\r\n   *  parameter has the following keys\r\n   *    values: an array of values\r\n   *    colors: an array of colors that the values should map to\r\n   *    special: the `special` value (eg NaN for most floating point properties)\r\n   *    specialColor: the color of the special value\r\n   *    undefined: the `undefined` value (eg null for most properties)\r\n   *    undefinedColor: the color of the undefined value\r\n   *\r\n   * A Color is calculated as following:\r\n   *   * special values and undefined values are assigned their own color\r\n   *   * A color is valid for values starting from it's assigned value in the `values` until\r\n   *     the next value is found. eg for a value` array `[0, 2]` for input `1` the calculated color\r\n   *     would be the color assigned to `0` as that is the highest value lower than our input\r\n   *   * for inputs lower than the lowest value in our `values` array, the first color is used\r\n   */\r\n  special: number;\r\n  specialColor: RGBAColor;\r\n  undefined: Nullable<number>;\r\n  undefinedColor: RGBAColor;\r\n  values: number[];\r\n  colors: RGBAColor[];\r\n  useCache = false;\r\n  cache: Map<number | null, RGBAColor>;\r\n\r\n  constructor(config: ColormapConfig) {\r\n    this.special = config?.special ?? NaN;\r\n    this.specialColor = config.specialColor;\r\n    this.undefined = config?.undefined ?? null;\r\n    this.undefinedColor = config.undefinedColor;\r\n    this.values = config.colors.map(c => c[0]);\r\n    this.colors = config.colors.map(c => c[1]);\r\n    this.cache = new Map();\r\n  }\r\n\r\n  getValue(value: Nullable<number>): RGBAColor {\r\n    if (this.useCache) {\r\n      const color = this.cache.get(value);\r\n      if (color) {\r\n        return color;\r\n      }\r\n    }\r\n\r\n    const color = this.calculateColor(value);\r\n    if (this.useCache) {\r\n      this.cache.set(value, color);\r\n    }\r\n    return color;\r\n  }\r\n\r\n  calculateColor(value: number | null): RGBAColor {\r\n    if (this.isSpecial(value)) return this.specialColor;\r\n    if (this.isUndefined(value)) return this.undefinedColor;\r\n    if (!this.values.length) return this.undefinedColor;\r\n    if (value <= this.values[0]) return this.colors[0];\r\n    for (let i = this.values.length - 1; i >= 0; i--) {\r\n      if (value >= this.values[i]) {\r\n        return this.colors[i];\r\n      }\r\n    }\r\n    throw new Error('Programming error while calculating color');\r\n  }\r\n\r\n  isUndefined(value: Nullable<number>): value is null {\r\n    if (this.undefined === null || value === null) {\r\n      return this.undefined === value;\r\n    }\r\n    if (isNaN(this.undefined)) return isNaN(value);\r\n    return this.undefined === value;\r\n  }\r\n\r\n  isSpecial(value: Nullable<number>) {\r\n    if (value === null) {\r\n      return false;\r\n    }\r\n    if (isNaN(this.special)) return isNaN(value);\r\n    return this.special === value;\r\n  }\r\n}\r\n\r\nexport class IntColorMap extends NumberColorMap {\r\n  useCache = true;\r\n}\r\n\r\nexport function colorTripleToHex(color: RGBAColor): string {\r\n  let rv = '#';\r\n  for (const c of color) {\r\n    if (c !== undefined) {\r\n      rv += ('0' + c.toString(16)).slice(-2);\r\n    }\r\n  }\r\n  return rv;\r\n}\r\n\r\nexport function hexToColorTriple(hexColor: string): RGBAColor {\r\n  const match = hexColor\r\n    .toLowerCase()\r\n    .match(/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/);\r\n  if (!match) {\r\n    throw new Error(`'${hexColor}' is not a valid hexadecimal color`);\r\n  }\r\n  const rv = match.splice(1).map(i => (i ? parseInt(i, 16) : undefined));\r\n  if (rv[3] === undefined) {\r\n    rv.splice(3);\r\n  }\r\n  return rv as RGBAColor;\r\n}\r\n","import { BaseVisualizer, VisualizerContext, DIMENSIONS } from '@/visualizers/visualizers';\r\nimport {\r\n  RGBAColor,\r\n  ColorMapLayerSettings,\r\n  Coordinate,\r\n  EntityGroupData,\r\n  LayerKind,\r\n  LineCoordinate,\r\n  LineGeometryData,\r\n  PointCoordinate,\r\n  PointGeometryData,\r\n  PolygonCoordinate,\r\n  PolygonGeometryData,\r\n  TopologyLayerData\r\n} from '@/types';\r\nimport { Layer } from '@deck.gl/core';\r\nimport { layerInfoToTapefile, SinglePropertyTapefile } from '@/visualizers/tapefile';\r\nimport { PathLayer, PolygonLayer, ScatterplotLayer } from '@deck.gl/layers';\r\nimport { HeatmapLayer } from '@deck.gl/aggregation-layers';\r\nimport {\r\n  LineTopologyGetter,\r\n  PointTopologyGetter,\r\n  PolygonTopologyGetter\r\n} from '@/visualizers/geometry';\r\nimport { IntColorMap, NumberColorMap } from '@/visualizers/maps/colorMaps';\r\nimport { VisualizerInfo } from '@/visualizers/VisualizerInfo';\r\n\r\nfunction colorMapFromLayerSettings(settings: ColorMapLayerSettings): NumberColorMap {\r\n  return new IntColorMap(settings);\r\n}\r\n\r\nexport abstract class TapefileVisualizer<\r\n  EntityData extends EntityGroupData<Coordinate | number>,\r\n  PropertyData extends number, // only support single value property data types (ie number) for now\r\n  Coord extends Coordinate,\r\n  LData extends TopologyLayerData<Coord>,\r\n  Layer_ extends Layer<LData>\r\n> extends BaseVisualizer<EntityData, Coord, LData, Layer_> {\r\n  tapefile: null | SinglePropertyTapefile<PropertyData>;\r\n  state: null | PropertyData[];\r\n  colorMap?: NumberColorMap;\r\n\r\n  constructor(config: VisualizerContext) {\r\n    super(config);\r\n    this.tapefile = null;\r\n    this.state = null;\r\n  }\r\n\r\n  async doLoad() {\r\n    [this.topology, this.tapefile] = await Promise.all([\r\n      this.topologyGetter.getTopology(),\r\n      layerInfoToTapefile<PropertyData>(\r\n        this.info as VisualizerInfo,\r\n        this.settings<ColorMapLayerSettings>().property,\r\n        this.datasetStore\r\n      )\r\n    ]);\r\n  }\r\n\r\n  getColor(obj: LData): RGBAColor {\r\n    if (this.colorMap) {\r\n      const val = this.state ? this.state[obj.idx] : this.colorMap.undefined;\r\n      return this.colorMap.getValue(val);\r\n    } else {\r\n      return [0, 0, 0];\r\n    }\r\n  }\r\n  updateColorMap() {\r\n    const colorSettings = this.settings<ColorMapLayerSettings>();\r\n    this.colorMap = colorMapFromLayerSettings(colorSettings);\r\n  }\r\n  updateEntityData(timestamp: number) {\r\n    if (this.tapefile) {\r\n      this.tapefile.moveTo(timestamp);\r\n      this.state = this.tapefile.copyState();\r\n    }\r\n  }\r\n}\r\n\r\nexport class TapefilePointVisualizer extends TapefileVisualizer<\r\n  PointGeometryData,\r\n  number,\r\n  PointCoordinate,\r\n  TopologyLayerData<PointCoordinate>,\r\n  | ScatterplotLayer<TopologyLayerData<PointCoordinate>>\r\n  | HeatmapLayer<TopologyLayerData<PointCoordinate>>\r\n> {\r\n  constructor(config: VisualizerContext) {\r\n    super(config);\r\n  }\r\n\r\n  get topologyGetter(): PointTopologyGetter {\r\n    return new PointTopologyGetter(this.datasetStore, this.info.entityGroup);\r\n  }\r\n\r\n  getLayer(timestamp: number) {\r\n    this.updateEntityData(timestamp);\r\n    if (this.kind == LayerKind.COLOR_MAP) {\r\n      this.updateColorMap();\r\n      return new ScatterplotLayer<TopologyLayerData<PointCoordinate>>({\r\n        id: this.orderedId,\r\n        data: this.topology,\r\n        pickable: false,\r\n        opacity: 0.9,\r\n        stroked: false,\r\n        filled: true,\r\n        radiusScale: DIMENSIONS.RADIUS_SCALE_DEPRECATED,\r\n        radiusMinPixels: DIMENSIONS.RADIUS_MIN_PIXELS_DEPRECATED,\r\n        radiusMaxPixels: DIMENSIONS.RADIUS_MAX_PIXELS_DEPRECATED,\r\n        getPosition: d => d.coordinates,\r\n        getRadius: 7,\r\n        getFillColor: this.getColor.bind(this),\r\n        visible: this.info.visible,\r\n        updateTriggers: {\r\n          getFillColor: [timestamp, this.colorMap]\r\n        }\r\n      });\r\n    }\r\n    throw new Error(`Unsupported layer type '${this.kind}' for layer ${this.orderedId}`);\r\n  }\r\n}\r\n\r\nexport class TapefileLineVisualizer extends TapefileVisualizer<\r\n  LineGeometryData,\r\n  number,\r\n  LineCoordinate,\r\n  TopologyLayerData<LineCoordinate>,\r\n  PathLayer<TopologyLayerData<LineCoordinate>>\r\n> {\r\n  constructor(config: VisualizerContext) {\r\n    super(config);\r\n  }\r\n\r\n  get topologyGetter(): LineTopologyGetter {\r\n    return new LineTopologyGetter(this.datasetStore, this.info.entityGroup);\r\n  }\r\n\r\n  getLayer(timestamp: number) {\r\n    this.updateEntityData(timestamp);\r\n\r\n    if (this.kind == LayerKind.COLOR_MAP) {\r\n      this.updateColorMap();\r\n      return new PathLayer<TopologyLayerData<LineCoordinate>>({\r\n        id: this.orderedId,\r\n        data: this.topology,\r\n        pickable: false,\r\n        widthMinPixels: DIMENSIONS.SIZE_MIN_PIXELS,\r\n        widthMaxPixels: DIMENSIONS.SIZE_MAX_PIXELS,\r\n        getWidth: DIMENSIONS.SIZE,\r\n        getPath: d => d.coordinates,\r\n        getColor: this.getColor.bind(this),\r\n        visible: this.info.visible,\r\n        updateTriggers: {\r\n          getColor: [timestamp, this.colorMap]\r\n        }\r\n      });\r\n    }\r\n    throw new Error(`Unsupported layer type '${this.kind}' for layer ${this.orderedId}`);\r\n  }\r\n}\r\n\r\nexport class TapefilePolygonVisualizer extends TapefileVisualizer<\r\n  PolygonGeometryData,\r\n  number,\r\n  PolygonCoordinate,\r\n  TopologyLayerData<PolygonCoordinate>,\r\n  PolygonLayer<TopologyLayerData<PolygonCoordinate>>\r\n> {\r\n  constructor(config: VisualizerContext) {\r\n    super(config);\r\n  }\r\n\r\n  get topologyGetter(): PolygonTopologyGetter {\r\n    return new PolygonTopologyGetter(this.datasetStore, this.info.entityGroup);\r\n  }\r\n\r\n  getFillColor(obj: TopologyLayerData<LineCoordinate>): [number, number, number, number] {\r\n    const [r, g, b] = this.getColor(obj);\r\n    return [r, g, b, 100];\r\n  }\r\n  getLayer(timestamp: number) {\r\n    this.updateEntityData(timestamp);\r\n\r\n    if (this.kind == LayerKind.COLOR_MAP) {\r\n      this.updateColorMap();\r\n      return new PolygonLayer<TopologyLayerData<LineCoordinate>>({\r\n        id: this.orderedId,\r\n        data: this.topology,\r\n        pickable: false,\r\n        stroked: true,\r\n        extruded: false,\r\n        getPolygon: d => d.coordinates,\r\n        getLineColor: this.getColor.bind(this),\r\n        getFillColor: this.getFillColor.bind(this),\r\n        getLineWidth: DIMENSIONS.SIZE,\r\n        lineWidthMinPixels: DIMENSIONS.SIZE_MIN_PIXELS,\r\n        lineWidthMaxPixels: DIMENSIONS.SIZE_MAX_PIXELS,\r\n        visible: this.info.visible,\r\n        updateTriggers: {\r\n          getLineColor: [timestamp, this.colorMap],\r\n          getFillColor: [timestamp, this.colorMap]\r\n        }\r\n      });\r\n    }\r\n    throw new Error(`Unsupported layer type '${this.kind}' for layer ${this.orderedId}`);\r\n  }\r\n}\r\n","import {\r\n  ActiveEntityLayerSettings,\r\n  Coordinate,\r\n  LayerKind,\r\n  PointCoordinate,\r\n  PointGeometryData,\r\n  TopologyLayerData\r\n} from '@/types';\r\nimport { ScatterplotLayer } from '@deck.gl/layers';\r\nimport { PointTopologyFromStateGetter } from '@/visualizers/geometry';\r\nimport { getTapefiles, SinglePropertyTapefile } from '@/visualizers/tapefile';\r\nimport { BaseVisualizer, DIMENSIONS } from '@/visualizers/visualizers';\r\n\r\ninterface ActiveEntityLayerData<Coord extends Coordinate> extends TopologyLayerData<Coord> {\r\n  onHoverText?: string | number;\r\n}\r\n\r\nexport class ActivePointVisualizer extends BaseVisualizer<\r\n  PointGeometryData,\r\n  PointCoordinate,\r\n  ActiveEntityLayerData<PointCoordinate>,\r\n  ScatterplotLayer<ActiveEntityLayerData<PointCoordinate>>\r\n> {\r\n  toggleData?: SinglePropertyTapefile<boolean>;\r\n  onHoverData?: SinglePropertyTapefile<string | number>;\r\n  declare topology?: ActiveEntityLayerData<PointCoordinate>[];\r\n  get topologyGetter(): PointTopologyFromStateGetter {\r\n    return new PointTopologyFromStateGetter(this.datasetStore, this.info.entityGroup);\r\n  }\r\n\r\n  async doLoad(): Promise<void> {\r\n    this.topology = await this.topologyGetter.getTopology();\r\n\r\n    const tapefiles = await getTapefiles<unknown>({\r\n      store: this.datasetStore,\r\n      entityGroup: this.info.entityGroup,\r\n      properties: [\r\n        this.settings<ActiveEntityLayerSettings>().property,\r\n        this.settings<ActiveEntityLayerSettings>().onHover\r\n      ]\r\n    });\r\n    this.toggleData = tapefiles[0] as SinglePropertyTapefile<boolean>;\r\n    this.onHoverData = tapefiles[1] as SinglePropertyTapefile<string | number>;\r\n  }\r\n\r\n  getDataForTimestamp(timestamp: number) {\r\n    if (!this.toggleData || !this.onHoverData || !this.topology) {\r\n      throw new Error('No data available');\r\n    }\r\n    this.toggleData.moveTo(timestamp);\r\n    this.onHoverData.moveTo(timestamp);\r\n    const rv: ActiveEntityLayerData<PointCoordinate>[] = [];\r\n\r\n    const toggles = this.toggleData.copyState();\r\n    const hoverData = this.onHoverData.copyState();\r\n    const activeWhen = !this.settings<ActiveEntityLayerSettings>().inverted;\r\n    for (const entity of this.topology) {\r\n      const toggle = toggles[entity.idx];\r\n      if (toggle === null || Boolean(toggle) != activeWhen) {\r\n        continue;\r\n      }\r\n\r\n      entity.onHoverText = hoverData[entity.idx];\r\n      rv.push(entity);\r\n    }\r\n    return rv;\r\n  }\r\n\r\n  getLayer(timestamp: number) {\r\n    if (this.kind == LayerKind.ACTIVE_ENTITY) {\r\n      return new ScatterplotLayer<ActiveEntityLayerData<PointCoordinate>>({\r\n        id: this.orderedId,\r\n        data: this.getDataForTimestamp(timestamp),\r\n        pickable: true,\r\n        opacity: 0.9,\r\n        stroked: false,\r\n        filled: true,\r\n        radiusScale: DIMENSIONS.RADIUS_SCALE_DEPRECATED,\r\n        radiusMinPixels: DIMENSIONS.RADIUS_MIN_PIXELS_DEPRECATED,\r\n        radiusMaxPixels: DIMENSIONS.RADIUS_MAX_PIXELS_DEPRECATED,\r\n        getPosition: d => d.coordinates as PointCoordinate,\r\n        getRadius: 7,\r\n        getFillColor: this.settings<ActiveEntityLayerSettings>().color,\r\n        visible: this.info.visible\r\n      });\r\n    }\r\n    throw new Error(`Unsupported layer type '${this.kind}' for layer ${this.orderedId}`);\r\n  }\r\n}\r\n","import {\r\n  ActiveEntityLayerSettings,\r\n  ColorMapLayerSettings,\r\n  HeatmapLayerSettings,\r\n  LayerKind,\r\n  StaticColorLayerSettings,\r\n  UnknownLayerSettings,\r\n  VisualizerConfigurationSettings\r\n} from '@/types';\r\n\r\n/**\r\n * Cleanup VisualizerConfigurationSettings. During configuration of a visualizer, it settings\r\n * may be polluted with attributes of different kinds of visualizers. This function returns a new\r\n * object containing only the fields belonging to the `VisualizerConfigurationSettings`\r\n * @param rawSettings: `VisualizerConfigurationSettings` that may contain extra fields/attributes\r\n */\r\nexport function cleanVisualizerSettings(\r\n  rawSettings: VisualizerConfigurationSettings\r\n): VisualizerConfigurationSettings {\r\n  switch (rawSettings.kind) {\r\n    case LayerKind.STATIC_COLOR:\r\n      return new StaticColorLayerSettings(rawSettings);\r\n    case LayerKind.HEAT_MAP:\r\n      return new HeatmapLayerSettings();\r\n    case LayerKind.COLOR_MAP:\r\n      return new ColorMapLayerSettings(rawSettings);\r\n    case LayerKind.ACTIVE_ENTITY:\r\n      return new ActiveEntityLayerSettings(rawSettings);\r\n    case LayerKind.UNKNOWN:\r\n      return new UnknownLayerSettings();\r\n  }\r\n}\r\n","import {\r\n  EntityGeometry,\r\n  FlowVisualizerConfig,\r\n  FlowVisualizerOptions,\r\n  LayerKind,\r\n  PropertyType,\r\n  UUID,\r\n  VisualizationMode,\r\n  VisualizerConfigurationSettings,\r\n  VisualizerViewConfig\r\n} from '@/types';\r\nimport { hasOwnProperty, propertyString } from '@//utils';\r\nimport { cleanVisualizerSettings } from '@/visualizers/visualizerHelpers';\r\n\r\nabstract class BaseVisualizerInfo {\r\n  name: string;\r\n  datasetName: string;\r\n  datasetUUID: string | null;\r\n  scenarioUUID: string | null;\r\n  entityGroup: string;\r\n  mode: VisualizationMode;\r\n  visible: boolean;\r\n  errors: Record<string, string>;\r\n  onProgress?: (p: number) => void;\r\n\r\n  protected constructor(config?: Partial<BaseVisualizerInfo>) {\r\n    this.datasetName = config?.datasetName ?? '';\r\n    this.datasetUUID = config?.datasetUUID ?? null;\r\n    this.name = config?.name || this.datasetName;\r\n    this.scenarioUUID = config?.scenarioUUID || null;\r\n    this.entityGroup = config?.entityGroup ?? '';\r\n    this.mode = config?.mode ?? VisualizationMode.GEOMETRY;\r\n    this.visible = config?.visible ?? true;\r\n\r\n    this.errors = config?.errors || {};\r\n    this.onProgress = config?.onProgress;\r\n  }\r\n\r\n  /**\r\n   * `setError` and `unsetError` must be used to set/unset an error for a specific category (`key`).\r\n   * This is necessary to maintain Vue reactivity on the `errors` object. Errors are given a\r\n   * category so that specific parts of the code can manage their specific error by category\r\n   * (eg. `load` for downloading errors, or `content` for when a `VisualizerInfo` object has invalid\r\n   * content\r\n   * @param key: the error category\r\n   * @param value: the error message\r\n   */\r\n  setError(key: string, value: string) {\r\n    this.errors = Object.assign({}, this.errors, { [key]: value });\r\n  }\r\n\r\n  /**\r\n   * Unset an error by category (`key`). See also `setError` above\r\n   * @param key: the error category\r\n   */\r\n  unsetError(key: string) {\r\n    delete this.errors[key];\r\n    this.errors = Object.assign({}, this.errors);\r\n  }\r\n}\r\nexport class VisualizerInfo extends BaseVisualizerInfo {\r\n  /**\r\n   * This class contains information about a visualizer. It contains information about what to\r\n   * visualize, such as the datasetName and entityGroup, information specific to the Visualizer\r\n   * (settings) and more contextual information (errors, and an onProgress callback)\r\n   * */\r\n  geometry: EntityGeometry | null;\r\n  settings: VisualizerConfigurationSettings;\r\n\r\n  constructor(config?: Partial<VisualizerInfo>) {\r\n    super(config);\r\n    this.geometry = config?.geometry ?? null;\r\n    this.settings = config?.settings ?? { kind: LayerKind.UNKNOWN };\r\n  }\r\n\r\n  get id(): string {\r\n    let rv = `${this.settings.kind}-${this.datasetName}/${this.entityGroup}`;\r\n    if (hasOwnProperty(this.settings, 'property') && this.settings.property) {\r\n      rv += '/' + propertyString(this.settings.property as PropertyType);\r\n    }\r\n    if (this.geometry) {\r\n      rv += '-' + this.geometry;\r\n    }\r\n\r\n    return rv;\r\n  }\r\n\r\n  /**\r\n   * Create a `VisualizerInfo` object from a `VisualizerViewConfig`. This also requires giving the\r\n   * scenario UUID. The `VisualizerInfo` must still be validated for any content errors.\r\n   * @param config: VisualizerViewConfig\r\n   * @param scenarioUUID: A Scenario UUID\r\n   */\r\n  static fromLayerConfig(config: VisualizerViewConfig, scenarioUUID: UUID) {\r\n    return new VisualizerInfo({\r\n      scenarioUUID,\r\n      name: config.name,\r\n      geometry: config.geometry as EntityGeometry,\r\n      datasetName: config.dataset_name,\r\n      entityGroup: config.entity_group,\r\n      mode: config.mode,\r\n      visible: config.visible,\r\n      settings: cleanVisualizerSettings(config.settings)\r\n    });\r\n  }\r\n}\r\n\r\nexport class ComposableVisualizerInfo extends BaseVisualizerInfo {\r\n  settings?: FlowVisualizerOptions;\r\n  id: string;\r\n  constructor(config?: Partial<ComposableVisualizerInfo>) {\r\n    super(config);\r\n    this.settings = config?.settings;\r\n    this.id = config?.id ?? randomID();\r\n  }\r\n\r\n  toVisualizerConfig(): FlowVisualizerConfig {\r\n    if (!this.settings) throw new Error(`No settings defined for ${this.name}`);\r\n    return {\r\n      name: this.name,\r\n      dataset_name: this.datasetName,\r\n      entity_group: this.entityGroup,\r\n      visible: this.visible,\r\n      settings: this.settings\r\n    };\r\n  }\r\n}\r\n\r\nexport type AnyVisualizerInfo = VisualizerInfo | ComposableVisualizerInfo;\r\n\r\nfunction randomID(): string {\r\n  return Math.random().toString(36);\r\n}\r\n","import { RGBAColor } from '@//types';\r\n\r\n/**\r\n * Given two subsequent entries in a color mapping, calculate intermediate colors. It linearly\r\n * interpolates between the two entries, and outputs the intermediate entries in an array. The\r\n * length of the output array is governed by nSteps\r\n *\r\n * @param a: The lower colormap entry\r\n * @param b: the higher colormap entry\r\n * @param nSteps number of steps\r\n */\r\nexport function interpolateColorMapping(\r\n  a: [number, RGBAColor],\r\n  b: [number, RGBAColor],\r\n  nSteps: number\r\n): [number, RGBAColor][] {\r\n  if (nSteps <= 0) {\r\n    return [];\r\n  }\r\n\r\n  const rv: [number, RGBAColor][] = Array(nSteps);\r\n  const stepSize = (b[0] - a[0]) / (nSteps + 1);\r\n  for (let step = 1; step < nSteps + 1; step++) {\r\n    const value = a[0] + stepSize * step;\r\n    const color = interpolateColor(a[1], b[1], step, nSteps + 1);\r\n    rv[step - 1] = [value, color];\r\n  }\r\n  return rv;\r\n}\r\n\r\nfunction interpolateColor(a: RGBAColor, b: RGBAColor, step: number, nSteps: number): RGBAColor {\r\n  if (nSteps <= 0) {\r\n    throw new Error('must have positive number of steps');\r\n  }\r\n  if (step < 0 || step >= nSteps) {\r\n    throw new Error('Step nog in between 0 and nSteps');\r\n  }\r\n  if (a.length != b.length) {\r\n    throw new Error('Incompatible colors');\r\n  }\r\n  const rv: RGBAColor = Array(a.length) as RGBAColor;\r\n\r\n  for (let i = 0; i < a.length; i++) {\r\n    const aa = a[i];\r\n    const bb = b[i];\r\n    if (aa === undefined || bb === undefined) {\r\n      continue;\r\n    }\r\n    rv[i] = Math.floor(aa + ((bb - aa) / nSteps) * step);\r\n  }\r\n\r\n  return rv;\r\n}\r\n","import { SinglePropertyTapefile } from '@/visualizers/tapefile';\r\nimport { Coordinate, LayerParams, Mapper, TopologyLayerData, VisualizerCallbacks } from '@/types';\r\nimport { ComposableVisualizerInfo } from '@/visualizers/VisualizerInfo';\r\n\r\nexport type VisualizerModuleParams = { info: ComposableVisualizerInfo };\r\n\r\nexport abstract class VisualizerModule<\r\n  Coord extends Coordinate,\r\n  LData extends TopologyLayerData<Coord>\r\n> {\r\n  info: ComposableVisualizerInfo;\r\n\r\n  constructor(params: VisualizerModuleParams) {\r\n    this.info = params.info;\r\n  }\r\n\r\n  /**\r\n   * Take in a deckgl Layer type, such as ScatterPlotLayer, and accompanying layerProps. This method\r\n   * modifies the layerProps to reflect a single aspect of AspectComposer.info object (color, size,\r\n   * etc). It can specify what tapefiles it needs to correctly configure the aspects of the Layer.\r\n   * (downloading the tapefiles is deferred to a later point so that all data is downloaded\r\n   * at the same time (and deduplicated)\r\n   *\r\n   * @param params .layerType\r\n   * @param params .layerProps\r\n   * @param visualizer: the owning ComposableVisualizer object, used for requesting tapefiles\r\n   */\r\n  abstract compose(\r\n    params: LayerParams<LData, Coord>,\r\n    visualizer: VisualizerCallbacks\r\n  ): LayerParams<LData, Coord>;\r\n\r\n  setInfo(info: ComposableVisualizerInfo) {\r\n    this.info = info;\r\n  }\r\n}\r\n\r\nexport class TapefileAccessor<In, Out> {\r\n  private tapefile?: SinglePropertyTapefile<In>;\r\n  private mapping: Mapper<In, Out>;\r\n\r\n  constructor(mapping: Mapper<In, Out>, tapefile?: SinglePropertyTapefile<In>) {\r\n    this.mapping = mapping;\r\n    this.tapefile = tapefile;\r\n  }\r\n\r\n  setTapefile(tapefile: SinglePropertyTapefile<In>) {\r\n    this.tapefile = tapefile;\r\n  }\r\n\r\n  getValue(index: number): Out {\r\n    if (this.tapefile) {\r\n      return this.mapping.getValue(this.tapefile.data[index]);\r\n    }\r\n    throw new Error('No tapefile defined for accessor');\r\n  }\r\n}\r\n","import {\r\n  ByValueColorClause,\r\n  ColorClause,\r\n  Coordinate,\r\n  LayerParams,\r\n  RGBAColor,\r\n  StaticColorClause,\r\n  TopologyLayerData,\r\n  VisualizerCallbacks\r\n} from '@/types';\r\nimport isEqual from 'lodash/isEqual';\r\nimport { NumberColorMap } from '@/visualizers/maps/colorMaps';\r\nimport { SinglePropertyTapefile } from '@/visualizers/tapefile';\r\nimport { interpolateColorMapping } from '@//utils/colorUtils';\r\nimport {\r\n  TapefileAccessor,\r\n  VisualizerModule,\r\n  VisualizerModuleParams\r\n} from '@/visualizers/visualizerModules/common';\r\n\r\ntype ColorAccessor<D> = ((d: D) => RGBAColor) | RGBAColor;\r\n\r\nexport default class ColorModule<\r\n  Coord extends Coordinate,\r\n  LData extends TopologyLayerData<Coord>\r\n> extends VisualizerModule<Coord, LData> {\r\n  accessor?: ColorAccessor<LData>;\r\n  currentSettings?: { static?: StaticColorClause; byValue?: ByValueColorClause };\r\n  constructor(params: VisualizerModuleParams) {\r\n    super(params);\r\n  }\r\n  compose(params: LayerParams<LData, Coord>, visualizer: VisualizerCallbacks) {\r\n    const changed = this.updateSettings(this.info.settings?.color ?? {});\r\n    if (!params.props.updateTriggers) {\r\n      params.props.updateTriggers = {};\r\n    }\r\n    const accessor = this.updateAccessor(changed, visualizer);\r\n    let updateTriggers: string[];\r\n    switch (params.type.layerName) {\r\n      case 'ScatterplotLayer':\r\n        params.props.getFillColor = accessor;\r\n        updateTriggers = ['getFillColor'];\r\n        break;\r\n      case 'PolygonLayer':\r\n        params.props.getLineColor = accessor;\r\n        params.props.getFillColor = this.setOpacity(accessor, 80);\r\n        updateTriggers = ['getLineColor', 'getFillColor'];\r\n        break;\r\n      case 'ArcLayer':\r\n        params.props.getSourceColor = accessor;\r\n        params.props.getTargetColor = accessor;\r\n        updateTriggers = ['getSourceColor', 'getTargetColor'];\r\n        break;\r\n      default:\r\n        params.props.getColor = accessor;\r\n        updateTriggers = ['getColor'];\r\n    }\r\n    for (const trigger of updateTriggers) {\r\n      params.props.updateTriggers[trigger] = [this.currentSettings];\r\n    }\r\n    return params;\r\n  }\r\n\r\n  /**\r\n   * Updates current settings. returns true when values have changed, otherwise false\r\n   * @param settings\r\n   */\r\n  private updateSettings(settings: {\r\n    static?: StaticColorClause;\r\n    byValue?: ByValueColorClause;\r\n  }): boolean {\r\n    const changed = !isEqual(settings, this.currentSettings);\r\n    if (changed) {\r\n      this.currentSettings = settings;\r\n    }\r\n    return changed;\r\n  }\r\n\r\n  private updateAccessor(changed: boolean, visualizer: VisualizerCallbacks): ColorAccessor<LData> {\r\n    if (!changed && this.accessor) {\r\n      return this.accessor;\r\n    }\r\n    this.accessor = this.getAccessor(this.currentSettings, visualizer);\r\n    return this.accessor;\r\n  }\r\n\r\n  private getAccessor(\r\n    clause: ColorClause | undefined,\r\n    visualizer: VisualizerCallbacks\r\n  ): ColorAccessor<LData> {\r\n    if (clause?.byValue?.attribute) {\r\n      const colorMap = new NumberColorMap({\r\n        colors: this.prepareColors(clause.byValue),\r\n        specialColor: clause.byValue.specialColor ?? [0, 0, 0],\r\n        undefinedColor: clause.byValue.undefinedColor ?? [0, 0, 0]\r\n      });\r\n      const accessor = new TapefileAccessor(colorMap);\r\n      visualizer.requestTapefile(clause.byValue.attribute, t => {\r\n        accessor.setTapefile(t as SinglePropertyTapefile<number>);\r\n      });\r\n      return (d: LData) => accessor.getValue(d.idx);\r\n    }\r\n    if (clause?.static) {\r\n      return clause.static.color;\r\n    }\r\n    return [0, 0, 0];\r\n  }\r\n  private setOpacity(accessor: ColorAccessor<LData>, opacity: number): ColorAccessor<LData> {\r\n    if (Array.isArray(accessor)) {\r\n      const rv: RGBAColor = [...accessor];\r\n      rv[3] = opacity;\r\n      return rv;\r\n    }\r\n    return (d: LData) =>\r\n      [...(accessor(d).slice(0, 3) as [number, number, number]), opacity] as RGBAColor;\r\n  }\r\n\r\n  prepareColors(colorClause: ByValueColorClause): [number, RGBAColor][] {\r\n    const colors = colorClause.colors;\r\n    if (colors.length < 2 || colorClause.type == 'buckets') {\r\n      return colors;\r\n    }\r\n\r\n    const minColors = 20;\r\n    const minInBetween = 5;\r\n\r\n    const inBetween = Math.max(\r\n      minInBetween,\r\n      Math.ceil((minColors - colors.length) / (colors.length - 1))\r\n    );\r\n    const rv: [number, RGBAColor][] = [];\r\n    for (let i = 0; i < colors.length - 1; i++) {\r\n      rv.push(colors[i]);\r\n      rv.push(...interpolateColorMapping(colors[i], colors[i + 1], inBetween));\r\n    }\r\n    rv.push(colors[colors.length - 1]);\r\n    return rv;\r\n  }\r\n}\r\n","import {\r\n  Coordinate,\r\n  LayerParams,\r\n  PopupClause,\r\n  PopupContent,\r\n  TopologyLayerData,\r\n  VisualizerCallbacks\r\n} from '@/types';\r\nimport isEqual from 'lodash/isEqual';\r\nimport { PickInfo } from '@deck.gl/core/lib/deck';\r\nimport { SinglePropertyTapefile } from '@/visualizers/tapefile';\r\nimport { VisualizerModule, VisualizerModuleParams } from '@/visualizers/visualizerModules/common';\r\n\r\ntype PickingHandler<D> = (info: PickInfo<D>) => boolean;\r\n\r\nexport default class PopupModule<\r\n  Coord extends Coordinate,\r\n  LData extends TopologyLayerData<Coord>\r\n> extends VisualizerModule<Coord, LData> {\r\n  accessor: PickingHandler<LData> | null;\r\n  currentSettings: PopupClause | null;\r\n\r\n  constructor(params: VisualizerModuleParams) {\r\n    super(params);\r\n    this.currentSettings = null;\r\n    this.accessor = null;\r\n  }\r\n\r\n  compose(\r\n    params: LayerParams<LData, Coord>,\r\n    visualizer: VisualizerCallbacks\r\n  ): LayerParams<LData, Coord> {\r\n    const changed = this.updateSettings(this.info.settings?.popup || null),\r\n      accessor = this.updateAccessor(changed, visualizer),\r\n      when = this.currentSettings?.when,\r\n      show = this.currentSettings?.show ?? true;\r\n\r\n    params.props.pickable = false;\r\n\r\n    if (show) {\r\n      if (when) {\r\n        params.props.pickable = true;\r\n        params.props[when] = accessor;\r\n      }\r\n      // to close popup while on hover\r\n      if (when === 'onHover') {\r\n        params.props.onClick = () => {\r\n          visualizer.onHover(null);\r\n        };\r\n      }\r\n    }\r\n\r\n    return params;\r\n  }\r\n  private updateSettings(settings: PopupClause | null): boolean {\r\n    const changed = !isEqual(settings, this.currentSettings);\r\n    if (changed) {\r\n      this.currentSettings = settings;\r\n    }\r\n    return changed;\r\n  }\r\n\r\n  private updateAccessor(\r\n    changed: boolean,\r\n    visualizer: VisualizerCallbacks\r\n  ): PickingHandler<LData> | null {\r\n    if (!changed && this.accessor) {\r\n      return this.accessor;\r\n    }\r\n    this.accessor = this.getAccessor(this.currentSettings, visualizer);\r\n    return this.accessor;\r\n  }\r\n\r\n  private getAccessor(\r\n    clause: PopupClause | null,\r\n    visualizer: VisualizerCallbacks\r\n  ): PickingHandler<LData> | null {\r\n    if (!clause || !(clause.show ?? true)) {\r\n      return null;\r\n    }\r\n\r\n    const accessor = new PopupContentAccessor(clause);\r\n    for (const [idx, item] of clause.items.entries()) {\r\n      visualizer.requestTapefile(item.attribute, t => {\r\n        accessor.setTapefile(t, idx);\r\n      });\r\n    }\r\n\r\n    // TODO fix typing\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    return (info: any) => {\r\n      if (info && info.object) {\r\n        visualizer[clause.when](accessor.getValue(info.object.idx, info));\r\n      } else {\r\n        visualizer[clause.when](null);\r\n      }\r\n      return true;\r\n    };\r\n  }\r\n}\r\n\r\nexport class PopupContentAccessor {\r\n  private readonly tapefiles: SinglePropertyTapefile<unknown>[];\r\n  private popup: PopupClause;\r\n  constructor(popup: PopupClause) {\r\n    this.tapefiles = new Array(popup.items.length);\r\n    this.popup = popup;\r\n  }\r\n  setTapefile(tapefile: SinglePropertyTapefile<unknown>, index: number) {\r\n    if (index >= this.tapefiles.length) {\r\n      throw new Error('Tapefile assignment out of bounds');\r\n    }\r\n    this.tapefiles[index] = tapefile;\r\n  }\r\n\r\n  getValue(index: number, pickInfo: PickInfo<unknown>): PopupContent {\r\n    return {\r\n      title: this.popup.title,\r\n      pickInfo,\r\n      when: this.popup.when,\r\n      position: this.popup.position,\r\n      items: this.popup.items.map((item, idx) => {\r\n        return {\r\n          name: item.name,\r\n          attribute: item.attribute,\r\n          tapefile: this.tapefiles[idx]\r\n        };\r\n      }),\r\n      index\r\n    };\r\n  }\r\n}\r\n","import { Mapper, Nullable } from '@/types';\r\n\r\ntype SizeMapConfig = {\r\n  sizes: [number, number][];\r\n};\r\n\r\nexport class NumberSizeMap implements Mapper<number | null, number> {\r\n  /**\r\n   * Maps a number to a size. Also works for booleans. The config constructor\r\n   *  parameter has the following keys\r\n   *    values: an array of values\r\n   *\r\n   * A size is calculated as following:\r\n   *   * A size is valid for values starting from it's assigned value in the `values` until\r\n   *     the next value is found. eg for a value` array `[0, 2]` for input `1` the calculated size\r\n   *     would be the size assigned to `0` as that is the highest value lower than our input\r\n   *   * for inputs lower than the lowest value in our `values` array, the first size is used\r\n   */\r\n  useCache = false;\r\n  cache: Map<number | null, number>;\r\n\r\n  values: number[];\r\n  sizes: number[];\r\n\r\n  constructor(config: SizeMapConfig) {\r\n    this.values = config.sizes.map(c => c[0]);\r\n    this.sizes = config.sizes.map(c => c[1]);\r\n    this.cache = new Map();\r\n  }\r\n\r\n  getValue(value: Nullable<number>): number {\r\n    let size;\r\n    if (this.useCache) {\r\n      size = this.cache.get(value);\r\n      if (size) {\r\n        return size;\r\n      }\r\n    }\r\n\r\n    size = this.calculateSize(value);\r\n    if (this.useCache) {\r\n      this.cache.set(value, size);\r\n    }\r\n    return size;\r\n  }\r\n\r\n  calculateSize(value: number | null): number {\r\n    if (value === null || !this.values.length || isNaN(value)) return 0;\r\n    if (this.values.length == 1 || value <= this.values[0]) return this.sizes[0];\r\n    if (value >= this.values[this.values.length - 1]) return this.sizes[this.sizes.length - 1];\r\n    for (let i = this.values.length - 2; i >= 0; i--) {\r\n      if (value >= this.values[i]) {\r\n        return getInterpolatedValue(\r\n          this.values[i],\r\n          this.sizes[i],\r\n          this.values[i + 1],\r\n          this.sizes[i + 1],\r\n          value\r\n        );\r\n      }\r\n    }\r\n    throw new Error('Programming error while calculating sizes');\r\n  }\r\n}\r\n\r\nfunction getInterpolatedValue(X1: number, Y1: number, X2: number, Y2: number, x: number) {\r\n  return Y1 + ((Y2 - Y1) / (X2 - X1)) * (x - X1);\r\n}\r\n","import {\r\n  ByValueSizeClause,\r\n  Coordinate,\r\n  LayerParams,\r\n  StaticSizeClause,\r\n  SizeClause,\r\n  TopologyLayerData,\r\n  VisualizerCallbacks\r\n} from '@/types';\r\nimport isEqual from 'lodash/isEqual';\r\nimport { NumberSizeMap } from '../maps/sizeMaps';\r\nimport { SinglePropertyTapefile } from '../tapefile';\r\nimport { DIMENSIONS } from '../visualizers';\r\nimport { TapefileAccessor, VisualizerModule, VisualizerModuleParams } from './common';\r\n\r\ntype SizeAccessor<D> = ((d: D) => number) | number;\r\n\r\nexport default class SizeModule<\r\n  Coord extends Coordinate,\r\n  LData extends TopologyLayerData<Coord>\r\n> extends VisualizerModule<Coord, LData> {\r\n  accessor?: SizeAccessor<LData>;\r\n  currentSettings?: { static?: StaticSizeClause; byValue?: ByValueSizeClause };\r\n  constructor(params: VisualizerModuleParams) {\r\n    super(params);\r\n  }\r\n  compose(params: LayerParams<LData, Coord>, visualizer: VisualizerCallbacks) {\r\n    const changed = this.updateSettings(this.info.settings?.size ?? {});\r\n    const sizeClause = this.getClause();\r\n\r\n    if (!params.props.updateTriggers) {\r\n      params.props.updateTriggers = {};\r\n    }\r\n    const accessor = this.updateAccessor(changed, visualizer);\r\n    let updateTriggers: string[];\r\n\r\n    const {\r\n      units,\r\n      minPixels = DIMENSIONS.SIZE_MIN_PIXELS,\r\n      maxPixels = DIMENSIONS.SIZE_MAX_PIXELS\r\n    } = sizeClause ?? { units: 'pixels' };\r\n\r\n    switch (params.type.layerName) {\r\n      case 'ScatterplotLayer':\r\n        params.props.getRadius = accessor;\r\n        params.props.radiusUnits = units;\r\n        if (units == 'meters') {\r\n          params.props.radiusMaxPixels = maxPixels;\r\n          params.props.radiusMinPixels = minPixels;\r\n        }\r\n        updateTriggers = ['getRadius'];\r\n        break;\r\n      case 'PathLayer':\r\n      case 'LineLayer':\r\n      case 'ArcLayer':\r\n        params.props.getWidth = accessor;\r\n        params.props.widthUnits = units;\r\n        if (units == 'meters') {\r\n          params.props.widthMaxPixels = maxPixels;\r\n          params.props.widthMinPixels = minPixels;\r\n        }\r\n        updateTriggers = ['getWidth'];\r\n        break;\r\n      case 'PolygonLayer':\r\n        params.props.getLineWidth = accessor;\r\n        params.props.lineWidthUnits = units;\r\n        if (units === 'meters') {\r\n          params.props.lineWidthMaxPixels = maxPixels;\r\n          params.props.lineWidthMinPixels = minPixels;\r\n        }\r\n        updateTriggers = ['getLineWidth'];\r\n        break;\r\n      default:\r\n        params.props.getWidth = accessor;\r\n        updateTriggers = ['getWidth'];\r\n    }\r\n\r\n    for (const trigger of updateTriggers) {\r\n      params.props.updateTriggers[trigger] = [this.currentSettings];\r\n    }\r\n    return params;\r\n  }\r\n\r\n  getClause() {\r\n    const size = this.info.settings?.size;\r\n    if (size?.static) return size.static;\r\n    if (size?.byValue) return size.byValue;\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Updates current settings. returns true when values have changed, otherwise false\r\n   * @param settings\r\n   */\r\n  private updateSettings(settings: {\r\n    static?: StaticSizeClause;\r\n    byValue?: ByValueSizeClause;\r\n  }): boolean {\r\n    const changed = !isEqual(settings, this.currentSettings);\r\n    if (changed) {\r\n      this.currentSettings = settings;\r\n    }\r\n    return changed;\r\n  }\r\n\r\n  private updateAccessor(changed: boolean, visualizer: VisualizerCallbacks): SizeAccessor<LData> {\r\n    if (!changed && this.accessor) {\r\n      return this.accessor;\r\n    }\r\n    this.accessor = this.getAccessor(this.currentSettings, visualizer);\r\n    return this.accessor;\r\n  }\r\n\r\n  private getAccessor(\r\n    clause: SizeClause | undefined,\r\n    visualizer: VisualizerCallbacks\r\n  ): SizeAccessor<LData> {\r\n    if (clause?.byValue?.attribute) {\r\n      const sizeMap = new NumberSizeMap({\r\n        sizes: clause.byValue.sizes\r\n      });\r\n\r\n      const accessor = new TapefileAccessor(sizeMap);\r\n      visualizer.requestTapefile(clause.byValue.attribute, t => {\r\n        accessor.setTapefile(t as SinglePropertyTapefile<number>);\r\n      });\r\n\r\n      return (d: LData) => accessor.getValue(d.idx);\r\n    }\r\n\r\n    if (clause?.static) {\r\n      return clause.static.size;\r\n    }\r\n    return DIMENSIONS.SIZE;\r\n  }\r\n}\r\n","import { getTapefiles, SinglePropertyTapefile } from '@/visualizers/tapefile';\r\nimport { AnyVisualizerInfo, ComposableVisualizerInfo } from '@/visualizers/VisualizerInfo';\r\nimport { Layer } from '@deck.gl/core';\r\nimport {\r\n  ComponentProperty,\r\n  Coordinate,\r\n  EntityGroupData,\r\n  LayerConstructor,\r\n  LayerParams,\r\n  LineCoordinate,\r\n  LineGeometryData,\r\n  PointCoordinate,\r\n  PointGeometryData,\r\n  PolygonCoordinate,\r\n  PolygonGeometryData,\r\n  TopologyLayerData,\r\n  VisualizableDataTypes,\r\n  VisualizerCallbacks\r\n} from '@/types';\r\nimport { parsePropertyString, propertyString } from '@//utils';\r\nimport { ArcLayer, PathLayer, PolygonLayer, ScatterplotLayer } from '@deck.gl/layers';\r\nimport { BaseVisualizer, VisualizerContext } from './visualizers';\r\nimport { LineTopologyGetter, PointTopologyGetter, PolygonTopologyGetter } from './geometry';\r\nimport { ColorModule, PopupModule, VisualizerModule } from './visualizerModules';\r\nimport SizeModule from './visualizerModules/SizeModule';\r\n\r\nabstract class ComposableVisualizer<\r\n    EntityData extends EntityGroupData<Coordinate | number>,\r\n    Coord extends Coordinate,\r\n    LData extends TopologyLayerData<Coord>,\r\n    Layer_ extends Layer<LData>\r\n  >\r\n  extends BaseVisualizer<EntityData, Coordinate, LData, Layer_>\r\n  implements VisualizerCallbacks {\r\n  attributes: Record<string, ((t: SinglePropertyTapefile<VisualizableDataTypes>) => void)[]>;\r\n  tapefiles: Record<string, SinglePropertyTapefile<VisualizableDataTypes>>;\r\n  topology?: LData[];\r\n  modules: VisualizerModule<Coord, LData>[] | null;\r\n\r\n  constructor(config: VisualizerContext) {\r\n    super(config);\r\n    this.attributes = {};\r\n    this.tapefiles = {};\r\n    this.modules = null;\r\n  }\r\n  abstract getModules(): VisualizerModule<Coord, LData>[];\r\n\r\n  abstract getDefaultParams(): LayerParams<LData, Coord>;\r\n\r\n  mustReload(): boolean {\r\n    return true;\r\n  }\r\n\r\n  async doLoad() {\r\n    if (!this.topology) {\r\n      this.topology = (await this.topologyGetter.getTopology()) as LData[];\r\n    }\r\n    this.compose();\r\n    await this.ensureTapefiles();\r\n    this.distributeTapefiles();\r\n  }\r\n\r\n  private compose(): LayerParams<LData, Coord> {\r\n    this.attributes = {};\r\n    const modules = this.ensureModules();\r\n    let props = this.getDefaultParams();\r\n    for (const mod of modules) {\r\n      props = mod.compose(props, this);\r\n    }\r\n    return props;\r\n  }\r\n\r\n  ensureModules(): VisualizerModule<Coord, LData>[] {\r\n    if (!this.modules) {\r\n      this.modules = this.getModules();\r\n    }\r\n    return this.modules;\r\n  }\r\n\r\n  setInfo(info: AnyVisualizerInfo) {\r\n    if (!(info instanceof ComposableVisualizerInfo)) {\r\n      throw new Error('unsupported VisualizerInfo');\r\n    }\r\n    super.setInfo(info);\r\n\r\n    if (this.modules) {\r\n      this.modules.forEach(m => m.setInfo(info));\r\n    }\r\n  }\r\n\r\n  requestTapefile(\r\n    attribute: ComponentProperty,\r\n    onLoad: (t: SinglePropertyTapefile<VisualizableDataTypes>) => void\r\n  ) {\r\n    const key = propertyString(attribute);\r\n    if (!this.attributes[key]) {\r\n      this.attributes[key] = [];\r\n    }\r\n    this.attributes[key].push(onLoad);\r\n  }\r\n\r\n  async ensureTapefiles() {\r\n    const toDownload = Object.keys(this.attributes).filter(attr => !this.tapefiles[attr]);\r\n    if (toDownload.length) {\r\n      const properties = toDownload.map(s => parsePropertyString(s));\r\n      const tapefiles = await getTapefiles<VisualizableDataTypes>({\r\n        store: this.datasetStore,\r\n        entityGroup: this.info.entityGroup,\r\n        properties\r\n      });\r\n\r\n      for (const [idx, key] of toDownload.entries()) {\r\n        this.tapefiles[key] = tapefiles[idx];\r\n      }\r\n    }\r\n  }\r\n\r\n  distributeTapefiles() {\r\n    for (const key of Object.keys(this.attributes)) {\r\n      for (const callback of this.attributes[key]) {\r\n        callback(this.tapefiles[key]);\r\n      }\r\n    }\r\n  }\r\n  updateTimestamp(timestamp: number) {\r\n    for (const tapefile of Object.values(this.tapefiles)) {\r\n      tapefile.moveTo(timestamp);\r\n    }\r\n  }\r\n\r\n  getLayer(timestamp: number) {\r\n    this.updateTimestamp(timestamp);\r\n    const layerParams = this.compose();\r\n    this.distributeTapefiles();\r\n    for (const triggers of Object.values(layerParams.props.updateTriggers)) {\r\n      (triggers as unknown[]).push(timestamp);\r\n    }\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    return new layerParams.type(layerParams.props) as any;\r\n  }\r\n}\r\n\r\nexport class ComposablePointVisualizer extends ComposableVisualizer<\r\n  PointGeometryData,\r\n  PointCoordinate,\r\n  TopologyLayerData<PointCoordinate>,\r\n  ScatterplotLayer<TopologyLayerData<PointCoordinate>>\r\n> {\r\n  getModules() {\r\n    return this.info instanceof ComposableVisualizerInfo\r\n      ? getCommonModules<PointCoordinate, TopologyLayerData<PointCoordinate>>(this.info)\r\n      : [];\r\n  }\r\n  get topologyGetter(): PointTopologyGetter {\r\n    return new PointTopologyGetter(this.datasetStore, this.info.entityGroup);\r\n  }\r\n  getDefaultParams(): LayerParams<TopologyLayerData<PointCoordinate>, PointCoordinate> {\r\n    return {\r\n      type: ScatterplotLayer as LayerConstructor<TopologyLayerData<PointCoordinate>>,\r\n      props: {\r\n        id: this.orderedId,\r\n        data: this.topology ?? [],\r\n        visible: this.info.visible,\r\n        opacity: 0.9,\r\n        getPosition: (d: TopologyLayerData<PointCoordinate>) => d.coordinates,\r\n        parameters: {\r\n          depthTest: false\r\n        },\r\n        updateTriggers: {}\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\nexport class ComposableLineVisualizer extends ComposableVisualizer<\r\n  LineGeometryData,\r\n  LineCoordinate,\r\n  TopologyLayerData<LineCoordinate>,\r\n  PathLayer<TopologyLayerData<LineCoordinate>>\r\n> {\r\n  get topologyGetter(): LineTopologyGetter {\r\n    return new LineTopologyGetter(this.datasetStore, this.info.entityGroup);\r\n  }\r\n  getModules() {\r\n    return this.info instanceof ComposableVisualizerInfo\r\n      ? getCommonModules<LineCoordinate, TopologyLayerData<LineCoordinate>>(this.info)\r\n      : [];\r\n  }\r\n\r\n  getDefaultParams(): LayerParams<TopologyLayerData<LineCoordinate>, LineCoordinate> {\r\n    return {\r\n      type: PathLayer as LayerConstructor<TopologyLayerData<LineCoordinate>>,\r\n      props: {\r\n        id: this.orderedId,\r\n        data: this.topology,\r\n        rounded: true,\r\n        visible: this.info.visible,\r\n        getPath: (d: TopologyLayerData<LineCoordinate>) => d.coordinates,\r\n        parameters: {\r\n          depthTest: false\r\n        },\r\n        updateTriggers: {}\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\nexport class ComposablePolygonVisualizer extends ComposableVisualizer<\r\n  PolygonGeometryData,\r\n  PolygonCoordinate,\r\n  TopologyLayerData<PolygonCoordinate>,\r\n  PolygonLayer<TopologyLayerData<PolygonCoordinate>>\r\n> {\r\n  get topologyGetter(): PolygonTopologyGetter {\r\n    return new PolygonTopologyGetter(this.datasetStore, this.info.entityGroup);\r\n  }\r\n  getModules() {\r\n    return this.info instanceof ComposableVisualizerInfo\r\n      ? getCommonModules<PolygonCoordinate, TopologyLayerData<PolygonCoordinate>>(this.info)\r\n      : [];\r\n  }\r\n\r\n  getDefaultParams() {\r\n    return {\r\n      type: PolygonLayer as LayerConstructor<TopologyLayerData<PolygonCoordinate>>,\r\n      props: {\r\n        id: this.orderedId,\r\n        data: this.topology,\r\n        lineJointRounded: true,\r\n        visible: this.info.visible,\r\n        getPolygon: (d: TopologyLayerData<PolygonCoordinate>) => d.coordinates,\r\n        parameters: {\r\n          depthTest: false\r\n        },\r\n        updateTriggers: {}\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\nexport class ComposableArcVisualizer extends ComposableLineVisualizer {\r\n  getDefaultParams(): LayerParams<TopologyLayerData<LineCoordinate>, LineCoordinate> {\r\n    return {\r\n      type: ArcLayer as LayerConstructor<TopologyLayerData<LineCoordinate>>,\r\n      props: {\r\n        id: this.orderedId,\r\n        data: this.topology,\r\n        visible: this.info.visible,\r\n        getHeight: 0.5,\r\n        getSourcePosition: (d: TopologyLayerData<LineCoordinate>) => d.coordinates[0],\r\n        getTargetPosition: (d: TopologyLayerData<LineCoordinate>) => {\r\n          return d.coordinates[d.coordinates.length - 1];\r\n        },\r\n        parameters: {\r\n          depthTest: false\r\n        },\r\n        updateTriggers: {}\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\nfunction getCommonModules<Coord extends Coordinate, LData extends TopologyLayerData<Coord>>(\r\n  info: ComposableVisualizerInfo\r\n): VisualizerModule<Coord, LData>[] {\r\n  return [\r\n    new ColorModule<Coord, LData>({ info }),\r\n    new PopupModule<Coord, LData>({ info }),\r\n    new SizeModule<Coord, LData>({ info })\r\n  ];\r\n}\r\n","import {\r\n  StaticLineVisualizer,\r\n  StaticPointVisualizer,\r\n  StaticPolygonVisualizer\r\n} from './staticVisualizers';\r\nimport { VisualizerContext } from './visualizers';\r\nimport {\r\n  TapefileLineVisualizer,\r\n  TapefilePointVisualizer,\r\n  TapefilePolygonVisualizer\r\n} from '@/visualizers/tapefileVisualizers';\r\nimport { ActivePointVisualizer } from '@/visualizers/activeEntityVisualizers';\r\nimport { FlowVisualizerType, LayerKind, Nullable } from '@/types';\r\nimport { EntityGeometry } from '@/types/geometry';\r\nimport {\r\n  AnyVisualizerInfo,\r\n  ComposableVisualizerInfo,\r\n  VisualizerInfo\r\n} from '@/visualizers/VisualizerInfo';\r\nimport {\r\n  ComposableArcVisualizer,\r\n  ComposableLineVisualizer,\r\n  ComposablePointVisualizer,\r\n  ComposablePolygonVisualizer\r\n} from '@/visualizers/composableVisualizers';\r\n\r\nexport type Visualizer =\r\n  | StaticPointVisualizer\r\n  | StaticLineVisualizer\r\n  | StaticPolygonVisualizer\r\n  | TapefilePointVisualizer\r\n  | TapefileLineVisualizer\r\n  | TapefilePolygonVisualizer\r\n  | ActivePointVisualizer\r\n  | ComposablePointVisualizer\r\n  | ComposableLineVisualizer\r\n  | ComposablePolygonVisualizer;\r\n\r\nexport interface VisualizerConstructor {\r\n  new (config: VisualizerContext): Visualizer;\r\n}\r\n\r\nconst SUPPORTED_VISUALIZERS: Record<\r\n  LayerKind,\r\n  Record<EntityGeometry, VisualizerConstructor | null>\r\n> = {\r\n  [LayerKind.STATIC_COLOR]: {\r\n    [EntityGeometry.POINT]: StaticPointVisualizer,\r\n    [EntityGeometry.LINE]: StaticLineVisualizer,\r\n    [EntityGeometry.POLYGON]: StaticPolygonVisualizer\r\n  },\r\n  [LayerKind.HEAT_MAP]: {\r\n    [EntityGeometry.POINT]: StaticPointVisualizer,\r\n    [EntityGeometry.LINE]: null,\r\n    [EntityGeometry.POLYGON]: null\r\n  },\r\n  [LayerKind.ACTIVE_ENTITY]: {\r\n    [EntityGeometry.POINT]: ActivePointVisualizer,\r\n    [EntityGeometry.LINE]: null,\r\n    [EntityGeometry.POLYGON]: null\r\n  },\r\n  [LayerKind.COLOR_MAP]: {\r\n    [EntityGeometry.POINT]: TapefilePointVisualizer,\r\n    [EntityGeometry.LINE]: TapefileLineVisualizer,\r\n    [EntityGeometry.POLYGON]: TapefilePolygonVisualizer\r\n  },\r\n  [LayerKind.UNKNOWN]: {\r\n    [EntityGeometry.POINT]: null,\r\n    [EntityGeometry.LINE]: null,\r\n    [EntityGeometry.POLYGON]: null\r\n  }\r\n};\r\n\r\nexport function getVisualizer(config: VisualizerContext): Visualizer {\r\n  const visClass = getVisualizerType(config.info);\r\n  if (!visClass) {\r\n    throw new Error(`Cannot visualize ${config.info.id}`);\r\n  }\r\n\r\n  return new visClass(config);\r\n}\r\n\r\nexport function getVisualizerType(info: AnyVisualizerInfo): Nullable<VisualizerConstructor> {\r\n  return info instanceof ComposableVisualizerInfo\r\n    ? getComposableVisualizerType(info)\r\n    : getLegacyVisualizerType(info);\r\n}\r\n\r\nexport function getLegacyVisualizerType(info: VisualizerInfo): Nullable<VisualizerConstructor> {\r\n  return info.geometry ? SUPPORTED_VISUALIZERS[info.settings.kind][info.geometry] : null;\r\n}\r\nexport function getComposableVisualizerType(\r\n  info: ComposableVisualizerInfo\r\n): Nullable<VisualizerConstructor> {\r\n  switch (info.settings?.type) {\r\n    case FlowVisualizerType.POINTS:\r\n      return ComposablePointVisualizer;\r\n    case FlowVisualizerType.LINES:\r\n      return ComposableLineVisualizer;\r\n    case FlowVisualizerType.POLYGONS:\r\n      return ComposablePolygonVisualizer;\r\n    case FlowVisualizerType.ARCS:\r\n      return ComposableArcVisualizer;\r\n    default:\r\n      return null;\r\n  }\r\n}\r\nexport { VisualizerInfo } from '@/visualizers/VisualizerInfo';\r\n\r\nexport interface VisGroup {\r\n  name: string;\r\n  layerInfos: AnyVisualizerInfo[];\r\n}\r\n","import { Nullable } from '@/types';\r\nimport { getVisualizerType, VisualizerConstructor } from '@/visualizers';\r\nimport { AnyVisualizerInfo } from '@/visualizers/VisualizerInfo';\r\n\r\nexport function determineChanges(\r\n  newLayers: AnyVisualizerInfo[],\r\n  oldLayers: AnyVisualizerInfo[]\r\n): [AnyVisualizerInfo[], AnyVisualizerInfo[]] {\r\n  const [toCreate, toDiscard, toKeep] = determineChangedIDs(newLayers, oldLayers);\r\n  const [moreToCreate, moreToDiscard] = determineChangedVisualizers(toKeep, oldLayers);\r\n\r\n  return [\r\n    [...toCreate, ...moreToCreate],\r\n    [...toDiscard, ...moreToDiscard]\r\n  ];\r\n}\r\n\r\nfunction determineChangedIDs(\r\n  newLayers: AnyVisualizerInfo[],\r\n  oldLayers: AnyVisualizerInfo[]\r\n): [AnyVisualizerInfo[], AnyVisualizerInfo[], AnyVisualizerInfo[]] {\r\n  const oldIds = new Set(oldLayers.map(l => l.id));\r\n  const newIds = new Set(newLayers.map(l => l.id));\r\n  const toCreate = newLayers.filter(l => !oldIds.has(l.id));\r\n  const toDiscard = oldLayers.filter(l => !newIds.has(l.id));\r\n  const toKeep = newLayers.filter(l => oldIds.has(l.id));\r\n  return [toCreate, toDiscard, toKeep];\r\n}\r\n\r\nfunction determineChangedVisualizers(\r\n  newLayers: AnyVisualizerInfo[],\r\n  oldLayers: AnyVisualizerInfo[]\r\n): [AnyVisualizerInfo[], AnyVisualizerInfo[], AnyVisualizerInfo[]] {\r\n  const oldLayerVisualizerTypes = oldLayers.reduce(\r\n    (obj: Record<string, Nullable<VisualizerConstructor>>, l) => {\r\n      obj[l.id] = getVisualizerType(l);\r\n      return obj;\r\n    },\r\n    {}\r\n  );\r\n  const oldLayersByID = oldLayers.reduce((obj: Record<string, AnyVisualizerInfo>, l) => {\r\n    obj[l.id] = l;\r\n    return obj;\r\n  }, {});\r\n  const [toCreate, toDiscard, toKeep]: AnyVisualizerInfo[][] = [[], [], []];\r\n  for (const layer of newLayers) {\r\n    if (getVisualizerType(layer) === oldLayerVisualizerTypes[layer.id]) {\r\n      toKeep.push(layer);\r\n    } else {\r\n      toCreate.push(layer);\r\n      toDiscard.push(oldLayersByID[layer.id]);\r\n    }\r\n  }\r\n  return [toCreate, toDiscard, toKeep];\r\n}\r\n","import { ComponentProperty, Update, UpdateWithData } from '@/types';\r\nimport Backend from '@/api/backend';\r\n\r\nexport interface DatasetStoreConfig {\r\n  backend: Backend;\r\n  datasetUUID: string;\r\n  scenarioUUID?: string;\r\n}\r\n\r\nexport class DatasetDownloader {\r\n  backend: Backend;\r\n  datasetUUID: string;\r\n  scenarioUUID: string | null;\r\n\r\n  constructor(config: DatasetStoreConfig) {\r\n    this.backend = config.backend;\r\n    this.datasetUUID = config.datasetUUID;\r\n    this.scenarioUUID = config.scenarioUUID ?? null;\r\n  }\r\n\r\n  async getInitialData<T>(params: {\r\n    entityGroup: string;\r\n    properties?: ComponentProperty[];\r\n  }): Promise<T> {\r\n    const resp = await this.backend.dataset.getData<T>({\r\n      datasetUUID: this.datasetUUID,\r\n      entityGroup: params.entityGroup,\r\n      properties: params.properties\r\n    });\r\n\r\n    const entityData = resp?.data && resp.data[params.entityGroup];\r\n\r\n    if (!entityData) {\r\n      throw new Error(`${params.entityGroup} not found in dataset ${this.datasetUUID}`);\r\n    }\r\n\r\n    return (entityData as unknown) as T;\r\n  }\r\n\r\n  async getDatasetState<T>(params: {\r\n    entityGroup: string;\r\n    properties?: ComponentProperty[];\r\n    timestamp?: number;\r\n  }): Promise<T> {\r\n    if (!this.scenarioUUID) {\r\n      return await this.getInitialData<T>(params);\r\n    }\r\n\r\n    const resp = await this.backend.dataset.getState({\r\n      datasetUUID: this.datasetUUID,\r\n      scenarioUUID: this.scenarioUUID,\r\n      entityGroup: params.entityGroup,\r\n      properties: params.properties,\r\n      timestamp: params.timestamp\r\n    });\r\n\r\n    const entityData = resp?.data && resp.data[params.entityGroup];\r\n\r\n    if (!entityData) {\r\n      throw new Error(`${params.entityGroup} not found in dataset ${this.datasetUUID}`);\r\n    }\r\n    return (entityData as unknown) as T;\r\n  }\r\n\r\n  async getUpdateList() {\r\n    if (!this.scenarioUUID) {\r\n      return [];\r\n    }\r\n    const allUpdates = await this.backend.updates.list(this.scenarioUUID);\r\n    if (!allUpdates) {\r\n      throw new Error('Error when downloading updates');\r\n    }\r\n    return allUpdates.filter(upd => upd.dataset_uuid === this.datasetUUID);\r\n  }\r\n\r\n  async getUpdateData(\r\n    update: Update,\r\n    entityGroup: string,\r\n    properties: ComponentProperty[]\r\n  ): Promise<UpdateWithData> {\r\n    const data = await this.backend.updates.get(update.uuid, entityGroup, properties);\r\n\r\n    if (!data) {\r\n      throw new Error('Error when downloading updates');\r\n    }\r\n\r\n    return data;\r\n  }\r\n}\r\n","import { getVisualizer, Visualizer, VisualizerInfo } from '@/visualizers/index';\r\nimport isEqual from 'lodash/isEqual';\r\nimport isError from 'lodash/isError';\r\n\r\nimport { determineChanges } from '@/components/map/mapVisHelpers';\r\nimport { DatasetDownloader } from '@//utils/DatasetDownloader';\r\nimport { AnyVisualizerInfo } from '@/visualizers/VisualizerInfo';\r\nimport Backend from '@/api/backend';\r\n\r\ntype VMCallback = (params: CallbackPayload) => void;\r\n\r\ninterface CallbackPayload {\r\n  manager: VisualizerManager;\r\n  info?: AnyVisualizerInfo;\r\n  error?: Error | unknown;\r\n}\r\ntype CallbackEvent = 'success' | 'create' | 'delete' | 'error';\r\n\r\n/**\r\n * The VisualizerManager creates and maintains `Visualizers` for the `MapVis.vue` component\r\n * @param: config:\r\n *   * backend: A `Client` for accessing the Simulation Engine backend\r\n *   * onSuccess: A callback (or array of callbacks) that is/are invoked whenever the Visualizers\r\n *     have been successfully updated to the state required by the given `layerInfos` in\r\n *     `VisualizerManager.updateVisualizers()`\r\n *   * onFailure: A callback (or array of callbacks) that is invoked when an uncaught error is\r\n *     thrown during updating the visualizers. Note: many errors are caught by the process of\r\n *     updating the visualizers, and these errors are instead stored in the `AnyVisualizerInfo.errors`\r\n *     dictionary. In these cases, the `onFailure` callbacks are not invoked\r\n */\r\nexport default class VisualizerManager {\r\n  protected backend: Backend;\r\n  protected visualizers: Record<string, Visualizer>;\r\n  private desiredInfos: AnyVisualizerInfo[];\r\n  private currentInfos: AnyVisualizerInfo[];\r\n  protected callbacks: Record<CallbackEvent, VMCallback[]>;\r\n  private loading: boolean;\r\n\r\n  constructor(config: {\r\n    backend: Backend;\r\n    onSuccess?: VMCallback | VMCallback[];\r\n    onError?: VMCallback | VMCallback[];\r\n    onCreate?: VMCallback | VMCallback[];\r\n    onDelete?: VMCallback | VMCallback[];\r\n  }) {\r\n    this.backend = config.backend;\r\n    this.visualizers = {};\r\n    this.desiredInfos = [];\r\n    this.currentInfos = [];\r\n    this.loading = false;\r\n    this.callbacks = {\r\n      create: [],\r\n      delete: [],\r\n      success: [],\r\n      error: []\r\n    };\r\n    if (config.onSuccess) this.on('success', config.onSuccess);\r\n    if (config.onError) this.on('error', config.onError);\r\n    if (config.onCreate) this.on('create', config.onCreate);\r\n    if (config.onDelete) this.on('delete', config.onDelete);\r\n  }\r\n\r\n  getVisualizers(): Visualizer[] {\r\n    return Object.values(this.visualizers);\r\n  }\r\n\r\n  on(event: CallbackEvent, callbacks: VMCallback | VMCallback[]) {\r\n    callbacks = Array.isArray(callbacks) ? callbacks : [callbacks];\r\n    this.callbacks[event].push(...callbacks);\r\n  }\r\n\r\n  async updateVisualizers(layerInfos: AnyVisualizerInfo[]): Promise<void> {\r\n    this.desiredInfos = layerInfos;\r\n    if (this.loading) {\r\n      return;\r\n    }\r\n    this.loading = true;\r\n\r\n    // Between runs of `this.doUpdateVisualizers`, `this.desiredInfos` may have changed.\r\n    // We use `this.loading` as a lock, so that only one attempt to update the visualizers\r\n    // is run at the same time. Only after we're done, do we check whether we're still current,\r\n    // or need to update again\r\n    while (!isEqual(this.currentInfos, this.desiredInfos)) {\r\n      const thisInfos = this.desiredInfos;\r\n      try {\r\n        await this.doUpdateVisualizers(thisInfos);\r\n      } catch (e) {\r\n        // After we catch an error, we need to check whether we've tried the latest desired\r\n        // state. If the latest desired state has changed, we may try again. We only call the\r\n        // error callbacks once we're done trying\r\n        if (!isEqual(thisInfos, this.desiredInfos)) {\r\n          continue;\r\n        }\r\n        this.finalize(e);\r\n        return;\r\n      }\r\n    }\r\n    this.finalize();\r\n  }\r\n\r\n  private async doUpdateVisualizers(layerInfos: AnyVisualizerInfo[]): Promise<void> {\r\n    const [layersToAdd, layersToRemove] = determineChanges(layerInfos, this.currentInfos);\r\n    this.removeVisualizers(layersToRemove);\r\n    this.createVisualizers(layersToAdd);\r\n    layerInfos.forEach((info, idx) => {\r\n      this.visualizers?.[info.id].setInfo(info);\r\n      this.visualizers?.[info.id].setLayerOrder(idx);\r\n    });\r\n\r\n    await this.reloadVisualizers();\r\n    this.currentInfos = layerInfos;\r\n  }\r\n\r\n  private removeVisualizers(layers: AnyVisualizerInfo[]): void {\r\n    layers.forEach(info => {\r\n      delete this.visualizers[info.id];\r\n      this.invokeCallbacks('delete', { manager: this, info });\r\n    });\r\n  }\r\n\r\n  private createVisualizers(layers: AnyVisualizerInfo[]) {\r\n    layers.forEach(info => {\r\n      info.unsetError('create');\r\n      let visualizer: Visualizer;\r\n      try {\r\n        visualizer = this.createVisualizer(info);\r\n      } catch (e) {\r\n        if (isError(e)) {\r\n          info.setError('create', e.message);\r\n        }\r\n        console.error(e);\r\n        return;\r\n      }\r\n      if (visualizer) {\r\n        this.visualizers[visualizer.baseID] = visualizer;\r\n        this.invokeCallbacks('create', { manager: this, info });\r\n      }\r\n    });\r\n  }\r\n\r\n  private createVisualizer(layerInfo: AnyVisualizerInfo): Visualizer {\r\n    if (layerInfo instanceof VisualizerInfo && !layerInfo.geometry) {\r\n      throw new Error('Layer has no geometry defined');\r\n    }\r\n    if (!layerInfo.datasetUUID) {\r\n      throw new Error(\r\n        `Invalid dataset ${layerInfo.datasetName} for layer ${layerInfo.id}: no UUID`\r\n      );\r\n    }\r\n    const store = new DatasetDownloader({\r\n      backend: this.backend,\r\n      datasetUUID: layerInfo.datasetUUID,\r\n      scenarioUUID: layerInfo.scenarioUUID || undefined\r\n    });\r\n    return getVisualizer({ datasetStore: store, info: layerInfo });\r\n  }\r\n\r\n  private async reloadVisualizers(): Promise<void[]> {\r\n    return await Promise.all(Object.values(this.visualizers).map(viz => viz.load()));\r\n  }\r\n  private finalize(error?: unknown) {\r\n    if (error) {\r\n      this.invokeCallbacks('error', { manager: this, error });\r\n    } else {\r\n      this.invokeCallbacks('success', { manager: this });\r\n    }\r\n    this.loading = false;\r\n  }\r\n\r\n  private invokeCallbacks(event: CallbackEvent, payload: CallbackPayload) {\r\n    for (const callback of this.callbacks[event]) {\r\n      try {\r\n        callback(payload);\r\n      } catch (e) {\r\n        console.error(e);\r\n      }\r\n    }\r\n  }\r\n}\r\n","/**\r\n * Takes the properties on object from parameter source and adds them to the object\r\n * parameter target\r\n * @param {object} target  Object to have properties copied onto from y\r\n * @param {object} source  Object with properties to be copied to x\r\n */\r\nfunction addPropertiesToObject(target, source) {\r\n    var _loop_1 = function (k) {\r\n        Object.defineProperty(target, k, {\r\n            get: function () { return source[k]; }\r\n        });\r\n    };\r\n    for (var _i = 0, _a = Object.keys(source || {}); _i < _a.length; _i++) {\r\n        var k = _a[_i];\r\n        _loop_1(k);\r\n    }\r\n}\r\n/**\r\n * Returns a namespaced name of the module to be used as a store getter\r\n * @param module\r\n */\r\nfunction getModuleName(module) {\r\n    if (!module._vmdModuleName) {\r\n        throw new Error(\"ERR_GET_MODULE_NAME : Could not get module accessor.\\n      Make sure your module has name, we can't make accessors for unnamed modules\\n      i.e. @Module({ name: 'something' })\");\r\n    }\r\n    return \"vuexModuleDecorators/\" + module._vmdModuleName;\r\n}\n\nvar VuexModule = /** @class */ (function () {\r\n    function VuexModule(module) {\r\n        this.actions = module.actions;\r\n        this.mutations = module.mutations;\r\n        this.state = module.state;\r\n        this.getters = module.getters;\r\n        this.namespaced = module.namespaced;\r\n        this.modules = module.modules;\r\n    }\r\n    return VuexModule;\r\n}());\r\nfunction getModule(moduleClass, store) {\r\n    var moduleName = getModuleName(moduleClass);\r\n    if (store && store.getters[moduleName]) {\r\n        return store.getters[moduleName];\r\n    }\r\n    else if (moduleClass._statics) {\r\n        return moduleClass._statics;\r\n    }\r\n    var genStatic = moduleClass._genStatic;\r\n    if (!genStatic) {\r\n        throw new Error(\"ERR_GET_MODULE_NO_STATICS : Could not get module accessor.\\n      Make sure your module has name, we can't make accessors for unnamed modules\\n      i.e. @Module({ name: 'something' })\");\r\n    }\r\n    var storeModule = genStatic(store);\r\n    if (store) {\r\n        store.getters[moduleName] = storeModule;\r\n    }\r\n    else {\r\n        moduleClass._statics = storeModule;\r\n    }\r\n    return storeModule;\r\n}\n\nvar reservedKeys = ['actions', 'getters', 'mutations', 'modules', 'state', 'namespaced', 'commit'];\r\nfunction stateFactory(module) {\r\n    var state = new module.prototype.constructor({});\r\n    var s = {};\r\n    Object.keys(state).forEach(function (key) {\r\n        if (reservedKeys.indexOf(key) !== -1) {\r\n            if (typeof state[key] !== 'undefined') {\r\n                throw new Error(\"ERR_RESERVED_STATE_KEY_USED: You cannot use the following\\n        ['actions', 'getters', 'mutations', 'modules', 'state', 'namespaced', 'commit']\\n        as fields in your module. These are reserved as they have special purpose in Vuex\");\r\n            }\r\n            return;\r\n        }\r\n        if (state.hasOwnProperty(key)) {\r\n            if (typeof state[key] !== 'function') {\r\n                s[key] = state[key];\r\n            }\r\n        }\r\n    });\r\n    return s;\r\n}\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nfunction __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\n\nfunction staticStateGenerator(module, modOpt, statics) {\r\n    var state = modOpt.stateFactory ? module.state() : module.state;\r\n    Object.keys(state).forEach(function (key) {\r\n        if (state.hasOwnProperty(key)) {\r\n            // If not undefined or function means it is a state value\r\n            if (['undefined', 'function'].indexOf(typeof state[key]) === -1) {\r\n                Object.defineProperty(statics, key, {\r\n                    get: function () {\r\n                        var path = modOpt.name.split('/');\r\n                        var data = statics.store.state;\r\n                        for (var _i = 0, path_1 = path; _i < path_1.length; _i++) {\r\n                            var segment = path_1[_i];\r\n                            data = data[segment];\r\n                        }\r\n                        return data[key];\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    });\r\n}\r\nfunction staticGetterGenerator(module, modOpt, statics) {\r\n    Object.keys(module.getters).forEach(function (key) {\r\n        if (module.namespaced) {\r\n            Object.defineProperty(statics, key, {\r\n                get: function () {\r\n                    return statics.store.getters[modOpt.name + \"/\" + key];\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            Object.defineProperty(statics, key, {\r\n                get: function () {\r\n                    return statics.store.getters[key];\r\n                }\r\n            });\r\n        }\r\n    });\r\n}\r\nfunction staticMutationGenerator(module, modOpt, statics) {\r\n    Object.keys(module.mutations).forEach(function (key) {\r\n        if (module.namespaced) {\r\n            statics[key] = function () {\r\n                var _a;\r\n                var args = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    args[_i] = arguments[_i];\r\n                }\r\n                (_a = statics.store).commit.apply(_a, __spreadArrays([modOpt.name + \"/\" + key], args));\r\n            };\r\n        }\r\n        else {\r\n            statics[key] = function () {\r\n                var _a;\r\n                var args = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    args[_i] = arguments[_i];\r\n                }\r\n                (_a = statics.store).commit.apply(_a, __spreadArrays([key], args));\r\n            };\r\n        }\r\n    });\r\n}\r\nfunction staticActionGenerators(module, modOpt, statics) {\r\n    Object.keys(module.actions).forEach(function (key) {\r\n        if (module.namespaced) {\r\n            statics[key] = function () {\r\n                var args = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    args[_i] = arguments[_i];\r\n                }\r\n                return __awaiter(this, void 0, void 0, function () {\r\n                    var _a;\r\n                    return __generator(this, function (_b) {\r\n                        return [2 /*return*/, (_a = statics.store).dispatch.apply(_a, __spreadArrays([modOpt.name + \"/\" + key], args))];\r\n                    });\r\n                });\r\n            };\r\n        }\r\n        else {\r\n            statics[key] = function () {\r\n                var args = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    args[_i] = arguments[_i];\r\n                }\r\n                return __awaiter(this, void 0, void 0, function () {\r\n                    var _a;\r\n                    return __generator(this, function (_b) {\r\n                        return [2 /*return*/, (_a = statics.store).dispatch.apply(_a, __spreadArrays([key], args))];\r\n                    });\r\n                });\r\n            };\r\n        }\r\n    });\r\n}\n\nfunction registerDynamicModule(module, modOpt) {\r\n    if (!modOpt.name) {\r\n        throw new Error('Name of module not provided in decorator options');\r\n    }\r\n    if (!modOpt.store) {\r\n        throw new Error('Store not provided in decorator options when using dynamic option');\r\n    }\r\n    modOpt.store.registerModule(modOpt.name, // TODO: Handle nested modules too in future\r\n    module, { preserveState: modOpt.preserveState || false });\r\n}\r\nfunction addGettersToModule(targetModule, srcModule) {\r\n    Object.getOwnPropertyNames(srcModule.prototype).forEach(function (funcName) {\r\n        var descriptor = Object.getOwnPropertyDescriptor(srcModule.prototype, funcName);\r\n        if (descriptor.get && targetModule.getters) {\r\n            targetModule.getters[funcName] = function (state, getters, rootState, rootGetters) {\r\n                var thisObj = { context: { state: state, getters: getters, rootState: rootState, rootGetters: rootGetters } };\r\n                addPropertiesToObject(thisObj, state);\r\n                addPropertiesToObject(thisObj, getters);\r\n                var got = descriptor.get.call(thisObj);\r\n                return got;\r\n            };\r\n        }\r\n    });\r\n}\r\nfunction moduleDecoratorFactory(moduleOptions) {\r\n    return function (constructor) {\r\n        var module = constructor;\r\n        var stateFactory$1 = function () { return stateFactory(module); };\r\n        if (!module.state) {\r\n            module.state = moduleOptions && moduleOptions.stateFactory ? stateFactory$1 : stateFactory$1();\r\n        }\r\n        if (!module.getters) {\r\n            module.getters = {};\r\n        }\r\n        if (!module.namespaced) {\r\n            module.namespaced = moduleOptions && moduleOptions.namespaced;\r\n        }\r\n        var parentModule = Object.getPrototypeOf(module);\r\n        while (parentModule.name !== 'VuexModule' && parentModule.name !== '') {\r\n            addGettersToModule(module, parentModule);\r\n            parentModule = Object.getPrototypeOf(parentModule);\r\n        }\r\n        addGettersToModule(module, module);\r\n        var modOpt = moduleOptions;\r\n        if (modOpt.name) {\r\n            Object.defineProperty(constructor, '_genStatic', {\r\n                value: function (store) {\r\n                    var statics = { store: store || modOpt.store };\r\n                    if (!statics.store) {\r\n                        throw new Error(\"ERR_STORE_NOT_PROVIDED: To use getModule(), either the module\\n            should be decorated with store in decorator, i.e. @Module({store: store}) or\\n            store should be passed when calling getModule(), i.e. getModule(MyModule, this.$store)\");\r\n                    }\r\n                    // ===========  For statics ==============\r\n                    // ------ state -------\r\n                    staticStateGenerator(module, modOpt, statics);\r\n                    // ------- getters -------\r\n                    if (module.getters) {\r\n                        staticGetterGenerator(module, modOpt, statics);\r\n                    }\r\n                    // -------- mutations --------\r\n                    if (module.mutations) {\r\n                        staticMutationGenerator(module, modOpt, statics);\r\n                    }\r\n                    // -------- actions ---------\r\n                    if (module.actions) {\r\n                        staticActionGenerators(module, modOpt, statics);\r\n                    }\r\n                    return statics;\r\n                }\r\n            });\r\n            Object.defineProperty(constructor, '_vmdModuleName', {\r\n                value: modOpt.name\r\n            });\r\n        }\r\n        if (modOpt.dynamic) {\r\n            registerDynamicModule(module, modOpt);\r\n        }\r\n        return constructor;\r\n    };\r\n}\r\nfunction Module(modOrOpt) {\r\n    if (typeof modOrOpt === 'function') {\r\n        /*\r\n         * @Module decorator called without options (directly on the class definition)\r\n         */\r\n        moduleDecoratorFactory({})(modOrOpt);\r\n    }\r\n    else {\r\n        /*\r\n         * @Module({...}) decorator called with options\r\n         */\r\n        return moduleDecoratorFactory(modOrOpt);\r\n    }\r\n}\n\nvar config = {};\n\nfunction actionDecoratorFactory(params) {\r\n    var _a = params || {}, _b = _a.commit, commit = _b === void 0 ? undefined : _b, _c = _a.rawError, rawError = _c === void 0 ? !!config.rawError : _c, _d = _a.root, root = _d === void 0 ? false : _d;\r\n    return function (target, key, descriptor) {\r\n        var module = target.constructor;\r\n        if (!module.hasOwnProperty('actions')) {\r\n            module.actions = Object.assign({}, module.actions);\r\n        }\r\n        var actionFunction = descriptor.value;\r\n        var action = function (context, payload) {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var actionPayload, moduleName, moduleAccessor, thisObj, e_1;\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            _a.trys.push([0, 5, , 6]);\r\n                            actionPayload = null;\r\n                            if (!module._genStatic) return [3 /*break*/, 2];\r\n                            moduleName = getModuleName(module);\r\n                            moduleAccessor = context.rootGetters[moduleName]\r\n                                ? context.rootGetters[moduleName]\r\n                                : getModule(module);\r\n                            moduleAccessor.context = context;\r\n                            return [4 /*yield*/, actionFunction.call(moduleAccessor, payload)];\r\n                        case 1:\r\n                            actionPayload = _a.sent();\r\n                            return [3 /*break*/, 4];\r\n                        case 2:\r\n                            thisObj = { context: context };\r\n                            addPropertiesToObject(thisObj, context.state);\r\n                            addPropertiesToObject(thisObj, context.getters);\r\n                            return [4 /*yield*/, actionFunction.call(thisObj, payload)];\r\n                        case 3:\r\n                            actionPayload = _a.sent();\r\n                            _a.label = 4;\r\n                        case 4:\r\n                            if (commit) {\r\n                                context.commit(commit, actionPayload);\r\n                            }\r\n                            return [2 /*return*/, actionPayload];\r\n                        case 5:\r\n                            e_1 = _a.sent();\r\n                            throw rawError\r\n                                ? e_1\r\n                                : new Error('ERR_ACTION_ACCESS_UNDEFINED: Are you trying to access ' +\r\n                                    'this.someMutation() or this.someGetter inside an @Action? \\n' +\r\n                                    'That works only in dynamic modules. \\n' +\r\n                                    'If not dynamic use this.context.commit(\"mutationName\", payload) ' +\r\n                                    'and this.context.getters[\"getterName\"]' +\r\n                                    '\\n' +\r\n                                    new Error(\"Could not perform action \" + key.toString()).stack +\r\n                                    '\\n' +\r\n                                    e_1.stack);\r\n                        case 6: return [2 /*return*/];\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        module.actions[key] = root ? { root: root, handler: action } : action;\r\n    };\r\n}\r\n/**\r\n * The @Action decorator turns an async function into an Vuex action\r\n *\r\n * @param targetOrParams the module class\r\n * @param key name of the action\r\n * @param descriptor the action function descriptor\r\n * @constructor\r\n */\r\nfunction Action(targetOrParams, key, descriptor) {\r\n    if (!key && !descriptor) {\r\n        /*\r\n         * This is the case when `targetOrParams` is params.\r\n         * i.e. when used as -\r\n         * <pre>\r\n            @Action({commit: 'incrCount'})\r\n            async getCountDelta() {\r\n              return 5\r\n            }\r\n         * </pre>\r\n         */\r\n        return actionDecoratorFactory(targetOrParams);\r\n    }\r\n    else {\r\n        /*\r\n         * This is the case when @Action is called on action function\r\n         * without any params\r\n         * <pre>\r\n         *   @Action\r\n         *   async doSomething() {\r\n         *    ...\r\n         *   }\r\n         * </pre>\r\n         */\r\n        actionDecoratorFactory()(targetOrParams, key, descriptor);\r\n    }\r\n}\n\nfunction Mutation(target, key, descriptor) {\r\n    var module = target.constructor;\r\n    if (!module.hasOwnProperty('mutations')) {\r\n        module.mutations = Object.assign({}, module.mutations);\r\n    }\r\n    var mutationFunction = descriptor.value;\r\n    var mutation = function (state, payload) {\r\n        mutationFunction.call(state, payload);\r\n    };\r\n    module.mutations[key] = mutation;\r\n}\n\nfunction mutationActionDecoratorFactory(params) {\r\n    return function (target, key, descriptor) {\r\n        var module = target.constructor;\r\n        if (!module.hasOwnProperty('mutations')) {\r\n            module.mutations = Object.assign({}, module.mutations);\r\n        }\r\n        if (!module.hasOwnProperty('actions')) {\r\n            module.actions = Object.assign({}, module.actions);\r\n        }\r\n        var mutactFunction = descriptor.value;\r\n        var action = function (context, payload) {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var actionPayload, e_1;\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            _a.trys.push([0, 2, , 3]);\r\n                            return [4 /*yield*/, mutactFunction.call(context, payload)];\r\n                        case 1:\r\n                            actionPayload = _a.sent();\r\n                            context.commit(key, actionPayload);\r\n                            return [3 /*break*/, 3];\r\n                        case 2:\r\n                            e_1 = _a.sent();\r\n                            if (params.rawError) {\r\n                                throw e_1;\r\n                            }\r\n                            else {\r\n                                console.error('Could not perform action ' + key.toString());\r\n                                console.error(e_1);\r\n                                return [2 /*return*/, Promise.reject(e_1)];\r\n                            }\r\n                        case 3: return [2 /*return*/];\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        var mutation = function (state, payload) {\r\n            if (!params.mutate) {\r\n                params.mutate = Object.keys(payload);\r\n            }\r\n            for (var _i = 0, _a = params.mutate; _i < _a.length; _i++) {\r\n                var stateItem = _a[_i];\r\n                if (state.hasOwnProperty(stateItem) && payload.hasOwnProperty(stateItem)) {\r\n                    state[stateItem] = payload[stateItem];\r\n                }\r\n                else {\r\n                    throw new Error(\"ERR_MUTATE_PARAMS_NOT_IN_PAYLOAD\\n          In @MutationAction, mutate: ['a', 'b', ...] array keys must\\n          match with return type = {a: {}, b: {}, ...} and must\\n          also be in state.\");\r\n                }\r\n            }\r\n        };\r\n        module.actions[key] = params.root ? { root: true, handler: action } : action;\r\n        module.mutations[key] = mutation;\r\n    };\r\n}\r\n/**\r\n * The @MutationAction decorator turns this into an action that further calls a mutation\r\n * Both the action and the mutation are generated for you\r\n *\r\n * @param paramsOrTarget the params or the target class\r\n * @param key the name of the function\r\n * @param descriptor the function body\r\n * @constructor\r\n */\r\nfunction MutationAction(paramsOrTarget, key, descriptor) {\r\n    if (!key && !descriptor) {\r\n        /*\r\n         * This is the case when `paramsOrTarget` is params.\r\n         * i.e. when used as -\r\n         * <pre>\r\n            @MutationAction({mutate: ['incrCount']})\r\n            async getCountDelta() {\r\n              return {incrCount: 5}\r\n            }\r\n         * </pre>\r\n         */\r\n        return mutationActionDecoratorFactory(paramsOrTarget);\r\n    }\r\n    else {\r\n        /*\r\n         * This is the case when `paramsOrTarget` is target.\r\n         * i.e. when used as -\r\n         * <pre>\r\n            @MutationAction\r\n            async getCountDelta() {\r\n              return {incrCount: 5}\r\n            }\r\n         * </pre>\r\n         */\r\n        mutationActionDecoratorFactory({})(paramsOrTarget, key, descriptor);\r\n    }\r\n}\n\nexport { Action, Module, Mutation, MutationAction, VuexModule, config, getModule };\n//# sourceMappingURL=index.js.map\n","import { ComponentData, EntityGroupData } from '@/types';\r\n\r\nexport function entityGroupToCSV(entityGroup: EntityGroupData<unknown>): string {\r\n  return new CSVBuilder(entityGroup).buildCSV();\r\n}\r\n\r\nexport function objectToCSV(obj: Record<string, unknown>): string {\r\n  let rv = '';\r\n  for (const [key, val] of Object.entries(obj)) {\r\n    rv += `${key},${anyToString(val)}\\n`;\r\n  }\r\n  return rv;\r\n}\r\n\r\nfunction anyToString(item: unknown): string {\r\n  if (item === null) {\r\n    return 'null';\r\n  }\r\n  if (item instanceof Object) {\r\n    return '\"' + JSON.stringify(item) + '\"';\r\n  }\r\n  if (typeof item === 'string') {\r\n    return '\"' + item + '\"';\r\n  }\r\n  return String(item);\r\n}\r\nclass CSVBuilder {\r\n  data: [string, unknown[]][];\r\n  size: number;\r\n\r\n  constructor(entityGroup: EntityGroupData<unknown>) {\r\n    this.data = flatten(entityGroup);\r\n    this.size = entityGroup.id.length;\r\n  }\r\n  buildCSV(): string {\r\n    let rv = '';\r\n    rv = this.writeHeader(rv);\r\n    for (let i = 0; i < this.size; i++) {\r\n      rv = this.writeRow(i, rv);\r\n    }\r\n    return rv;\r\n  }\r\n\r\n  private writeHeader(output: string) {\r\n    return output + this.rowToString(this.data.map(d => d[0]));\r\n  }\r\n  private writeRow(idx: number, output: string) {\r\n    return output + this.rowToString(this.getRow(idx));\r\n  }\r\n\r\n  private getRow(idx: number): unknown[] {\r\n    return this.data.map(d => {\r\n      return d[1][idx];\r\n    });\r\n  }\r\n\r\n  private rowToString(items: unknown[]): string {\r\n    return items.map(i => anyToString(i)).join(',') + '\\n';\r\n  }\r\n}\r\n\r\nfunction flatten(\r\n  entityGroup: EntityGroupData<unknown> | ComponentData<unknown>,\r\n  prefix = ''\r\n): [string, unknown[]][] {\r\n  const rv: [string, unknown[]][] = [];\r\n\r\n  if (Array.isArray(entityGroup['id'])) {\r\n    rv.push(['id', entityGroup['id']]);\r\n  }\r\n  if (Array.isArray(entityGroup['reference'])) {\r\n    rv.push(['reference', entityGroup['reference']]);\r\n  }\r\n\r\n  for (const [key, item] of Object.entries(entityGroup)) {\r\n    if (key === 'id' || key == 'reference') {\r\n      continue;\r\n    }\r\n    if (Array.isArray(item)) {\r\n      rv.push([prefix + key, item]);\r\n    } else {\r\n      rv.push(...flatten(item, key + '/'));\r\n    }\r\n  }\r\n  return rv;\r\n}\r\n","// import JSZip from 'jszip';\r\nimport { EntityGroupData, ExportConfig, TimeOrientedSimulationInfo } from '@/types';\r\nimport Backend from '@/api/backend';\r\nimport { entityGroupToCSV, objectToCSV } from '@//utils/csvUtils';\r\nimport { DatasetDownloader } from '@//utils/DatasetDownloader';\r\n\r\nexport function downloadAsFile(data: Blob, filename: string) {\r\n  const url = window.URL.createObjectURL(data);\r\n\r\n  const link = document.createElement('a');\r\n  link.href = url;\r\n  link.setAttribute('download', filename);\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  link.remove();\r\n}\r\n\r\nexport async function exportFromConfig({\r\n  timelineInfo,\r\n  backend,\r\n  config\r\n}: {\r\n  timelineInfo: TimeOrientedSimulationInfo;\r\n  backend: Backend;\r\n  config: ExportConfig;\r\n}): Promise<void> {\r\n  const exportModule = new DataExporter(timelineInfo, backend);\r\n  const res = await exportModule.config2blob(config);\r\n  return downloadAsFile(res.blob, res.filename);\r\n}\r\nexport default class DataExporter {\r\n  timelineInfo!: TimeOrientedSimulationInfo | null;\r\n  backend!: Backend;\r\n\r\n  constructor(timelineInfo: TimeOrientedSimulationInfo | null, backend: Backend) {\r\n    this.timelineInfo = timelineInfo;\r\n    this.backend = backend;\r\n  }\r\n\r\n  // download zip file with all csv\r\n  // configs2zip(configs: ExportConfig[]): Promise<Blob> {\r\n  //   const zip = new JSZip();\r\n\r\n  //   return Promise.all(\r\n  //     configs.map(async (config: ExportConfig) => {\r\n  //       const header = await this.generalDataHeader(config),\r\n  //         data = await this.exportData(config);\r\n  //       zip.file(this.fileName(config), new Blob([header, data]));\r\n  //     })\r\n  //   ).then(() => zip.generateAsync({ type: 'blob' }));\r\n  // }\r\n\r\n  // directly download .csv file\r\n  async config2blob(config: ExportConfig): Promise<{ blob: Blob; filename: string }> {\r\n    const header = await this.generalDataHeader(config),\r\n      data = await this.exportData(config);\r\n\r\n    return {\r\n      blob: new Blob([header, data], { type: 'text/csv' }),\r\n      filename: this.fileName(config)\r\n    };\r\n  }\r\n\r\n  generalDataHeader(config: ExportConfig): string {\r\n    const { projectName, dataset, scenario, timestamp = 0 } = config,\r\n      unixTime_ = this.unixTime(timestamp) ?? 0,\r\n      obj: Record<string, unknown> = {\r\n        project: projectName,\r\n        dataset: dataset?.display_name ?? dataset?.name ?? '-',\r\n        scenario: scenario?.display_name ?? scenario?.name ?? '-',\r\n        timestamp: this.currentFormattedTime(unixTime_)\r\n      };\r\n\r\n    return objectToCSV(obj);\r\n  }\r\n\r\n  async exportData(config: ExportConfig) {\r\n    const { dataset, scenario, entityName, timestamp } = config,\r\n      store = new DatasetDownloader({\r\n        backend: this.backend,\r\n        datasetUUID: dataset?.uuid ?? 'unknown',\r\n        scenarioUUID: scenario?.uuid || undefined\r\n      }),\r\n      data = await store.getDatasetState<EntityGroupData<unknown>>({\r\n        entityGroup: entityName,\r\n        timestamp\r\n      });\r\n\r\n    return entityGroupToCSV(data);\r\n  }\r\n\r\n  fileName(config: ExportConfig): string {\r\n    const { dataset, entityName, timestamp } = config;\r\n\r\n    let rv = dataset?.display_name ?? dataset?.name ?? 'unknown_dataset';\r\n    if (entityName) {\r\n      rv += '-' + entityName;\r\n    }\r\n    if (timestamp) {\r\n      rv += '-' + this.fileNameTime(timestamp);\r\n    }\r\n    return rv + '.csv';\r\n  }\r\n\r\n  fileNameTime(timestamp: number): string {\r\n    const leadingZero = (val: number): string => ('0' + val).slice(-2);\r\n    if (!this.unixTime) return '-';\r\n    const date = new Date(this.unixTime(timestamp) ?? 0);\r\n\r\n    return [\r\n      date.getFullYear(),\r\n      leadingZero(date.getMonth() + 1),\r\n      leadingZero(date.getDate()),\r\n      '-',\r\n      leadingZero(date.getHours()),\r\n      leadingZero(date.getMinutes()),\r\n      leadingZero(date.getSeconds())\r\n    ].join('');\r\n  }\r\n\r\n  unixTime(timestamp: number): number | null {\r\n    return this.timelineInfo\r\n      ? (timestamp * this.timelineInfo.time_scale + this.timelineInfo.reference_time) * 1000\r\n      : null;\r\n  }\r\n\r\n  currentFormattedTime(unixTime: number): string {\r\n    return unixTime ? new Date(unixTime).toLocaleString('NL-nl') : '-';\r\n  }\r\n}\r\n","import { Action, Module, Mutation, VuexModule } from 'vuex-module-decorators';\r\nimport {\r\n  Dataset,\r\n  DatasetSummary,\r\n  FlowStoreConfig,\r\n  Project,\r\n  Scenario,\r\n  ShortScenario,\r\n  SimulationMode,\r\n  TimeOrientedSimulationInfo,\r\n  UUID,\r\n  User,\r\n  View\r\n} from '@/types';\r\nimport { ComposableVisualizerInfo } from '@/visualizers/VisualizerInfo';\r\nimport { exportFromConfig } from '@/utils/DataExporter';\r\nimport Backend from '@/api/backend';\r\nimport FlowUIStore from '@/store/FlowUserInterfaceStore';\r\n\r\n@Module({\r\n  name: 'flow',\r\n  namespaced: true\r\n})\r\nclass FlowStore extends VuexModule {\r\n  visualizers: ComposableVisualizerInfo[] = [];\r\n  view: View | null = null;\r\n  views: View[] = [];\r\n  project: Project | null = null;\r\n  projects: Project[] = [];\r\n  scenarios: ShortScenario[] = [];\r\n  scenario: Scenario | null = null;\r\n  timestamp = 0;\r\n  currentUser: User | null = null;\r\n  datasetSummaries: Record<UUID, DatasetSummary> = {};\r\n  scenarioSummaries: Record<UUID, Record<UUID, DatasetSummary>> = {};\r\n  // injected resources\r\n  backend_: Backend | null = null;\r\n  flowUIStore_: FlowUIStore | null = null;\r\n\r\n  get hasProject(): boolean {\r\n    return !!this.project;\r\n  }\r\n\r\n  get hasScenario(): boolean {\r\n    return !!this.scenario;\r\n  }\r\n\r\n  // TODO: try to use router link options to do this\r\n  get queryString() {\r\n    const params: Record<string, string | undefined> = {\r\n      project: this.project?.name,\r\n      scenario: this.scenario?.name\r\n    };\r\n\r\n    return Object.keys(params)\r\n      .filter((key: string) => params[key])\r\n      .map((key: string) => key + '=' + params[key])\r\n      .join('&');\r\n  }\r\n\r\n  get timelineInfo(): TimeOrientedSimulationInfo | null {\r\n    if (this.scenario?.simulation_info.mode === SimulationMode.TIME_ORIENTED) {\r\n      return this.scenario.simulation_info;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  get backend() {\r\n    return this.backend_;\r\n  }\r\n\r\n  get capabilities() {\r\n    return this.backend?.getCapabilities();\r\n  }\r\n\r\n  get hasGeocodeCapabilities() {\r\n    return this.capabilities?.indexOf('geocode') != -1;\r\n  }\r\n\r\n  get hasUserCapabilities() {\r\n    return this.capabilities?.indexOf('user') != -1;\r\n  }\r\n\r\n  @Mutation\r\n  UPDATE_VISUALIZERS(visualizers: ComposableVisualizerInfo[]) {\r\n    this.visualizers = visualizers;\r\n  }\r\n\r\n  @Mutation\r\n  SET_PROJECTS(projects: Project[]) {\r\n    this.projects = projects;\r\n  }\r\n\r\n  @Mutation\r\n  SET_CURRENT_PROJECT(project: Project | null) {\r\n    this.project = project;\r\n  }\r\n\r\n  @Mutation\r\n  SET_CURRENT_SCENARIO(scenario: Scenario | null) {\r\n    this.scenario = scenario;\r\n  }\r\n\r\n  @Mutation\r\n  SET_SCENARIOS(scenarios: ShortScenario[]) {\r\n    this.scenarios = scenarios;\r\n  }\r\n\r\n  @Mutation\r\n  UPDATE_VIEW(view: View | null) {\r\n    this.view = view;\r\n  }\r\n\r\n  @Mutation\r\n  SET_VIEWS(views: View[]) {\r\n    this.views = views;\r\n  }\r\n\r\n  @Mutation\r\n  SET_TIMESTAMP(timestamp: number) {\r\n    this.timestamp = timestamp;\r\n  }\r\n\r\n  @Mutation\r\n  SET_USER(user: User) {\r\n    this.currentUser = user;\r\n  }\r\n\r\n  @Mutation\r\n  SET_BACKEND(backend: Backend) {\r\n    this.backend_ = backend;\r\n  }\r\n\r\n  @Mutation\r\n  SET_UI_STORE(store: FlowUIStore) {\r\n    this.flowUIStore_ = store;\r\n  }\r\n\r\n  @Mutation\r\n  ADD_DATASET_SUMMARY(payload: {\r\n    datasetUUID: UUID;\r\n    scenarioUUID?: UUID | null;\r\n    summary: DatasetSummary;\r\n  }) {\r\n    if (payload.scenarioUUID) {\r\n      this.scenarioSummaries[payload.scenarioUUID] ??= {};\r\n      this.scenarioSummaries[payload.scenarioUUID][payload.datasetUUID] = payload.summary;\r\n    } else {\r\n      this.datasetSummaries[payload.datasetUUID] = payload.summary;\r\n    }\r\n  }\r\n\r\n  @Mutation\r\n  CLEAR_SUMMARIES() {\r\n    this.datasetSummaries = {};\r\n    this.scenarioSummaries = {};\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  updateCurrentView(view: View | null) {\r\n    this.UPDATE_VIEW(view);\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  updateVisualizers(visualizers: ComposableVisualizerInfo[]) {\r\n    this.UPDATE_VISUALIZERS(visualizers);\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async getProjects() {\r\n    this.SET_PROJECTS((await this.backend?.project.list()) ?? []);\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async setCurrentFlowProject(project: Project) {\r\n    this.flowUIStore_?.enableSection({\r\n      datasets: true,\r\n      scenario: true\r\n    });\r\n\r\n    this.SET_CURRENT_PROJECT(project);\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  setApiClient(backend: Backend) {\r\n    this.SET_BACKEND(backend);\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  setUIStore(flowUIStore_: FlowUIStore) {\r\n    this.SET_UI_STORE(flowUIStore_);\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async setCurrentFlowScenario(scenario: Scenario) {\r\n    this.SET_CURRENT_SCENARIO(scenario);\r\n\r\n    this.flowUIStore_?.enableSection({ visualization: !!scenario, export: !!scenario });\r\n\r\n    await this.getViewsByScenario(scenario.uuid);\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async getDatasets(projectUUID: UUID): Promise<Dataset[] | null> {\r\n    const activeProjectUUID = this.project?.uuid || projectUUID,\r\n      datasets = activeProjectUUID\r\n        ? (await this.backend?.dataset.list(activeProjectUUID)) ?? []\r\n        : [];\r\n\r\n    return datasets;\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async getScenariosByProject(projectUUID?: UUID) {\r\n    const activeProjectUUID = projectUUID ?? this.project?.uuid,\r\n      scenarios: ShortScenario[] = activeProjectUUID\r\n        ? (await this.backend?.scenario.list(activeProjectUUID)) ?? []\r\n        : [];\r\n\r\n    this.SET_SCENARIOS(scenarios);\r\n    return scenarios;\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async getViewsByScenario(scenarioUUID?: string): Promise<View[]> {\r\n    const currentScenarioUUID = scenarioUUID ?? this.scenario?.uuid;\r\n    if (currentScenarioUUID) {\r\n      const views = (await this.backend?.view.list(currentScenarioUUID)) ?? [];\r\n      this.SET_VIEWS(views);\r\n      return views;\r\n    }\r\n\r\n    return [];\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async getScenario(activeScenarioUUID: UUID) {\r\n    if (activeScenarioUUID) {\r\n      return await this.backend?.scenario.get(activeScenarioUUID);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  setTimestamp(value: number) {\r\n    this.SET_TIMESTAMP(value);\r\n  }\r\n\r\n  /**\r\n   * Get a Dataset Summary by `params.datasetUUUID`. When omitting `params.scenarioUUID` the summary\r\n   * will be either  for the init data or, if the `FlowStore` has a `currentScenarioUUID` defined,\r\n   * for dataset in that scenario. Supplying a `params.scenarioUUID` will request the summary for\r\n   * that scenario. If a `null` value is supplied for `params.scenarioUUID`, the summary is\r\n   * requested for the init data, regardless of whether the `SummaryStore` is configured with a\r\n   * `currentScenarioUUID`\r\n   * @param params\r\n   *   datasetUUID: the dataset UUID of the requested summary\r\n   *   scenarioUUID: Optional scenario UUID to specify what (if any) scenario to request the\r\n   *     dataset summary for. Omit this parameter to automatically determine the scenario (if any)\r\n   */\r\n  @Action({ rawError: true })\r\n  async getDatasetSummary(params: {\r\n    datasetUUID: string;\r\n    scenarioUUID?: string | null;\r\n  }): Promise<DatasetSummary | null> {\r\n    const { datasetUUID } = params;\r\n    let { scenarioUUID } = params;\r\n\r\n    scenarioUUID ??= this.scenario?.uuid;\r\n\r\n    let summary: DatasetSummary | null;\r\n    summary = scenarioUUID\r\n      ? this.scenarioSummaries[scenarioUUID]?.[datasetUUID]\r\n      : this.datasetSummaries[datasetUUID];\r\n\r\n    if (!summary) {\r\n      summary =\r\n        (scenarioUUID\r\n          ? await this.backend?.summary.getScenario(scenarioUUID, datasetUUID)\r\n          : await this.backend?.summary.getDataset(datasetUUID)) ?? null;\r\n\r\n      if (summary) {\r\n        this.ADD_DATASET_SUMMARY({\r\n          datasetUUID,\r\n          scenarioUUID,\r\n          summary\r\n        });\r\n      }\r\n    }\r\n\r\n    return summary;\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  clearSummaries() {\r\n    this.CLEAR_SUMMARIES();\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async exportFromConfig(payload: {\r\n    datasetName: string;\r\n    entityGroup: string;\r\n    timestamp?: number;\r\n  }) {\r\n    this.flowUIStore_?.setLoading({ value: true, msg: 'Exporting data...' });\r\n\r\n    const datasets = (await this.getDatasets(this.project?.uuid ?? '<unknown project>'))?.reduce<\r\n      Record<string, Dataset>\r\n    >((obj, curr) => {\r\n      obj[curr.name] = curr;\r\n      return obj;\r\n    }, {});\r\n\r\n    if (datasets && this.project && this.scenario && this.timelineInfo && this.backend) {\r\n      await exportFromConfig({\r\n        config: {\r\n          dataset: datasets[payload.datasetName] ?? null,\r\n          projectName: this.project?.display_name,\r\n          scenario: this.scenario,\r\n          entityName: payload.entityGroup,\r\n          timestamp: payload.timestamp ?? this.timestamp\r\n        },\r\n        timelineInfo: this.timelineInfo,\r\n        backend: this.backend\r\n      });\r\n    }\r\n\r\n    this.flowUIStore_?.setLoading({ value: false });\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async resetFlowStore() {\r\n    this.SET_PROJECTS([]);\r\n    this.SET_CURRENT_PROJECT(null);\r\n    this.SET_SCENARIOS([]);\r\n    this.SET_CURRENT_SCENARIO(null);\r\n    this.SET_TIMESTAMP(0);\r\n    this.UPDATE_VISUALIZERS([]);\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async createView({ scenarioUUID, view }: { scenarioUUID: UUID; view: View }) {\r\n    return await this.backend?.view.create(scenarioUUID, view);\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async getViews(scenarioUUID: UUID) {\r\n    return await this.backend?.view.list(scenarioUUID);\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async getView(viewUUID: UUID) {\r\n    return await this.backend?.view.get(viewUUID);\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async updateView({ viewUUID, view }: { viewUUID: UUID; view: View }) {\r\n    return await this.backend?.view.update(viewUUID, view);\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async deleteView(viewUUID: UUID) {\r\n    return await this.backend?.view.delete(viewUUID);\r\n  }\r\n\r\n  /**\r\n   * This function sets up the start of the flow, depending on the configuration.\r\n   * The user can start the flow on different sections, each has a different config that is validated here.\r\n   * If config is valid, we query the resources and set them up in the store so they're accessible in the component\r\n   *\r\n   * @param config\r\n   */\r\n  @Action({ rawError: true })\r\n  async setupFlowStore({ config, reset = true }: { config: FlowStoreConfig; reset?: boolean }) {\r\n    if (reset) {\r\n      this.resetFlowStore();\r\n      this.clearSummaries();\r\n    }\r\n\r\n    if (!this.currentUser) {\r\n      const user = await this.backend?.user.get();\r\n\r\n      if (user) {\r\n        this.SET_USER(user);\r\n      }\r\n    }\r\n\r\n    if (!this.projects || !this.projects.length) {\r\n      await this.getProjects();\r\n    }\r\n\r\n    const {\r\n      currentProjectName,\r\n      currentScenarioName,\r\n      getProject = false,\r\n      getScenario = false,\r\n      disableCollapser = false\r\n    } = config;\r\n\r\n    // needs a project but doesn't provide project name\r\n    if (getProject && !currentProjectName) {\r\n      throw new Error('Project name not provided');\r\n    }\r\n\r\n    // project is not set and provides a project name\r\n    if (!this.project && currentProjectName) {\r\n      const currentProject = this.projects.find((p: Project) => p.name === currentProjectName);\r\n\r\n      if (currentProject?.uuid) {\r\n        await this.setCurrentFlowProject(currentProject);\r\n      } else {\r\n        // project name is invalid\r\n        this.resetFlowStore();\r\n\r\n        throw new Error('Invalid project');\r\n      }\r\n    }\r\n\r\n    // has a project (either previously set on the store, or by last if and needs the scenario)\r\n    // needs a scenario and provided a scenario name\r\n    if (this.project && getScenario) {\r\n      const scenarios = (await this.getScenariosByProject(this.project.uuid)) || [];\r\n\r\n      if (currentScenarioName) {\r\n        const shortScenario = scenarios.find(p => p.name === currentScenarioName);\r\n\r\n        if (shortScenario) {\r\n          const scenario = await this.getScenario(shortScenario.uuid);\r\n\r\n          // full scenario not found\r\n          if (scenario) {\r\n            await this.setCurrentFlowScenario(scenario);\r\n          } else {\r\n            this.resetFlowStore();\r\n\r\n            throw new Error('Invalid full scenario');\r\n          }\r\n        } else {\r\n          // scenario name is invalid\r\n          this.resetFlowStore();\r\n\r\n          throw new Error('Invalid short Scenario');\r\n        }\r\n      }\r\n    }\r\n\r\n    this.flowUIStore_?.enableSection({\r\n      datasets: this.hasProject,\r\n      scenario: this.hasProject,\r\n      visualization: this.hasScenario,\r\n      export: this.hasScenario\r\n    });\r\n\r\n    this.flowUIStore_?.setDisableCollapser(disableCollapser);\r\n  }\r\n}\r\n\r\nexport default FlowStore;\r\n","import { FlowSection, FlowSectionItem } from '@/types';\r\nimport { Action, Module, Mutation, VuexModule } from 'vuex-module-decorators';\r\n\r\n@Module({\r\n  name: 'flowUI',\r\n  namespaced: true\r\n})\r\nclass FlowUIStore extends VuexModule {\r\n  flowSections: FlowSection[] = [];\r\n  collapse = false;\r\n  disableCollapser = false;\r\n  loading = false;\r\n  loadingMessage: string | null = null;\r\n  lang = 'en';\r\n\r\n  @Mutation\r\n  SET_SECTIONS(payload: FlowSection[]) {\r\n    this.flowSections = payload;\r\n  }\r\n\r\n  @Mutation\r\n  SET_LANG(lang: string) {\r\n    this.lang = lang;\r\n  }\r\n\r\n  @Mutation\r\n  toggleCollapse(force?: boolean) {\r\n    this.collapse = force ?? !this.collapse;\r\n  }\r\n\r\n  @Mutation\r\n  setDisableCollapser(value: boolean) {\r\n    this.disableCollapser = value;\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  setLanguage(lang: string) {\r\n    this.SET_LANG(lang);\r\n  }\r\n\r\n  @Mutation\r\n  setLoading({ value, msg }: { value: boolean; msg?: string | null }) {\r\n    this.loading = value;\r\n    this.loadingMessage = value ? msg ?? null : null;\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  setSections(payload: FlowSection[]) {\r\n    this.SET_SECTIONS(payload);\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  enableSection(payload: Partial<Record<FlowSectionItem, boolean>>) {\r\n    const affectedSections = Object.keys(payload);\r\n    this.SET_SECTIONS(\r\n      this.flowSections.map((section, idx) => {\r\n        return Object.assign({}, this.flowSections[idx], {\r\n          enabled:\r\n            affectedSections.indexOf(section.name) !== -1 ? payload[section.name] : section.enabled\r\n        });\r\n      })\r\n    );\r\n  }\r\n}\r\n\r\nexport default FlowUIStore;\r\n","import { GeocodeSearchQuery, GeocodeSearchResult, GeocodeSuggestion } from '@/types';\r\nimport { Action, Module, Mutation, VuexModule } from 'vuex-module-decorators';\r\nimport { transform, reverseTransform } from '@/crs';\r\nimport Backend from '../api/backend';\r\n\r\nfunction transformResult(result: GeocodeSearchResult): GeocodeSearchResult {\r\n  return Object.assign({}, result, {\r\n    location: transform(result.location),\r\n    bounding_box: [\r\n      ...transform([result.bounding_box[0], result.bounding_box[1]]),\r\n      ...transform([result.bounding_box[2], result.bounding_box[3]])\r\n    ]\r\n  });\r\n}\r\n\r\nfunction prepareQuery(query: GeocodeSearchQuery, epsg_code: number) {\r\n  query = { ...query };\r\n  if (query.nearby_location) {\r\n    query.nearby_location = reverseTransform(query.nearby_location);\r\n  }\r\n  if (query.bounding_box) {\r\n    query.bounding_box = [\r\n      ...reverseTransform([query.bounding_box[0], query.bounding_box[1]]),\r\n      ...reverseTransform([query.bounding_box[2], query.bounding_box[3]])\r\n    ];\r\n  }\r\n  query.epsg_code = epsg_code;\r\n  return query;\r\n}\r\n\r\n@Module({\r\n  name: 'geocode',\r\n  namespaced: true\r\n})\r\nclass GeocodeStore extends VuexModule {\r\n  suggestions: GeocodeSuggestion[] = [];\r\n  upstreamEPSG = 28992;\r\n  backend_: Backend | null = null;\r\n\r\n  get backend() {\r\n    return this.backend_;\r\n  }\r\n\r\n  @Mutation\r\n  setSuggestions(suggestions: GeocodeSuggestion[]) {\r\n    this.suggestions = suggestions;\r\n  }\r\n\r\n  @Mutation\r\n  SET_BACKEND(backend: Backend) {\r\n    this.backend_ = backend;\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async updateSuggestions(query: GeocodeSearchQuery) {\r\n    if (!query) {\r\n      this.setSuggestions([]);\r\n      return;\r\n    }\r\n\r\n    this.setSuggestions(\r\n      (await this.backend?.geocode.getSuggestions(prepareQuery(query, this.upstreamEPSG))) || []\r\n    );\r\n  }\r\n\r\n  // add to client interface\r\n  @Action({ rawError: true })\r\n  async resolveSuggestion(suggestion: GeocodeSuggestion): Promise<GeocodeSearchResult | null> {\r\n    const result = await this.backend?.geocode.resolveSuggestion(suggestion);\r\n    return (result && transformResult(result)) || null;\r\n  }\r\n\r\n  @Action({ rawError: true })\r\n  async getFirstResult(query: GeocodeSearchQuery): Promise<GeocodeSearchResult | null> {\r\n    const result =\r\n      (await this.backend?.geocode.getResults(prepareQuery(query, this.upstreamEPSG))) ?? [];\r\n    return (result.length && transformResult(result[0])) || null;\r\n  }\r\n}\r\n\r\nexport default GeocodeStore;\r\n","import { Store } from 'vuex';\r\nimport { getModule } from 'vuex-module-decorators';\r\nimport FlowStore from '@/store/FlowStore';\r\nimport FlowUIStore from '@/store/FlowUserInterfaceStore';\r\nimport GeocodeStore from '@/store/GeocodeStore';\r\nimport Backend from '@/api/backend';\r\n\r\nlet flowStore: FlowStore, flowUIStore: FlowUIStore, geocodeStore: GeocodeStore;\r\n\r\nfunction initFlowStores(store: Store<unknown>): void {\r\n  flowStore = getModule(FlowStore, store);\r\n  flowUIStore = getModule(FlowUIStore, store);\r\n  geocodeStore = getModule(GeocodeStore, store);\r\n}\r\n\r\nfunction bindAPI(backend: Backend) {\r\n  flowStore.setApiClient(backend);\r\n  flowUIStore.setLanguage('en');\r\n}\r\n\r\nexport { bindAPI, initFlowStores, flowStore, flowUIStore, geocodeStore };\r\n","<template>\r\n  <div>\r\n    <Deck :value=\"viewState\" @input=\"updateViewState($event)\" :layers=\"layers\" :basemap=\"basemap\">\r\n      <template v-if=\"buildings\" #map=\"{ map }\">\r\n        <Buildings :map=\"map\" />\r\n      </template>\r\n      <template #control-zero=\"{ map, onViewstateChange }\">\r\n        <slot name=\"control-zero\" v-bind=\"{ ...slotProps, map, onViewstateChange }\" />\r\n      </template>\r\n      <template #control-left=\"{ map, onViewstateChange }\">\r\n        <slot name=\"control-left\" v-bind=\"{ ...slotProps, map, onViewstateChange }\" />\r\n      </template>\r\n      <template #control-right=\"{ map, onViewstateChange }\">\r\n        <slot name=\"control-right\" v-bind=\"{ ...slotProps, map, onViewstateChange }\" />\r\n      </template>\r\n      <template #control-bottom=\"{ map, onViewstateChange }\">\r\n        <slot name=\"control-bottom\" v-bind=\"{ ...slotProps, map, onViewstateChange }\" />\r\n      </template>\r\n    </Deck>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\r\nimport { CameraOptions, PopupContent, TimeOrientedSimulationInfo } from '@/types';\r\nimport Deck from './Deck.vue';\r\nimport Buildings from './mapLayers/Buildings.vue';\r\nimport defaults from './defaults';\r\nimport { Layer } from '@deck.gl/core';\r\nimport VisualizerManager from '@/visualizers/VisualizerManager';\r\nimport { Visualizer } from '@/visualizers';\r\nimport { AnyVisualizerInfo } from '@/visualizers/VisualizerInfo';\r\nimport { flowStore, flowUIStore } from '@/store/store-accessor';\r\nimport Backend from '@/api/backend';\r\n\r\n@Component({\r\n  name: 'MapVis',\r\n  components: { Deck, Buildings }\r\n})\r\nexport default class MapVis extends Vue {\r\n  @Prop({ type: Array, default: () => [] })\r\n  readonly layerInfos!: AnyVisualizerInfo[];\r\n\r\n  @Prop({ type: Object, default: null })\r\n  readonly timelineInfo!: TimeOrientedSimulationInfo | null;\r\n\r\n  @Prop({ type: Object, default: () => defaults.viewState() })\r\n  readonly viewState!: CameraOptions;\r\n\r\n  @Prop({ type: Number, default: 0 })\r\n  readonly timestamp!: number;\r\n\r\n  @Prop({ type: Boolean, default: false })\r\n  readonly buildings!: boolean;\r\n\r\n  basemap = 'mapbox://styles/mapbox/light-v10';\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  layers: Layer<any>[] = [];\r\n  visualizers: VisualizerManager | null = null;\r\n\r\n  popupContent: PopupContent | null = null;\r\n  activePopupId: string | null = null;\r\n\r\n  setBasemap(basemap: string) {\r\n    this.basemap = basemap;\r\n  }\r\n\r\n  // Move this inside a store?\r\n  get backend(): Backend | null {\r\n    return flowStore.backend;\r\n  }\r\n\r\n  ensureVisualizers() {\r\n    if (!this.visualizers && this.backend) {\r\n      this.visualizers = new VisualizerManager({\r\n        backend: this.backend,\r\n        onSuccess: () => {\r\n          flowUIStore.setLoading({ value: false });\r\n          this.updateLayers();\r\n        },\r\n        onError: () => {\r\n          flowUIStore.setLoading({ value: false });\r\n        },\r\n        onDelete: ({ info }) => {\r\n          if (info) {\r\n            if (info.id === this.activePopupId) {\r\n              this.activePopupId = null;\r\n              this.popupContent = null;\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    return this.visualizers;\r\n  }\r\n\r\n  get slotProps() {\r\n    return {\r\n      basemap: this.basemap,\r\n      setBasemap: this.setBasemap,\r\n      popupContent: this.popupContent,\r\n      updateTimestamp: (t: number) => this.$emit('update:timestamp', t),\r\n      dynamicPopup: this.popupContent?.position === 'dynamic',\r\n      closePopup: () => (this.popupContent = null)\r\n    };\r\n  }\r\n\r\n  @Watch('layerInfos', { immediate: true })\r\n  handleNewLayerInfos() {\r\n    flowUIStore.setLoading({ value: true, msg: 'Loading layers...' });\r\n    const visualizers = this.ensureVisualizers();\r\n\r\n    if (visualizers) {\r\n      visualizers.updateVisualizers(this.layerInfos).then(() => {});\r\n    }\r\n  }\r\n\r\n  @Watch('timestamp')\r\n  updateLayers() {\r\n    if (flowUIStore.loading) {\r\n      return;\r\n    }\r\n\r\n    const visualizers = this.ensureVisualizers();\r\n\r\n    this.layers = (visualizers?.getVisualizers() ?? [])\r\n      .sort((a, b) => (a.priority === b.priority ? a.order - b.order : a.priority - b.priority))\r\n      .map((v, idx) => {\r\n        // typescript for some reason can't figure out the type of `v` so we make sure to cast it to the\r\n        // type that it should be (Visualizer)\r\n        const visualizer: Visualizer = v;\r\n\r\n        visualizer.setCallbacks({\r\n          onClick: (content: PopupContent | null) => {\r\n            this.setPopup({ id: visualizer.info.id, content });\r\n          },\r\n          onHover: (content: PopupContent | null) => {\r\n            this.setPopup({ id: visualizer.info.id, content });\r\n          }\r\n        });\r\n        v.setLayerOrder(idx);\r\n        return v.getLayer(this.timestamp);\r\n      });\r\n  }\r\n\r\n  setPopup({ id, content }: { id: string; content: PopupContent | null }) {\r\n    this.activePopupId = id;\r\n    this.popupContent = content;\r\n  }\r\n\r\n  updateViewState(viewState: CameraOptions) {\r\n    this.$emit('update:view-state', viewState);\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.timeslider {\r\n  flex-grow: 1;\r\n  margin: 0 80px;\r\n}\r\n</style>\r\n","<template>\r\n  <b-tooltip :label=\"label\" type=\"is-black\">\r\n    <b-button\r\n      class=\"is-borderless\"\r\n      :class=\"actionClass\"\r\n      :disabled=\"disabled\"\r\n      @click=\"$emit('click')\"\r\n    >\r\n      <b-icon :icon=\"icon\" :size=\"minIconSize\" :type=\"type\"></b-icon>\r\n    </b-button>\r\n  </b-tooltip>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { Component, Prop, Vue } from 'vue-property-decorator';\r\nimport upperFirst from 'lodash/upperFirst';\r\n\r\n@Component({ name: 'MovAction' })\r\nexport default class MovAction extends Vue {\r\n  @Prop({ type: String, default: '' }) readonly action!: string;\r\n  @Prop({ type: String, default: '' }) readonly size!: string;\r\n  @Prop({ type: Boolean, default: false }) readonly disabled!: boolean;\r\n  disabledType = 'is-inactive';\r\n  // Even when the button is-small we want the icon to be is-medium. We can safely use this as\r\n  // the de-facto icon size as bulma automatically scales the icon up when the button becomes larger\r\n  minIconSize = 'is-medium';\r\n\r\n  get currentAction() {\r\n    const action = this.actions[this.action];\r\n    if (!action) {\r\n      console.error('Invalid action: ', this.action);\r\n    }\r\n    return action;\r\n  }\r\n\r\n  get icon() {\r\n    return this.currentAction.icon;\r\n  }\r\n\r\n  get type() {\r\n    return this.disabled ? this.disabledType : this.currentAction.type;\r\n  }\r\n\r\n  get label() {\r\n    return upperFirst(this.action);\r\n  }\r\n\r\n  get actionClass() {\r\n    return `action-${this.action} ${this.size}`;\r\n  }\r\n\r\n  get actions(): Record<string, { icon: string; type: string }> {\r\n    return {\r\n      add: {\r\n        icon: 'plus',\r\n        type: 'is-primary'\r\n      },\r\n      view: {\r\n        icon: 'eye',\r\n        type: 'is-primary'\r\n      },\r\n      edit: {\r\n        icon: 'pen',\r\n        type: 'is-info'\r\n      },\r\n      delete: {\r\n        icon: 'trash',\r\n        type: 'is-danger'\r\n      },\r\n      duplicate: {\r\n        icon: 'clone',\r\n        type: 'is-primary'\r\n      },\r\n      download: {\r\n        icon: 'download',\r\n        type: 'is-success'\r\n      },\r\n      generate: {\r\n        icon: 'play',\r\n        type: 'is-primary'\r\n      },\r\n      play: {\r\n        icon: 'play',\r\n        type: 'is-primary'\r\n      },\r\n      reset: {\r\n        icon: 'undo-alt',\r\n        type: 'is-danger'\r\n      },\r\n      cancel: {\r\n        icon: 'stop',\r\n        type: 'is-danger'\r\n      },\r\n      invite: {\r\n        icon: 'envelope',\r\n        type: 'is-dark'\r\n      },\r\n      logs: {\r\n        icon: 'file-alt',\r\n        type: 'is-dark'\r\n      }\r\n    };\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped></style>\r\n","<template>\r\n  <div>\r\n    <slot name=\"before\"></slot>\r\n    <MovAction\r\n      v-for=\"(action, idx) in actionList\"\r\n      :action=\"action\"\r\n      :key=\"idx\"\r\n      :size=\"size\"\r\n      :disabled=\"isDisabled(action)\"\r\n      :class=\"additionalClasses\"\r\n      @click=\"$emit(action)\"\r\n    ></MovAction>\r\n    <slot name=\"after\"></slot>\r\n  </div>\r\n</template>\r\n<script lang=\"ts\">\r\nimport { Component, Prop, Vue } from 'vue-property-decorator';\r\n\r\n@Component({ name: 'MovActionBar' })\r\nexport default class MovActionBar extends Vue {\r\n  @Prop({ type: [String, Array] }) readonly actions!: string | string[];\r\n  @Prop({ type: [String, Array] }) readonly disabled?: string | string[];\r\n  @Prop({ type: [String, Array] }) readonly enabled?: string | string[];\r\n  @Prop({ type: String, default: 'is-medium' }) readonly size!: string;\r\n  @Prop({ type: Array, default: () => [] }) readonly additionalClasses!: string[];\r\n\r\n  get actionList() {\r\n    if (this.actions)\r\n      if (Array.isArray(this.actions)) {\r\n        return this.actions;\r\n      } else {\r\n        return this.actions.trim().split(' ');\r\n      }\r\n    else return [];\r\n  }\r\n\r\n  get disabledList() {\r\n    if (this.disabled)\r\n      if (Array.isArray(this.disabled)) {\r\n        return this.disabled;\r\n      } else {\r\n        return this.disabled.trim().split(' ');\r\n      }\r\n    else return [];\r\n  }\r\n\r\n  get enabledList() {\r\n    if (this.enabled)\r\n      if (Array.isArray(this.enabled)) {\r\n        return this.enabled;\r\n      } else {\r\n        return this.enabled.trim().split(' ');\r\n      }\r\n    else return [];\r\n  }\r\n\r\n  isDisabled(action: string) {\r\n    if (!this.enabled && !this.disabled) return false;\r\n\r\n    if (this.enabled) {\r\n      return !this.enabledList.includes(action);\r\n    }\r\n\r\n    if (this.disabled) {\r\n      return this.disabledList.includes(action);\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped></style>\r\n","import { Component, Vue } from 'vue-property-decorator';\r\n\r\nfunction isVue(thing: unknown): thing is Vue {\r\n  return (thing as Vue).$el !== undefined;\r\n}\r\n\r\nfunction asElement(thing: Element | Vue | null): Element | null {\r\n  if (thing === null) {\r\n    return null;\r\n  }\r\n  return isVue(thing) ? thing.$el : thing;\r\n}\r\n\r\n/**\r\n * FixedPosition is a mixin to handle \"relative positioned components\" inside a scrollbar overflow.\r\n * We have a reference for the popup and a reference for the trigger.\r\n * This values are turned into bounding rectangles in reset() and calls the resetPosition.\r\n * If there's a overflow parent, then we setup the event bus to trigger it whenever the parent is scrolled.\r\n * This will update the popup style position correctly.\r\n */\r\n@Component\r\nexport default class FixedPosition extends Vue {\r\n  readonly popupRef!: HTMLElement;\r\n  readonly anchorRef!: HTMLElement;\r\n  overflowParent: Element | null = null;\r\n  style: Partial<CSSStyleDeclaration> = {};\r\n  visible = false;\r\n  adjust = {\r\n    top: 0,\r\n    left: 0\r\n  };\r\n\r\n  toggle(force?: boolean) {\r\n    this.visible = force ?? !this.visible;\r\n    if (this.visible) {\r\n      this.reset();\r\n    }\r\n  }\r\n\r\n  mounted() {\r\n    this.overflowParent = asElement(this.getOverflowVueParent('x-overflow'));\r\n    if (this.overflowParent) {\r\n      this.overflowParent.addEventListener('scroll', () => {\r\n        this.visible && this.reset();\r\n      });\r\n    }\r\n  }\r\n\r\n  reset() {\r\n    if (this.anchorRef && this.popupRef) {\r\n      const anchorRect = this.anchorRef.getBoundingClientRect(),\r\n        popupRect = this.popupRef.getBoundingClientRect();\r\n\r\n      this.resetPosition(anchorRect, popupRect, this.adjust);\r\n\r\n      if (this.overflowParent) {\r\n        const overflowRect = this.overflowParent.getBoundingClientRect();\r\n\r\n        // detect if either the anchor passed the top or bottom\r\n        if (overflowRect.top > anchorRect.top || anchorRect.bottom > overflowRect.bottom) {\r\n          this.visible = false;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Takes a class and looks recursively for an parent element that has that class.\r\n   * Used to get the overflow parent of this mixin component\r\n   * parent must be a Vue component\r\n   * @param cssClass CSS class, in most times value is 'overflow'\r\n   * @param vue_ this Vue instance, it's parent or elder parent\r\n   * @returns Vue | null\r\n   */\r\n  getOverflowVueParent(cssClass: string, vue_?: Vue): Vue | null {\r\n    vue_ ??= this;\r\n\r\n    const { $el, $parent } = vue_;\r\n\r\n    // if the element has the class we are looking for, we return it,\r\n    // else, if it has a parent, we recursively call gerOverflowParent to check for it's parent\r\n    // else reached the end of DOM no parent has overflow class.\r\n    if ($el?.classList.contains(cssClass)) {\r\n      return vue_;\r\n    } else if ($parent) {\r\n      return this.getOverflowVueParent(cssClass, $parent);\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Values calculates where the popup should be in reference to it's anchor\r\n   * This is done using 'position: fixed', so this can be used where a parent\r\n   * of the component has scrollbar overflow\r\n   * @param anchorRect Simplified rectangle properties of the anchor\r\n   * @param popupRect Simplified rectangle properties of the popup\r\n   * @param adjust top and left adjusts\r\n   */\r\n  resetPosition(\r\n    anchorRect: { left: number; top: number; width: number; height: number },\r\n    popupRect: { width: number; height: number },\r\n    adjust?: { left: number; top: number }\r\n  ) {\r\n    const popupStyle: Partial<CSSStyleDeclaration> = {};\r\n    if (popupRect && anchorRect) {\r\n      // In order to prevent the popup from being positioned outside of the viewport\r\n      // (as best we can), we have to know its dimensions. This way, we can limit\r\n      // offsets as the popup approaches the edge of the viewport.\r\n      // --\r\n      // PERFORMANCE NOTE: For a small improvement, we could gather these dimensions\r\n      // of the popup at the time we first render it. However, then we'd have to store\r\n      // them as component properties and I wanted to keep this as simple as possible.\r\n\r\n      const popupWidth = popupRect.width,\r\n        popupHeight = popupRect.height,\r\n        anchorWidth = anchorRect.width,\r\n        windowWidth = document.documentElement.clientWidth,\r\n        windowHeight = document.documentElement.clientHeight,\r\n        // NOTE: When positioning the popup, we are translating an ABSOLUTE position (the\r\n        // anchor) into a FIXED position (the popup). As such, we have to take the window\r\n        // scroll-offsets into account.\r\n\r\n        // First, let's calculate the \"natural\" position of the popup relative to the\r\n        // anchor. This would be the position if we didn't want to constrain the location\r\n        // of the popup relative to the viewport.\r\n        naturalLeft = anchorRect.left + (adjust?.left ?? 0),\r\n        naturalTop = anchorRect.top + (adjust?.top ?? 0),\r\n        // Second, let's calculate the constrained position of the popup relative to the\r\n        // viewport (such that the popup doesn't overlap with the edge of the viewport).\r\n        // --\r\n        // NOTE: In the following calculations, the \"10\" is the distance we want to keep\r\n        // the popup away from the edges of the viewport.\r\n        minLeft = 10,\r\n        maxLeft = windowWidth - popupWidth - 10,\r\n        minTop = 10,\r\n        maxTop = windowHeight - popupHeight - 10;\r\n\r\n      // Make sure we don't go too far right or left.\r\n      popupStyle.left = Math.max(minLeft, Math.min(naturalLeft + anchorWidth, maxLeft)) + 'px';\r\n      // Make sure we don't go too far down or up.\r\n      popupStyle.top = Math.max(minTop, Math.min(naturalTop, maxTop)) + 'px';\r\n      popupStyle.position = 'fixed !important';\r\n    }\r\n\r\n    this.style = popupStyle;\r\n  }\r\n}\r\n","<template>\r\n  <div\r\n    tabindex=\"0\"\r\n    @blur=\"visible = false\"\r\n    class=\"dropdown dropdown-menu-animation is-mobile-modal\"\r\n  >\r\n    <div\r\n      ref=\"anchorRef\"\r\n      role=\"button\"\r\n      aria-haspopup=\"true\"\r\n      class=\"dropdown-trigger\"\r\n      @click=\"toggle\"\r\n    >\r\n      <span class=\"ellipsis\">\r\n        <b-icon size=\"is-small\" pack=\"far\" icon=\"ellipsis-v\"></b-icon>\r\n      </span>\r\n    </div>\r\n    <div ref=\"popupRef\" class=\"dropdown-menu\" :style=\"style\" v-show=\"visible\">\r\n      <div class=\"dropdown-content\">\r\n        <a\r\n          v-for=\"(item, index) in value\"\r\n          :key=\"index\"\r\n          :focusable=\"false\"\r\n          :disabled=\"item.isDisabled ? item.isDisabled() : null\"\r\n          :class=\"item.colorScheme\"\r\n          @click=\"emitAndClose(item.event, $event)\"\r\n          class=\"dropdown-item\"\r\n        >\r\n          <b-icon :icon=\"item.icon\" :pack=\"item.iconPack || 'far'\" class=\"mr-2\"></b-icon>\r\n          <span>\r\n            {{ item.label }}\r\n          </span>\r\n        </a>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { Component, Mixins, Prop, Ref } from 'vue-property-decorator';\r\nimport FixedPosition from '../../mixins/FixedPosition';\r\n\r\nexport interface ActionMenuItem {\r\n  icon?: string;\r\n  iconPack?: string;\r\n  label: string;\r\n  event: string;\r\n  colorScheme?: string;\r\n  isDisabled?: () => boolean;\r\n}\r\n\r\n@Component({ name: 'MovActionMenu' })\r\nexport default class MovActionMenu extends Mixins(FixedPosition) {\r\n  @Prop({ default: [] }) readonly value!: ActionMenuItem[];\r\n  @Ref('anchorRef') declare readonly anchorRef: HTMLElement;\r\n  @Ref('popupRef') declare readonly popupRef: HTMLElement;\r\n  adjust = {\r\n    top: -12,\r\n    left: 8\r\n  };\r\n\r\n  emitAndClose(event: string, value: unknown) {\r\n    this.$emit(event, value);\r\n    this.visible = false;\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.dropdown {\r\n  .dropdown-trigger {\r\n    .ellipsis {\r\n      cursor: pointer;\r\n    }\r\n  }\r\n\r\n  .dropdown-menu {\r\n    a.dropdown-item {\r\n      color: $black;\r\n      font-size: 0.8em;\r\n      &:hover {\r\n        color: $primary;\r\n        background-color: $primary-invert;\r\n        .icon {\r\n          color: $primary;\r\n        }\r\n      }\r\n      &.danger {\r\n        &:hover {\r\n          color: $danger;\r\n          background-color: $danger-invert;\r\n          .icon {\r\n            color: $danger;\r\n          }\r\n        }\r\n      }\r\n      &.info {\r\n        &:hover {\r\n          color: $info;\r\n          background-color: $info-invert;\r\n          .icon {\r\n            color: $info;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <b-field :label=\"label\">\r\n    <b-select v-model=\"language\">\r\n      <option v-for=\"(lang, i) in languages\" :key=\"`Lang${i}`\" :value=\"lang\">{{ lang }}</option>\r\n    </b-select>\r\n  </b-field>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { Component, Prop, Vue } from 'vue-property-decorator';\r\nimport upperFirst from 'lodash/upperFirst';\r\nimport { flowUIStore } from '@/store/store-accessor';\r\n\r\n@Component({ name: 'MovLanguagePicker' })\r\nexport default class MovLanguagePicker extends Vue {\r\n  @Prop({ type: Boolean, default: false }) withLabel!: boolean;\r\n  languages = ['en', 'nl'];\r\n\r\n  get language() {\r\n    return flowUIStore.lang;\r\n  }\r\n\r\n  set language(newValue) {\r\n    flowUIStore.setLanguage(newValue);\r\n  }\r\n\r\n  get label() {\r\n    if (this.withLabel) {\r\n      return upperFirst('' + this.$t('settings.selectLanguage'));\r\n    }\r\n    return '';\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped></style>\r\n","<template>\r\n  <div>\r\n    <span class=\"b-tooltip is-white is-bottom is-medium\" :class=\"color\">\r\n      <div class=\"tooltip-content\" v-show=\"visible\" ref=\"popupRef\" :style=\"style\">\r\n        <slot name=\"tooltip-content\">\r\n          <span class=\"is-size-7\">\r\n            {{ text }}\r\n          </span>\r\n        </slot>\r\n      </div>\r\n      <div\r\n        class=\"tooltip-trigger\"\r\n        ref=\"anchorRef\"\r\n        @mouseover=\"toggle(true)\"\r\n        @mouseleave=\"toggle(false)\"\r\n      >\r\n        <b-icon v-if=\"!this.$slots.default\" :icon=\"icon\"> </b-icon>\r\n        <slot></slot>\r\n      </div>\r\n    </span>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { Component, Mixins, Prop, Ref } from 'vue-property-decorator';\r\nimport FixedPosition from '../../mixins/FixedPosition';\r\n\r\n@Component({ name: 'MovTooltipInfo' })\r\nexport default class MovTooltipInfo extends Mixins(FixedPosition) {\r\n  @Prop({ type: String, default: '' }) text!: string;\r\n  @Prop({ type: String, default: 'info' }) icon!: string;\r\n  @Prop({ type: String, default: 'is-bottom' }) position!: string;\r\n  @Prop({ type: String, default: 'is-black' }) color!: string;\r\n  @Prop({ type: String, default: 'is-small' }) size!: string;\r\n  @Prop({ type: Boolean, default: false }) active!: boolean;\r\n  @Prop({ type: Number, default: 0 }) delay!: number;\r\n  @Ref('anchorRef') declare readonly anchorRef: HTMLElement;\r\n  @Ref('popupRef') declare readonly popupRef: HTMLElement;\r\n  adjust = {\r\n    top: 30,\r\n    left: -80\r\n  };\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.icon {\r\n  font-size: 0.5rem;\r\n  border-radius: 100%;\r\n  height: 1rem;\r\n  width: 1rem;\r\n  line-height: 0.5rem;\r\n}\r\n</style>\r\n","import { SnackbarProgrammatic as Snackbar } from 'buefy';\r\nimport { BSnackbarConfig } from 'buefy/types/components';\r\n\r\nexport function successMessage(message: string) {\r\n  openSnackbar({\r\n    message: message,\r\n    type: 'is-success',\r\n    duration: 3000\r\n  });\r\n}\r\n\r\nexport function failMessage(message: string) {\r\n  openSnackbar({\r\n    message: message,\r\n    type: 'is-danger',\r\n    duration: 60000\r\n  });\r\n}\r\n\r\nfunction openSnackbar(message: BSnackbarConfig) {\r\n  Snackbar.open({\r\n    type: 'is-success',\r\n    position: 'is-top',\r\n    queue: false,\r\n    ...message\r\n  });\r\n}\r\n\r\nexport default {\r\n  successMessage,\r\n  failMessage\r\n};\r\n","import Vue_ from 'vue';\r\n\r\nexport const registerComponent = (Vue: typeof Vue_, component: typeof Vue) => {\r\n  Vue.component(component.name, component);\r\n};\r\n\r\nexport const registerComponentProgrammatic = (\r\n  Vue: typeof Vue_,\r\n  property: string,\r\n  component: unknown\r\n) => {\r\n  if (!Vue.prototype.$flow) Vue.prototype.$flow = {};\r\n  Vue.prototype.$flow[property] = component;\r\n};\r\n","/*\r\nAdapted from https://github.com/bernawil/axios-concurrency\r\n\r\nCopyright (C) 2019 Bernardo Wilberger\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining\r\na copy of this software and associated documentation files (the\r\n\"Software\"), to deal in the Software without restriction, including\r\nwithout limitation the rights to use, copy, modify, merge, publish,\r\ndistribute, sublicense, and/or sell copies of the Software, and to\r\npermit persons to whom the Software is furnished to do so, subject to\r\nthe following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be\r\nincluded in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\r\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\r\nLIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\nOF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\r\nWITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n\r\n */\r\n\r\nimport { AxiosInstance, AxiosRequestConfig, AxiosResponse } from 'axios';\r\n\r\ninterface RequestHandler {\r\n  request: AxiosRequestConfig;\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  resolver: any;\r\n}\r\nexport const ConcurrencyManager = (axios: AxiosInstance, MAX_CONCURRENT = 10) => {\r\n  if (MAX_CONCURRENT < 1) throw 'Concurrency Manager Error: minimun concurrent requests is 1';\r\n  const instance = {\r\n    queue: [] as RequestHandler[],\r\n    running: [] as RequestHandler[],\r\n    shiftInitial: () => {\r\n      setTimeout(() => {\r\n        if (instance.running.length < MAX_CONCURRENT) {\r\n          instance.shift();\r\n        }\r\n      }, 0);\r\n    },\r\n    push: (reqHandler: RequestHandler) => {\r\n      instance.queue.push(reqHandler);\r\n      instance.shiftInitial();\r\n    },\r\n    shift: () => {\r\n      if (instance.queue.length) {\r\n        const queued = instance.queue.shift();\r\n        if (queued) {\r\n          queued.resolver(queued.request);\r\n          instance.running.push(queued);\r\n        }\r\n      }\r\n    },\r\n    // Use as interceptor. Queue outgoing requests\r\n    requestHandler: (req: AxiosRequestConfig): Promise<AxiosRequestConfig> => {\r\n      return new Promise(resolve => {\r\n        instance.push({ request: req, resolver: resolve });\r\n        return req;\r\n      });\r\n    },\r\n    // Use as interceptor. Execute queued request upon receiving a response\r\n    responseHandler: (res: AxiosResponse) => {\r\n      instance.running.shift();\r\n      instance.shift();\r\n      return res;\r\n    },\r\n    responseErrorHandler: (res: AxiosResponse) => {\r\n      return Promise.reject(instance.responseHandler(res));\r\n    },\r\n    interceptors: {\r\n      request: -1,\r\n      response: -1\r\n    },\r\n    detach: () => {\r\n      axios.interceptors.request.eject(instance.interceptors.request);\r\n      axios.interceptors.response.eject(instance.interceptors.response);\r\n    }\r\n  };\r\n  // queue concurrent requests\r\n  instance.interceptors.request = axios.interceptors.request.use(instance.requestHandler);\r\n  instance.interceptors.response = axios.interceptors.response.use(\r\n    instance.responseHandler,\r\n    instance.responseErrorHandler\r\n  );\r\n  return instance;\r\n};\r\n","import axios, { AxiosError, AxiosInstance } from 'axios';\r\nimport { BaseRequest } from '@/api/requests';\r\nimport { ConcurrencyManager } from '@/api/concurrency';\r\n\r\ninterface ErrorHandlingConfig {\r\n  [k: number]: (e: HTTPErrorPayload) => void;\r\n  http?: (e: HTTPErrorPayload) => void;\r\n  all?: (e: Error | unknown) => void;\r\n}\r\ninterface HTTPErrorPayload {\r\n  status?: number;\r\n  message: string;\r\n}\r\n\r\ninterface ClientConfig {\r\n  baseURL: string;\r\n  apiToken?: string | null;\r\n  concurrency?: number;\r\n  defaultCallbacks?: ErrorHandlingConfig;\r\n}\r\n\r\nexport default class Client {\r\n  readonly baseURL: string;\r\n  readonly onError: ErrorHandlingConfig;\r\n  apiToken: string | null;\r\n  private readonly http: AxiosInstance;\r\n\r\n  constructor(config: ClientConfig) {\r\n    this.baseURL = config.baseURL;\r\n    this.apiToken = config.apiToken || null;\r\n    this.http = axios.create();\r\n    this.onError = config.defaultCallbacks ?? {};\r\n    if (config.concurrency) {\r\n      ConcurrencyManager(this.http, config.concurrency);\r\n    }\r\n  }\r\n\r\n  downloadAsFile(data: Blob, filename: string) {\r\n    const url = window.URL.createObjectURL(data);\r\n\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.setAttribute('download', filename);\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    link.remove();\r\n  }\r\n\r\n  async request<T>(request: BaseRequest<T>, onError?: ErrorHandlingConfig): Promise<T | null> {\r\n    try {\r\n      const resp = await this.http.request(request.generateConfig(this));\r\n      return request.makeResponse(resp);\r\n    } catch (e) {\r\n      this.handleError(e, onError || {});\r\n      return null;\r\n    }\r\n  }\r\n\r\n  handleError(e: Error | unknown, onError: ErrorHandlingConfig): void {\r\n    const handlers: ErrorHandlingConfig = { ...this.onError, ...onError };\r\n\r\n    if (axios.isAxiosError(e)) {\r\n      const payload = parseHTTPError(e);\r\n      if (payload.status && handlers[payload.status]) {\r\n        return handlers[payload.status](payload);\r\n      }\r\n      if (handlers.http) {\r\n        return handlers.http(payload);\r\n      }\r\n    }\r\n    if (handlers.all) {\r\n      return handlers.all(e);\r\n    }\r\n    throw e;\r\n  }\r\n}\r\n\r\nconst HTTPS_STATUS_CODES: Record<number, string> = {\r\n  400: 'Bad Request',\r\n  401: 'Unauthorized',\r\n  403: 'Forbidden',\r\n  404: 'Not Found',\r\n  409: 'Conflict',\r\n  500: 'Internal Server Error',\r\n  502: 'Bad Gateway'\r\n};\r\n\r\nfunction parseHTTPError(err: AxiosError): HTTPErrorPayload {\r\n  let status: number | undefined = undefined;\r\n  let message = '';\r\n\r\n  if (err.response) {\r\n    status = err.response.status;\r\n    message = JSON.stringify(err.response.data.message);\r\n  }\r\n  if (!message) {\r\n    message = status ? HTTPS_STATUS_CODES[status] : 'Unknown Error';\r\n  }\r\n  return { status, message };\r\n}\r\n","import Client from '@/api/client';\r\nimport { AxiosRequestConfig, AxiosResponse } from 'axios';\r\n\r\nexport abstract class BaseRequest<Resp> {\r\n  abstract makeRequest(): AxiosRequestConfig;\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  generateConfig(client: Client): AxiosRequestConfig {\r\n    return this.makeRequest();\r\n  }\r\n\r\n  makeResponse(resp: AxiosResponse): Resp {\r\n    return (resp.data as unknown) as Resp;\r\n  }\r\n}\r\n\r\nexport abstract class Request<Resp> extends BaseRequest<Resp> {\r\n  generateConfig(client: Client): AxiosRequestConfig {\r\n    const baseURL = client.baseURL,\r\n      request = this.makeRequest();\r\n\r\n    return {\r\n      baseURL,\r\n      headers: client.apiToken ? { Authorization: client.apiToken } : {},\r\n      ...request\r\n    };\r\n  }\r\n}\r\n","export const authServerBase = '/auth/v1';\r\nexport const dataEngineBase = '/data-engine/v4';\r\nexport const geocodeBase = '/geocoder/v1';\r\nexport const datasetGeneratorBase = '/dataset-generator/v1';\r\nexport const simulationControlBase = '/model-engine/v1';\r\n\r\nexport default {\r\n  activate: '/user/activate',\r\n  activityLogs: '/activity_logs',\r\n  autocomplete: '/autocomplete',\r\n  analysisPlot: '/analysis/plot',\r\n  control: '/control',\r\n  data: '/data',\r\n  datasets: '/datasets',\r\n  dataset_types: '/dataset_types',\r\n  entity_types: '/entity_types',\r\n  feedback_form: '/feedback/submit',\r\n  forgotpassword: '/user/forgot-password',\r\n  generate: '/generate',\r\n  generators: '/generators',\r\n  initdata: '/init_data',\r\n  invite: '/invite',\r\n  login: '/user/login',\r\n  logout: '/user/logout',\r\n  logs: '/logs',\r\n  map: '/map',\r\n  modelTypes: '/model_types',\r\n  organisations: '/organisations',\r\n  projects: '/projects',\r\n  profile: '/user/profile',\r\n  property_types: '/property_types',\r\n  resetpassword: '/user/reset-password',\r\n  results: '/results',\r\n  reverseSearch: '/reverse_search',\r\n  roles: '/roles',\r\n  runSimulation: '/run-simulation',\r\n  scenarios: '/scenarios',\r\n  schema: '/schema',\r\n  scopes: '/scopes',\r\n  search: '/search',\r\n  simulations: '/simulations',\r\n  state: '/state',\r\n  summary: '/summary',\r\n  timeline: '/timeline',\r\n  updates: '/updates',\r\n  users: '/users',\r\n  validateAuth: '/auth',\r\n  views: '/views',\r\n  workloads: '/workloads'\r\n};\r\n","import { ComponentProperty, Dataset, DatasetCrudResponse, DatasetWithData, UUID } from '@/types';\r\nimport { AxiosRequestConfig, AxiosResponse } from 'axios';\r\nimport uri, { dataEngineBase } from '@/api/requests/uri';\r\nimport { Request } from '@/api/requests/base';\r\n\r\nexport interface DatasetFilter {\r\n  properties?: string; // comma separated string\r\n  entity_group?: UUID;\r\n  components?: string; // comma separated string\r\n}\r\ninterface ScenarioStateFilter extends DatasetFilter {\r\n  dataset_uuid?: UUID;\r\n  dataset_name?: string;\r\n  timestamp?: number;\r\n}\r\n\r\nexport class GetDatasets extends Request<Dataset[]> {\r\n  projectUUID: UUID;\r\n\r\n  constructor(projectUUID: UUID) {\r\n    super();\r\n    this.projectUUID = projectUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.projects}/${this.projectUUID}${uri.datasets}`\r\n    };\r\n  }\r\n\r\n  makeResponse(resp: AxiosResponse): Dataset[] {\r\n    return resp.data.datasets.map((d: unknown) => new Dataset(d as Partial<Dataset>));\r\n  }\r\n}\r\n\r\nexport class GetDataset extends Request<Dataset> {\r\n  datasetUUID: UUID;\r\n\r\n  constructor(datasetUUID: UUID) {\r\n    super();\r\n    this.datasetUUID = datasetUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.datasets}/${this.datasetUUID}`\r\n    };\r\n  }\r\n  makeResponse(resp: AxiosResponse): Dataset {\r\n    return new DatasetWithData(resp.data as Partial<Dataset>);\r\n  }\r\n}\r\n\r\nexport class AddDataset extends Request<DatasetCrudResponse> {\r\n  dataset: Dataset;\r\n  projectUUID: UUID;\r\n  constructor(projectUUID: UUID, dataset: Dataset) {\r\n    super();\r\n    this.projectUUID = projectUUID;\r\n    this.dataset = dataset;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'post',\r\n      url: `${dataEngineBase}${uri.projects}/${this.projectUUID}${uri.datasets}`,\r\n      data: this.dataset\r\n    };\r\n  }\r\n}\r\n\r\nexport class UpdateDataset extends Request<DatasetCrudResponse> {\r\n  datasetUUID: UUID;\r\n  dataset: Dataset;\r\n  constructor(datasetUUID: UUID, dataset: Dataset) {\r\n    super();\r\n    this.datasetUUID = datasetUUID;\r\n    this.dataset = dataset;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'put',\r\n      url: `${dataEngineBase}${uri.datasets}/${this.datasetUUID}`,\r\n      data: {\r\n        name: this.dataset.name,\r\n        type: this.dataset.type\r\n      }\r\n    };\r\n  }\r\n}\r\nexport class DeleteDataset extends Request<DatasetCrudResponse> {\r\n  datasetUUID: UUID;\r\n\r\n  constructor(datasetUUID: UUID) {\r\n    super();\r\n    this.datasetUUID = datasetUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'delete',\r\n      url: `${dataEngineBase}${uri.datasets}/${this.datasetUUID}`\r\n    };\r\n  }\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nexport class GetDatasetData<T = any> extends Request<DatasetWithData<T>> {\r\n  datasetUUID: string;\r\n  entityGroup?: string;\r\n  properties?: ComponentProperty[];\r\n\r\n  constructor(datasetUUID: UUID, entityGroup?: string, properties?: ComponentProperty[]) {\r\n    super();\r\n    this.datasetUUID = datasetUUID;\r\n    this.entityGroup = entityGroup;\r\n    this.properties = properties;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.datasets}/${this.datasetUUID}${uri.data}`,\r\n      params: getDatasetFilterParams(this.entityGroup, this.properties)\r\n    };\r\n  }\r\n\r\n  makeResponse(resp: AxiosResponse): DatasetWithData<T> {\r\n    return new DatasetWithData(resp.data);\r\n  }\r\n}\r\n\r\nexport class GetDatasetDataAsBlob extends Request<{ data: Blob; contentType: string }> {\r\n  datasetUUID: string;\r\n  entityGroup?: string;\r\n  properties?: ComponentProperty[];\r\n\r\n  constructor(datasetUUID: UUID, entityGroup?: string, properties?: ComponentProperty[]) {\r\n    super();\r\n    this.datasetUUID = datasetUUID;\r\n    this.entityGroup = entityGroup;\r\n    this.properties = properties;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.datasets}/${this.datasetUUID}${uri.data}`,\r\n      params: getDatasetFilterParams(this.entityGroup, this.properties),\r\n      responseType: 'blob'\r\n    };\r\n  }\r\n  makeResponse(resp: AxiosResponse): { data: Blob; contentType: string } {\r\n    return {\r\n      data: resp.data,\r\n      contentType: resp.headers['content-type']\r\n    };\r\n  }\r\n}\r\n\r\nexport class AddDatasetData extends Request<unknown> {\r\n  datasetUUID: UUID;\r\n  file: string | Blob;\r\n  onProgress?: (e: ProgressEvent) => void;\r\n  constructor(datasetUUID: UUID, file: string | Blob, onProgress?: (e: ProgressEvent) => void) {\r\n    super();\r\n    this.datasetUUID = datasetUUID;\r\n    this.file = file;\r\n    this.onProgress = onProgress;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    const form = new FormData();\r\n    form.append('data', this.file);\r\n\r\n    return {\r\n      method: 'post',\r\n      url: `${dataEngineBase}${uri.datasets}/${this.datasetUUID}/data`,\r\n      data: form,\r\n      onUploadProgress: this.onProgress\r\n    };\r\n  }\r\n}\r\n\r\nexport class DeleteDatasetData extends Request<DatasetCrudResponse> {\r\n  datasetUUID: UUID;\r\n\r\n  constructor(datasetUUID: UUID) {\r\n    super();\r\n    this.datasetUUID = datasetUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'delete',\r\n      url: `${dataEngineBase}${uri.datasets}/${this.datasetUUID}/data`\r\n    };\r\n  }\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nexport class GetScenarioState<T = any> extends Request<DatasetWithData<T>> {\r\n  datasetUUID: UUID;\r\n  scenarioUUID: UUID;\r\n  entityGroup?: string;\r\n  properties?: ComponentProperty[];\r\n  timestamp?: number;\r\n\r\n  constructor(\r\n    datasetUUID: UUID,\r\n    scenarioUUID: UUID,\r\n    entityGroup?: string,\r\n    properties?: ComponentProperty[],\r\n    timestamp?: number\r\n  ) {\r\n    super();\r\n    this.datasetUUID = datasetUUID;\r\n    this.scenarioUUID = scenarioUUID;\r\n    this.entityGroup = entityGroup;\r\n    this.properties = properties;\r\n    this.timestamp = timestamp;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.scenarios}/${this.scenarioUUID}${uri.state}`,\r\n      params: this.getStateFilterParams()\r\n    };\r\n  }\r\n\r\n  makeResponse(resp: AxiosResponse): DatasetWithData<T> {\r\n    return new DatasetWithData(resp.data);\r\n  }\r\n\r\n  getStateFilterParams(): ScenarioStateFilter {\r\n    const params: ScenarioStateFilter = getDatasetFilterParams(this.entityGroup, this.properties);\r\n    params.dataset_uuid = this.datasetUUID;\r\n    if (this.timestamp !== undefined) {\r\n      params.timestamp = this.timestamp;\r\n    }\r\n    return params;\r\n  }\r\n}\r\n\r\nexport function getDatasetFilterParams(\r\n  entityGroup?: string,\r\n  properties?: ComponentProperty[]\r\n): DatasetFilter {\r\n  if (!entityGroup) {\r\n    return {};\r\n  }\r\n\r\n  if (!properties?.length) {\r\n    return {\r\n      entity_group: entityGroup\r\n    };\r\n  }\r\n  const components = new Set();\r\n  const props = new Set();\r\n  properties.forEach(p => {\r\n    if (p.component) {\r\n      components.add(p.component);\r\n    }\r\n    props.add(p.name);\r\n  });\r\n  return {\r\n    entity_group: entityGroup,\r\n    properties: Array.from(props).join(','),\r\n    components: components.size ? Array.from(components).join(',') : undefined\r\n  };\r\n}\r\n\r\nexport class GetDatasetMapThumbnail extends Request<ArrayBuffer> {\r\n  datasetUUID: UUID;\r\n\r\n  constructor(datasetUUID: UUID) {\r\n    super();\r\n    this.datasetUUID = datasetUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.datasets}/${this.datasetUUID}${uri.map}`,\r\n      params: { thumbnail: 'true' },\r\n      responseType: 'arraybuffer'\r\n    };\r\n  }\r\n}\r\n\r\nexport class GetDatasetMap extends Request<{ data: ArrayBuffer; contentType: string }> {\r\n  datasetUUID: UUID;\r\n\r\n  constructor(datasetUUID: UUID) {\r\n    super();\r\n    this.datasetUUID = datasetUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.datasets}/${this.datasetUUID}${uri.map}`,\r\n      params: { thumbnail: 'false' },\r\n      responseType: 'arraybuffer'\r\n    };\r\n  }\r\n\r\n  makeResponse(resp: AxiosResponse): { data: ArrayBuffer; contentType: string } {\r\n    return {\r\n      data: resp.data,\r\n      contentType: resp.headers['content-type']\r\n    };\r\n  }\r\n}\r\n","import uri, { geocodeBase } from '@/api/requests/uri';\r\nimport {\r\n  GeocodeSearchQuery,\r\n  GeocodeSearchResult,\r\n  GeocodeSuggestion,\r\n  ReverseGeocodeSearchQuery,\r\n  ReverseGeocodeSearchResult,\r\n  UUID\r\n} from '@/types';\r\nimport { AxiosRequestConfig, AxiosResponse } from 'axios';\r\nimport { Request } from '@/api/requests/base';\r\n\r\nexport class GetGeocodeSuggestions extends Request<GeocodeSuggestion[]> {\r\n  query: GeocodeSearchQuery;\r\n  constructor(query: GeocodeSearchQuery) {\r\n    super();\r\n    this.query = query;\r\n  }\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'post',\r\n      url: `${geocodeBase}${uri.autocomplete}`,\r\n      data: this.query\r\n    };\r\n  }\r\n  makeResponse(resp: AxiosResponse): GeocodeSuggestion[] {\r\n    return resp.data.results as GeocodeSuggestion[];\r\n  }\r\n}\r\n\r\nexport class GetGeocodeResults extends Request<GeocodeSearchResult[]> {\r\n  query: GeocodeSearchQuery;\r\n  constructor(query: GeocodeSearchQuery) {\r\n    super();\r\n    this.query = query;\r\n  }\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'post',\r\n      url: `${geocodeBase}${uri.search}`,\r\n      data: this.query\r\n    };\r\n  }\r\n  makeResponse(resp: AxiosResponse): GeocodeSearchResult[] {\r\n    return resp.data.results as GeocodeSearchResult[];\r\n  }\r\n}\r\n\r\nexport class GetGeocodeResult extends Request<GeocodeSearchResult> {\r\n  resultUUID: UUID;\r\n  constructor(resultUUID: UUID) {\r\n    super();\r\n    this.resultUUID = resultUUID;\r\n  }\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${geocodeBase}${uri.results}/${this.resultUUID}`\r\n    };\r\n  }\r\n  makeResponse(resp: AxiosResponse): GeocodeSearchResult {\r\n    return resp.data as GeocodeSearchResult;\r\n  }\r\n}\r\n\r\nexport class GetGeocodeAddress extends Request<ReverseGeocodeSearchResult> {\r\n  query: ReverseGeocodeSearchQuery;\r\n  constructor(query: ReverseGeocodeSearchQuery) {\r\n    super();\r\n    this.query = query;\r\n  }\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'post',\r\n      url: `${geocodeBase}${uri.reverseSearch}`,\r\n      data: this.query\r\n    };\r\n  }\r\n}\r\n","import { Project, ProjectCrudResponse, UUID } from '@/types';\r\nimport { AxiosRequestConfig, AxiosResponse } from 'axios';\r\nimport uri, { dataEngineBase } from '@/api/requests/uri';\r\nimport { Request } from '@/api/requests/base';\r\n\r\nexport class GetProjects extends Request<Project[]> {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.projects}`\r\n    };\r\n  }\r\n\r\n  makeResponse(resp: AxiosResponse): Project[] {\r\n    return resp.data.projects as Project[];\r\n  }\r\n}\r\n\r\nexport class GetProject extends Request<Project> {\r\n  projectUUID: UUID;\r\n\r\n  constructor(projectUUID: UUID) {\r\n    super();\r\n    this.projectUUID = projectUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.projects}/${this.projectUUID}`\r\n    };\r\n  }\r\n}\r\n\r\nexport class AddProject extends Request<ProjectCrudResponse> {\r\n  payload: Partial<Project>;\r\n  constructor(payload: Partial<Project>) {\r\n    super();\r\n    this.payload = payload;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    delete this.payload.uuid;\r\n    return {\r\n      method: 'post',\r\n      url: `${dataEngineBase}${uri.projects}`,\r\n      data: this.payload\r\n    };\r\n  }\r\n}\r\n\r\nexport class UpdateProject extends Request<ProjectCrudResponse> {\r\n  payload: Project;\r\n  projectUUID: UUID;\r\n  constructor(projectUUID: UUID, payload: Project) {\r\n    super();\r\n    this.payload = payload;\r\n    this.projectUUID = projectUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'put',\r\n      url: `${dataEngineBase}${uri.projects}/${this.projectUUID}`,\r\n      data: { display_name: this.payload.display_name }\r\n    };\r\n  }\r\n}\r\n\r\nexport class DeleteProject extends Request<ProjectCrudResponse> {\r\n  projectUUID: UUID;\r\n  constructor(projectUUID: UUID) {\r\n    super();\r\n    this.projectUUID = projectUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'delete',\r\n      url: `${dataEngineBase}${uri.projects}/${this.projectUUID}`\r\n    };\r\n  }\r\n}\r\n","import {\r\n  Scenario,\r\n  ScenarioCrudResponse,\r\n  ShortScenario,\r\n  TimelineCrudResponse,\r\n  TimelineInfo,\r\n  UUID\r\n} from '@/types';\r\nimport { AxiosRequestConfig, AxiosResponse } from 'axios';\r\nimport uri, { dataEngineBase } from '@/api/requests/uri';\r\nimport { Request } from '@/api/requests/base';\r\n\r\nexport class GetScenarios extends Request<ShortScenario[]> {\r\n  projectUUID: UUID;\r\n\r\n  constructor(projectUUID: UUID) {\r\n    super();\r\n    this.projectUUID = projectUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.projects}/${this.projectUUID}${uri.scenarios}`\r\n    };\r\n  }\r\n\r\n  makeResponse(resp: AxiosResponse): ShortScenario[] {\r\n    return resp.data.scenarios;\r\n  }\r\n}\r\n\r\nexport class GetScenario extends Request<Scenario> {\r\n  scenarioUUID: UUID;\r\n\r\n  constructor(scenarioUUID: UUID) {\r\n    super();\r\n    this.scenarioUUID = scenarioUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.scenarios}/${this.scenarioUUID}`\r\n    };\r\n  }\r\n\r\n  makeResponse(resp: AxiosResponse): Scenario {\r\n    const data = resp.data;\r\n    data.has_simulation = data.has_simulation ? data.has_simulation : false;\r\n\r\n    return (data as unknown) as Scenario;\r\n  }\r\n}\r\n\r\nexport class AddScenario extends Request<ScenarioCrudResponse> {\r\n  payload: Scenario;\r\n  projectUUID: UUID;\r\n  constructor(projectUUID: UUID, payload: Scenario) {\r\n    super();\r\n    this.payload = payload;\r\n    this.projectUUID = projectUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    delete this.payload.has_simulation;\r\n\r\n    return {\r\n      method: 'post',\r\n      url: `${dataEngineBase}${uri.projects}/${this.projectUUID}${uri.scenarios}`,\r\n      data: this.payload\r\n    };\r\n  }\r\n}\r\n\r\nexport class UpdateScenario extends Request<ScenarioCrudResponse> {\r\n  payload: Scenario;\r\n  scenarioUUID: UUID;\r\n  constructor(scenarioUUID: UUID, payload: Scenario) {\r\n    super();\r\n    this.payload = payload;\r\n    this.scenarioUUID = scenarioUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    delete this.payload.has_simulation;\r\n\r\n    return {\r\n      method: 'put',\r\n      url: `${dataEngineBase}${uri.scenarios}/${this.scenarioUUID}`,\r\n      data: this.payload\r\n    };\r\n  }\r\n}\r\n\r\nexport class DeleteScenario extends Request<ScenarioCrudResponse> {\r\n  scenarioUUID: UUID;\r\n  constructor(scenarioUUID: UUID) {\r\n    super();\r\n    this.scenarioUUID = scenarioUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'delete',\r\n      url: `${dataEngineBase}${uri.scenarios}/${this.scenarioUUID}`\r\n    };\r\n  }\r\n}\r\n\r\nexport class GetTimelineInfo extends Request<TimelineInfo> {\r\n  scenarioUUID: UUID;\r\n\r\n  constructor(scenarioUUID: UUID) {\r\n    super();\r\n    this.scenarioUUID = scenarioUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.scenarios}/${this.scenarioUUID}${uri.timeline}`\r\n    };\r\n  }\r\n}\r\n\r\nexport class DeleteTimeline extends Request<TimelineCrudResponse> {\r\n  scenarioUUID: UUID;\r\n\r\n  constructor(scenarioUUID: UUID) {\r\n    super();\r\n    this.scenarioUUID = scenarioUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'delete',\r\n      url: `${dataEngineBase}${uri.scenarios}/${this.scenarioUUID}${uri.timeline}`\r\n    };\r\n  }\r\n}\r\n","import { AxiosRequestConfig } from 'axios';\r\nimport uri, { dataEngineBase } from '@/api/requests/uri';\r\nimport { DatasetSummary, UUID } from '@/types';\r\nimport { Request } from '@/api/requests/base';\r\n\r\nexport class GetDatasetSummary extends Request<DatasetSummary> {\r\n  datasetUUID: string;\r\n  constructor(datasetUUID: UUID) {\r\n    super();\r\n    this.datasetUUID = datasetUUID;\r\n  }\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.datasets}/${this.datasetUUID}${uri.summary}`\r\n    };\r\n  }\r\n}\r\n\r\nexport class GetScenarioSummary extends Request<DatasetSummary> {\r\n  scenarioUUID: UUID;\r\n  datasetUUID: UUID;\r\n  constructor(scenarioUUID: UUID, datasetUUID: UUID) {\r\n    super();\r\n    this.scenarioUUID = scenarioUUID;\r\n    this.datasetUUID = datasetUUID;\r\n  }\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.scenarios}/${this.scenarioUUID}${uri.summary}`,\r\n      params: {\r\n        dataset_uuid: this.datasetUUID\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\nexport class GetUpdateSummary extends Request<DatasetSummary> {\r\n  updateUUID: UUID;\r\n  constructor(updateUUID: UUID) {\r\n    super();\r\n    this.updateUUID = updateUUID;\r\n  }\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.updates}/${this.updateUUID}${uri.summary}`\r\n    };\r\n  }\r\n}\r\n","import { ComponentProperty, TimelineFilter, Update, UpdateWithData, UUID } from '@/types';\r\nimport { AxiosRequestConfig, AxiosResponse } from 'axios';\r\nimport uri, { dataEngineBase } from '@/api/requests/uri';\r\nimport { getDatasetFilterParams } from '@/api/requests/datasets';\r\nimport { Request } from './base';\r\n\r\nexport class GetUpdates extends Request<Update[]> {\r\n  scenarioUUID: string;\r\n  timelineFilter: TimelineFilter;\r\n  constructor(scenarioUUID: UUID, filter?: TimelineFilter) {\r\n    super();\r\n    this.scenarioUUID = scenarioUUID;\r\n    this.timelineFilter = filter ?? {};\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.scenarios}/${this.scenarioUUID}${uri.updates}`,\r\n      params: this.timelineFilter\r\n    };\r\n  }\r\n\r\n  makeResponse(resp: AxiosResponse): Update[] {\r\n    return resp.data.updates as Update[];\r\n  }\r\n}\r\n\r\nexport class GetUpdateWithData extends Request<UpdateWithData> {\r\n  updateUUID: UUID;\r\n  entityGroup?: string;\r\n  properties?: ComponentProperty[];\r\n\r\n  constructor(updateUUID: UUID, entityGroup?: string, properties?: ComponentProperty[]) {\r\n    super();\r\n    this.updateUUID = updateUUID;\r\n    this.entityGroup = entityGroup;\r\n    this.properties = properties;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.updates}/${this.updateUUID}`,\r\n      params: getDatasetFilterParams(this.entityGroup, this.properties)\r\n    };\r\n  }\r\n}\r\n\r\nexport class GetUpdateAsBlob extends Request<Blob> {\r\n  updateUUID: UUID;\r\n  entityGroup?: string;\r\n  properties?: ComponentProperty[];\r\n\r\n  constructor(updateUUID: UUID, entityGroup?: string, properties?: ComponentProperty[]) {\r\n    super();\r\n    this.updateUUID = updateUUID;\r\n    this.entityGroup = entityGroup;\r\n    this.properties = properties;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.updates}/${this.updateUUID}`,\r\n      params: getDatasetFilterParams(this.entityGroup, this.properties),\r\n      responseType: 'blob'\r\n    };\r\n  }\r\n}\r\n","import { UUID, View, ViewCrudResponse } from '@/types';\r\nimport { AxiosRequestConfig, AxiosResponse } from 'axios';\r\nimport uri, { dataEngineBase } from '@/api/requests/uri';\r\nimport { Request } from '@/api/requests/base';\r\n\r\nexport class GetViews extends Request<View[]> {\r\n  scenarioUUID: UUID;\r\n\r\n  constructor(scenarioUUID: UUID) {\r\n    super();\r\n    this.scenarioUUID = scenarioUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.scenarios}/${this.scenarioUUID}${uri.views}`\r\n    };\r\n  }\r\n\r\n  makeResponse(resp: AxiosResponse): View[] {\r\n    return resp.data.views;\r\n  }\r\n}\r\n\r\nexport class GetView extends Request<View> {\r\n  viewUUID: UUID;\r\n\r\n  constructor(viewUUID: UUID) {\r\n    super();\r\n    this.viewUUID = viewUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'get',\r\n      url: `${dataEngineBase}${uri.views}/${this.viewUUID}`\r\n    };\r\n  }\r\n}\r\n\r\nexport class AddView extends Request<ViewCrudResponse> {\r\n  payload: View;\r\n  scenarioUUID: UUID;\r\n  constructor(scenarioUUID: UUID, payload: View) {\r\n    super();\r\n    this.payload = payload;\r\n    this.scenarioUUID = scenarioUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'post',\r\n      url: `${dataEngineBase}${uri.scenarios}/${this.scenarioUUID}${uri.views}`,\r\n      data: this.payload\r\n    };\r\n  }\r\n}\r\n\r\nexport class UpdateView extends Request<ViewCrudResponse> {\r\n  payload: Partial<View>;\r\n  viewUUID: UUID;\r\n  constructor(viewUUID: UUID, payload: Partial<View>) {\r\n    super();\r\n    this.payload = payload;\r\n    this.viewUUID = viewUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'put',\r\n      url: `${dataEngineBase}${uri.views}/${this.viewUUID}`,\r\n      data: this.payload\r\n    };\r\n  }\r\n}\r\n\r\nexport class DeleteView extends Request<ViewCrudResponse> {\r\n  viewUUID: UUID;\r\n  constructor(viewUUID: UUID) {\r\n    super();\r\n    this.viewUUID = viewUUID;\r\n  }\r\n\r\n  makeRequest(): AxiosRequestConfig {\r\n    return {\r\n      method: 'delete',\r\n      url: `${dataEngineBase}${uri.views}/${this.viewUUID}`\r\n    };\r\n  }\r\n}\r\n","import { Route, RouteConfig } from 'vue-router';\r\nimport FlowMain from '@/components/FlowMain.vue';\r\nimport FlowProjects from '@/components/FlowProjects.vue';\r\nimport FlowDatasets from '@/components/FlowDatasets.vue';\r\nimport FlowScenario from '@/components/FlowScenario.vue';\r\nimport FlowVisualization from '@/components/FlowVisualization.vue';\r\nimport FlowExport from '@/components/FlowExport.vue';\r\n\r\nfunction getFlowRoutes(baseURL: string): RouteConfig[] {\r\n  return [\r\n    {\r\n      path: baseURL,\r\n      name: 'FlowMain',\r\n      redirect: { name: 'FlowProjects' },\r\n      component: FlowMain,\r\n      children: [\r\n        {\r\n          path: 'workspace',\r\n          name: 'FlowProjects',\r\n          component: FlowProjects,\r\n          props: (route: Route) => {\r\n            const { project } = route.query;\r\n            return { currentProjectName: project };\r\n          }\r\n        },\r\n        {\r\n          path: 'datasets',\r\n          name: 'FlowDatasets',\r\n          component: FlowDatasets,\r\n          props: (route: Route) => {\r\n            const { project } = route.query;\r\n            return { currentProjectName: project };\r\n          }\r\n        },\r\n        {\r\n          path: 'scenario',\r\n          name: 'FlowScenario',\r\n          component: FlowScenario,\r\n          props: (route: Route) => {\r\n            const { project, scenario } = route.query;\r\n            return { currentProjectName: project, currentScenarioName: scenario };\r\n          }\r\n        },\r\n        {\r\n          path: 'visualization',\r\n          name: 'FlowVisualization',\r\n          component: FlowVisualization,\r\n          props: (route: Route) => {\r\n            const { project, scenario, view } = route.query;\r\n            return {\r\n              currentProjectName: project,\r\n              currentScenarioName: scenario,\r\n              currentViewUUID: view\r\n            };\r\n          }\r\n        },\r\n        {\r\n          path: 'export',\r\n          name: 'FlowExport',\r\n          component: FlowExport,\r\n          props: (route: Route) => {\r\n            const { project, scenario, view } = route.query;\r\n            return {\r\n              currentProjectName: project,\r\n              currentScenarioName: scenario,\r\n              currentViewUUID: view\r\n            };\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  ];\r\n}\r\n\r\nexport { getFlowRoutes };\r\n","export default require.context('.', true, /[A-Za-z0-9-_,\\s]+\\.json$/i);\r\n","import Vue from 'vue';\r\nimport VueI18n, { LocaleMessages } from 'vue-i18n';\r\nimport locales from '@/locales';\r\nVue.use(VueI18n);\r\n\r\nfunction loadLocaleMessages(): LocaleMessages {\r\n  const messages: LocaleMessages = {};\r\n  locales.keys().forEach(key => {\r\n    const matched = key.match(/([A-Za-z0-9-_]+)\\./i);\r\n    if (matched && matched.length > 1) {\r\n      const locale = matched[1];\r\n      messages[locale] = locales(key);\r\n    }\r\n  });\r\n  return messages;\r\n}\r\nconst i18n = new VueI18n({\r\n  locale: process.env.VUE_APP_I18N_LOCALE || 'en',\r\n  fallbackLocale: process.env.VUE_APP_I18N_FALLBACK_LOCALE || 'en',\r\n  messages: loadLocaleMessages()\r\n});\r\n\r\nexport default i18n;\r\n","import Vue_ from 'vue';\r\nimport * as components from './components';\r\nimport MovSnackBarProgramatic from './utils/snackbar';\r\nimport { registerComponent, registerComponentProgrammatic } from './plugins';\r\n\r\nexport default (() => {\r\n  const Flow_ = {\r\n    install(Vue: typeof Vue_) {\r\n      // Options\r\n      // setOptions(merge(config, options, true))\r\n      // Components\r\n      Object.values(components).forEach(component => {\r\n        registerComponent(Vue, component);\r\n      });\r\n\r\n      registerComponentProgrammatic(Vue, 'snackbar', MovSnackBarProgramatic);\r\n    }\r\n  };\r\n\r\n  return Flow_;\r\n})();\r\n\r\n// export api client and interfaces and request classes for the api\r\nexport * from './api';\r\n// export all components\r\nexport * from './components';\r\n// export all types\r\nexport * from './types';\r\n// export router\r\nexport * from './router';\r\n// export utils and others\r\nexport * from './utils';\r\nexport * from './errors';\r\nexport * from './crs';\r\nexport * from './i18n';\r\n"],"names":["Snackbar","Vue"],"mappings":"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"}